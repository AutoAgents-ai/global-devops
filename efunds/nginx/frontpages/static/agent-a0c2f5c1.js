import{j as h,k as f}from"./index-79f8f5a7.js";import{aC as I,r as i}from"./vue-82a6b7fc.js";const m=["/static/avatar/1.png","/static/avatar/10.png","/static/avatar/11.png","/static/avatar/12.jpg","/static/avatar/13.png","/static/avatar/14.png","/static/avatar/15.png","/static/avatar/16.jpg","/static/avatar/17.png","/static/avatar/18.png","/static/avatar/19.png","/static/avatar/2.png","/static/avatar/20.jpg","/static/avatar/21.png","/static/avatar/22.jpg","/static/avatar/23.png","/static/avatar/24.png","/static/avatar/25.png","/static/avatar/26.png","/static/avatar/27.png","/static/avatar/28.png","/static/avatar/29.png","/static/avatar/3.png","/static/avatar/30.png","/static/avatar/31.png","/static/avatar/32.png","/static/avatar/33.png","/static/avatar/34.png","/static/avatar/35.png","/static/avatar/36.png","/static/avatar/37.png","/static/avatar/38.png","/static/avatar/4.jpg","/static/avatar/5.png","/static/avatar/6.png","/static/avatar/7.png","/static/avatar/8.png","/static/avatar/9.png"],u=(e,s)=>e.find(n=>n.moduleType===s),y=I("flow",()=>{const e=i([]),s=i([]),n=i();return{appSystemModuleList:e,appToolModuleList:s,initTemplate:n,setInitTemplate:()=>{n.value={initInputNodes:{id:"simpleInputId",type:"custom",data:u(e.value,"questionInput"),position:{x:-172,y:415}},initAiNodes:{id:"simpleAichatId",type:"custom",data:u(e.value,"aiChat"),position:{x:685,y:364}},initKnowledgeNodes:{id:"simpleKnowledgeId",type:"custom",data:u(e.value,"knowledgesSearch"),position:{x:211,y:119}},initConfirmreplyNodes:{id:"simpleConfirmreplyId",type:"custom",data:u(e.value,"confirmreply"),position:{x:684,y:39}},initInputAiEdges:[{id:"vueflow__edge-input-ai",sourceHandle:"userChatInput",targetHandle:"text",type:"custom",source:"simpleInputId",target:"simpleAichatId",animated:!1}],initInputAiKdEdges:[{id:"vueflow__edge-input-kd",sourceHandle:"userChatInput",targetHandle:"text",type:"custom",source:"simpleInputId",target:"simpleKnowledgeId",animated:!1},{id:"vueflow__edge-kd-reply",sourceHandle:"isEmpty",targetHandle:"switch",type:"custom",source:"simpleKnowledgeId",target:"simpleConfirmreplyId",animated:!1},{id:"vueflow__edge-kd-ai2",sourceHandle:"unEmpty",targetHandle:"switch",type:"custom",source:"simpleKnowledgeId",target:"simpleAichatId",animated:!1},{id:"vueflow__edge-kd-ai3",sourceHandle:"quoteQA",targetHandle:"knSearch",type:"custom",source:"simpleKnowledgeId",target:"simpleAichatId",animated:!1}]}},setAppSystemModuleList:o=>{e.value=o},setAppToolModuleList:o=>{s.value=o,s.value}}}),j=I("agent",()=>{const e=i({avatar:"",name:"新的Agent",intro:"",uuid:"",guides:[],chatAvatar:"",shareAble:!1,searchInWeb:!1,createImage:!1,appModel:{nodes:[],edges:[]}}),s=i(h()),n=a=>{s.value=a,f(a)},r=i([]),g=i([]);return{agentInfo:e,setAgentInfo:a=>{e.value.name=a.name||"新的Agent",e.value.avatar=a.avatar||m[M(0,m.length-1)],e.value.intro=a.intro||"",e.value.uuid=a.uuid||"",e.value.chatAvatar=a.chatAvatar||"",e.value.shareAble=a.shareAble||!1,e.value.guides=a.guides||[],e.value.searchInWeb=a.searchInWeb||!1,e.value.createImage=a.createImage||!1,e.value.appModel=a.appModel?JSON.parse(a.appModel):{nodes:[],edges:[]}},setAgentModel:a=>{e.value.appModel=a},changeAgentInfo:a=>{e.value.name=a.name||"新的Agent",e.value.avatar=a.avatar,e.value.intro=a.intro,e.value.uuid=a.uuid,e.value.chatAvatar=a.chatAvatar||"",e.value.guides=a.guides,e.value.searchInWeb=a.searchInWeb,e.value.createImage=a.createImage;const{initTemplate:c}=y();if(c){const d=JSON.parse(JSON.stringify(c));l(e.value.appModel.nodes,"simpleInputId")||e.value.appModel.nodes.push(d.initInputNodes);const v=l(e.value.appModel.nodes,"simpleAichatId");if(v?v.data.inputs.map(t=>{t.key==="model"&&(t.value=a.aiModelName),t.key==="quotePrompt"&&(t.value=a.aiPrompt)}):(d.initAiNodes.data.inputs.map(t=>{t.key==="model"&&(t.value=a.aiModelName),t.key==="quotePrompt"&&(t.value=a.aiPrompt)}),e.value.appModel.nodes.push(d.initAiNodes)),l(e.value.appModel.edges,"vueflow__edge-input-ai")||e.value.appModel.edges.push(d.initInputAiEdges[0]),a.datasets.length>0){const t=l(e.value.appModel.nodes,"simpleKnowledgeId");l(e.value.appModel.nodes,"simpleConfirmreplyId")||e.value.appModel.nodes.push(d.initConfirmreplyNodes),t?t.data.inputs.map(p=>{p.key==="datasets"&&(p.value=a.datasets)}):(d.initKnowledgeNodes.data.inputs.map(p=>{p.key==="datasets"&&(p.value=a.datasets)}),e.value.appModel.nodes.push(d.initKnowledgeNodes)),l(e.value.appModel.nodes,"simpleAichatId").data.inputs.map(p=>{p.key==="quotePrompt"&&(p.value="请模拟成AI智能助手，根据知识库结果回答用户问题"),p.key==="temperature"&&(p.value=0)}),l(e.value.appModel.edges,"vueflow__edge-input-kd")||e.value.appModel.edges.push(d.initInputAiKdEdges[0]),l(e.value.appModel.edges,"vueflow__edge-kd-reply")||e.value.appModel.edges.push(d.initInputAiKdEdges[1]),l(e.value.appModel.edges,"vueflow__edge-kd-ai2")||e.value.appModel.edges.push(d.initInputAiKdEdges[2]),l(e.value.appModel.edges,"vueflow__edge-kd-ai3")||e.value.appModel.edges.push(d.initInputAiKdEdges[3])}else e.value.appModel.nodes=e.value.appModel.nodes.filter(t=>t.id!=="simpleKnowledgeId"),e.value.appModel.nodes=e.value.appModel.nodes.filter(t=>t.id!=="simpleConfirmreplyId")}},knowDataList:r,allChatList:g,setKnowDataList:a=>{r.value=a},setAllChatList:a=>{g.value=a},shareAgent:s,setShareAgent:n}});function l(e,s){return e.find(n=>n.id===s)}function M(e,s){return Math.floor(Math.random()*(s-e))+e}export{y as a,m as l,j as u};
