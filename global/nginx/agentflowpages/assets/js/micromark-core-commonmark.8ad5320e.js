import{p as O,s as J}from"./micromark-util-chunked.6f054bfc.js";import{c as d}from"./micromark-util-classify-character.4b79fd00.js";import{r as en}from"./micromark-util-resolve-all.8a85a8df.js";import{b as q,c as M,d as mn,e as pn,f as S,m as b,g as hn,h as xn,i as Z,j as L}from"./micromark-util-character.48ebe765.js";import{f}from"./micromark-factory-space.49ece02c.js";import{d as kn}from"./decode-named-character-reference.29ded5ae.js";import{f as un}from"./micromark-factory-destination.e79dac09.js";import{f as an}from"./micromark-factory-label.a9256be7.js";import{f as ln}from"./micromark-factory-title.88a6a02a.js";import{f as G}from"./micromark-factory-whitespace.060a9c42.js";import{n as $}from"./micromark-util-normalize-identifier.dfdf0387.js";import{h as nn,a as gn}from"./micromark-util-html-tag-name.eaa6d7c0.js";const Dt={name:"attention",tokenize:bn,resolveAll:cn};function cn(n,a){let r=-1,t,l,o,u,s,g,h,x;for(;++r<n.length;)if(n[r][0]==="enter"&&n[r][1].type==="attentionSequence"&&n[r][1]._close){for(t=r;t--;)if(n[t][0]==="exit"&&n[t][1].type==="attentionSequence"&&n[t][1]._open&&a.sliceSerialize(n[t][1]).charCodeAt(0)===a.sliceSerialize(n[r][1]).charCodeAt(0)){if((n[t][1]._close||n[r][1]._open)&&(n[r][1].end.offset-n[r][1].start.offset)%3&&!((n[t][1].end.offset-n[t][1].start.offset+n[r][1].end.offset-n[r][1].start.offset)%3))continue;g=n[t][1].end.offset-n[t][1].start.offset>1&&n[r][1].end.offset-n[r][1].start.offset>1?2:1;const p=Object.assign({},n[t][1].end),c=Object.assign({},n[r][1].start);tn(p,-g),tn(c,g),u={type:g>1?"strongSequence":"emphasisSequence",start:p,end:Object.assign({},n[t][1].end)},s={type:g>1?"strongSequence":"emphasisSequence",start:Object.assign({},n[r][1].start),end:c},o={type:g>1?"strongText":"emphasisText",start:Object.assign({},n[t][1].end),end:Object.assign({},n[r][1].start)},l={type:g>1?"strong":"emphasis",start:Object.assign({},u.start),end:Object.assign({},s.end)},n[t][1].end=Object.assign({},u.start),n[r][1].start=Object.assign({},s.end),h=[],n[t][1].end.offset-n[t][1].start.offset&&(h=O(h,[["enter",n[t][1],a],["exit",n[t][1],a]])),h=O(h,[["enter",l,a],["enter",u,a],["exit",u,a],["enter",o,a]]),h=O(h,en(a.parser.constructs.insideSpan.null,n.slice(t+1,r),a)),h=O(h,[["exit",o,a],["enter",s,a],["exit",s,a],["exit",l,a]]),n[r][1].end.offset-n[r][1].start.offset?(x=2,h=O(h,[["enter",n[r][1],a],["exit",n[r][1],a]])):x=0,J(n,t-1,r-t+3,h),r=t+h.length-x-2;break}}for(r=-1;++r<n.length;)n[r][1].type==="attentionSequence"&&(n[r][1].type="data");return n}function bn(n,a){const r=this.parser.constructs.attentionMarkers.null,t=this.previous,l=d(t);let o;return u;function u(g){return o=g,n.enter("attentionSequence"),s(g)}function s(g){if(g===o)return n.consume(g),s;const h=n.exit("attentionSequence"),x=d(g),p=!x||x===2&&l||r.includes(g),c=!l||l===2&&x||r.includes(t);return h._open=!!(o===42?p:p&&(l||!c)),h._close=!!(o===42?c:c&&(x||!p)),a(g)}}function tn(n,a){n.column+=a,n.offset+=a,n._bufferIndex+=a}const _t={name:"autolink",tokenize:Sn};function Sn(n,a,r){let t=0;return l;function l(m){return n.enter("autolink"),n.enter("autolinkMarker"),n.consume(m),n.exit("autolinkMarker"),n.enter("autolinkProtocol"),o}function o(m){return q(m)?(n.consume(m),u):h(m)}function u(m){return m===43||m===45||m===46||M(m)?(t=1,s(m)):h(m)}function s(m){return m===58?(n.consume(m),t=0,g):(m===43||m===45||m===46||M(m))&&t++<32?(n.consume(m),s):(t=0,h(m))}function g(m){return m===62?(n.exit("autolinkProtocol"),n.enter("autolinkMarker"),n.consume(m),n.exit("autolinkMarker"),n.exit("autolink"),a):m===null||m===32||m===60||mn(m)?r(m):(n.consume(m),g)}function h(m){return m===64?(n.consume(m),x):pn(m)?(n.consume(m),h):r(m)}function x(m){return M(m)?p(m):r(m)}function p(m){return m===46?(n.consume(m),t=0,x):m===62?(n.exit("autolinkProtocol").type="autolinkEmail",n.enter("autolinkMarker"),n.consume(m),n.exit("autolinkMarker"),n.exit("autolink"),a):c(m)}function c(m){if((m===45||M(m))&&t++<63){const E=m===45?c:p;return n.consume(m),E}return r(m)}}const v={tokenize:zn,partial:!0};function zn(n,a,r){return t;function t(o){return S(o)?f(n,l,"linePrefix")(o):l(o)}function l(o){return o===null||b(o)?a(o):r(o)}}const fn={name:"blockQuote",tokenize:yn,continuation:{tokenize:En},exit:Cn};function yn(n,a,r){const t=this;return l;function l(u){if(u===62){const s=t.containerState;return s.open||(n.enter("blockQuote",{_container:!0}),s.open=!0),n.enter("blockQuotePrefix"),n.enter("blockQuoteMarker"),n.consume(u),n.exit("blockQuoteMarker"),o}return r(u)}function o(u){return S(u)?(n.enter("blockQuotePrefixWhitespace"),n.consume(u),n.exit("blockQuotePrefixWhitespace"),n.exit("blockQuotePrefix"),a):(n.exit("blockQuotePrefix"),a(u))}}function En(n,a,r){const t=this;return l;function l(u){return S(u)?f(n,o,"linePrefix",t.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(u):o(u)}function o(u){return n.attempt(fn,a,r)(u)}}function Cn(n){n.exit("blockQuote")}const jt={name:"characterEscape",tokenize:wn};function wn(n,a,r){return t;function t(o){return n.enter("characterEscape"),n.enter("escapeMarker"),n.consume(o),n.exit("escapeMarker"),l}function l(o){return hn(o)?(n.enter("characterEscapeValue"),n.consume(o),n.exit("characterEscapeValue"),n.exit("characterEscape"),a):r(o)}}const Rt={name:"characterReference",tokenize:In};function In(n,a,r){const t=this;let l=0,o,u;return s;function s(p){return n.enter("characterReference"),n.enter("characterReferenceMarker"),n.consume(p),n.exit("characterReferenceMarker"),g}function g(p){return p===35?(n.enter("characterReferenceMarkerNumeric"),n.consume(p),n.exit("characterReferenceMarkerNumeric"),h):(n.enter("characterReferenceValue"),o=31,u=M,x(p))}function h(p){return p===88||p===120?(n.enter("characterReferenceMarkerHexadecimal"),n.consume(p),n.exit("characterReferenceMarkerHexadecimal"),n.enter("characterReferenceValue"),o=6,u=xn,x):(n.enter("characterReferenceValue"),o=7,u=Z,x(p))}function x(p){if(p===59&&l){const c=n.exit("characterReferenceValue");return u===M&&!kn(t.sliceSerialize(c))?r(p):(n.enter("characterReferenceMarker"),n.consume(p),n.exit("characterReferenceMarker"),n.exit("characterReference"),a)}return u(p)&&l++<o?(n.consume(p),x):r(p)}}const rn={tokenize:Fn,partial:!0},Ht={name:"codeFenced",tokenize:Tn,concrete:!0};function Tn(n,a,r){const t=this,l={tokenize:N,partial:!0};let o=0,u=0,s;return g;function g(k){return h(k)}function h(k){const T=t.events[t.events.length-1];return o=T&&T[1].type==="linePrefix"?T[2].sliceSerialize(T[1],!0).length:0,s=k,n.enter("codeFenced"),n.enter("codeFencedFence"),n.enter("codeFencedFenceSequence"),x(k)}function x(k){return k===s?(u++,n.consume(k),x):u<3?r(k):(n.exit("codeFencedFenceSequence"),S(k)?f(n,p,"whitespace")(k):p(k))}function p(k){return k===null||b(k)?(n.exit("codeFencedFence"),t.interrupt?a(k):n.check(rn,C,R)(k)):(n.enter("codeFencedFenceInfo"),n.enter("chunkString",{contentType:"string"}),c(k))}function c(k){return k===null||b(k)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),p(k)):S(k)?(n.exit("chunkString"),n.exit("codeFencedFenceInfo"),f(n,m,"whitespace")(k)):k===96&&k===s?r(k):(n.consume(k),c)}function m(k){return k===null||b(k)?p(k):(n.enter("codeFencedFenceMeta"),n.enter("chunkString",{contentType:"string"}),E(k))}function E(k){return k===null||b(k)?(n.exit("chunkString"),n.exit("codeFencedFenceMeta"),p(k)):k===96&&k===s?r(k):(n.consume(k),E)}function C(k){return n.attempt(l,R,I)(k)}function I(k){return n.enter("lineEnding"),n.consume(k),n.exit("lineEnding"),D}function D(k){return o>0&&S(k)?f(n,w,"linePrefix",o+1)(k):w(k)}function w(k){return k===null||b(k)?n.check(rn,C,R)(k):(n.enter("codeFlowValue"),F(k))}function F(k){return k===null||b(k)?(n.exit("codeFlowValue"),w(k)):(n.consume(k),F)}function R(k){return n.exit("codeFenced"),a(k)}function N(k,T,_){let A=0;return H;function H(z){return k.enter("lineEnding"),k.consume(z),k.exit("lineEnding"),V}function V(z){return k.enter("codeFencedFence"),S(z)?f(k,y,"linePrefix",t.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(z):y(z)}function y(z){return z===s?(k.enter("codeFencedFenceSequence"),P(z)):_(z)}function P(z){return z===s?(A++,k.consume(z),P):A>=u?(k.exit("codeFencedFenceSequence"),S(z)?f(k,Q,"whitespace")(z):Q(z)):_(z)}function Q(z){return z===null||b(z)?(k.exit("codeFencedFence"),T(z)):_(z)}}}function Fn(n,a,r){const t=this;return l;function l(u){return u===null?r(u):(n.enter("lineEnding"),n.consume(u),n.exit("lineEnding"),o)}function o(u){return t.parser.lazy[t.now().line]?r(u):a(u)}}const Vt={name:"codeIndented",tokenize:An},Ln={tokenize:Bn,partial:!0};function An(n,a,r){const t=this;return l;function l(h){return n.enter("codeIndented"),f(n,o,"linePrefix",4+1)(h)}function o(h){const x=t.events[t.events.length-1];return x&&x[1].type==="linePrefix"&&x[2].sliceSerialize(x[1],!0).length>=4?u(h):r(h)}function u(h){return h===null?g(h):b(h)?n.attempt(Ln,u,g)(h):(n.enter("codeFlowValue"),s(h))}function s(h){return h===null||b(h)?(n.exit("codeFlowValue"),u(h)):(n.consume(h),s)}function g(h){return n.exit("codeIndented"),a(h)}}function Bn(n,a,r){const t=this;return l;function l(u){return t.parser.lazy[t.now().line]?r(u):b(u)?(n.enter("lineEnding"),n.consume(u),n.exit("lineEnding"),l):f(n,o,"linePrefix",4+1)(u)}function o(u){const s=t.events[t.events.length-1];return s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?a(u):b(u)?l(u):r(u)}}const Nt={name:"codeText",tokenize:Pn,resolve:On,previous:Mn};function On(n){let a=n.length-4,r=3,t,l;if((n[r][1].type==="lineEnding"||n[r][1].type==="space")&&(n[a][1].type==="lineEnding"||n[a][1].type==="space")){for(t=r;++t<a;)if(n[t][1].type==="codeTextData"){n[r][1].type="codeTextPadding",n[a][1].type="codeTextPadding",r+=2,a-=2;break}}for(t=r-1,a++;++t<=a;)l===void 0?t!==a&&n[t][1].type!=="lineEnding"&&(l=t):(t===a||n[t][1].type==="lineEnding")&&(n[l][1].type="codeTextData",t!==l+2&&(n[l][1].end=n[t-1][1].end,n.splice(l+2,t-l-2),a-=t-l-2,t=l+2),l=void 0);return n}function Mn(n){return n!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Pn(n,a,r){let t=0,l,o;return u;function u(p){return n.enter("codeText"),n.enter("codeTextSequence"),s(p)}function s(p){return p===96?(n.consume(p),t++,s):(n.exit("codeTextSequence"),g(p))}function g(p){return p===null?r(p):p===32?(n.enter("space"),n.consume(p),n.exit("space"),g):p===96?(o=n.enter("codeTextSequence"),l=0,x(p)):b(p)?(n.enter("lineEnding"),n.consume(p),n.exit("lineEnding"),g):(n.enter("codeTextData"),h(p))}function h(p){return p===null||p===32||p===96||b(p)?(n.exit("codeTextData"),g(p)):(n.consume(p),h)}function x(p){return p===96?(n.consume(p),l++,x):l===t?(n.exit("codeTextSequence"),n.exit("codeText"),a(p)):(o.type="codeTextData",h(p))}}function qn(n){const a={};let r=-1,t,l,o,u,s,g,h;for(;++r<n.length;){for(;r in a;)r=a[r];if(t=n[r],r&&t[1].type==="chunkFlow"&&n[r-1][1].type==="listItemPrefix"&&(g=t[1]._tokenizer.events,o=0,o<g.length&&g[o][1].type==="lineEndingBlank"&&(o+=2),o<g.length&&g[o][1].type==="content"))for(;++o<g.length&&g[o][1].type!=="content";)g[o][1].type==="chunkText"&&(g[o][1]._isInFirstContentOfListItem=!0,o++);if(t[0]==="enter")t[1].contentType&&(Object.assign(a,Dn(n,r)),r=a[r],h=!0);else if(t[1]._container){for(o=r,l=void 0;o--&&(u=n[o],u[1].type==="lineEnding"||u[1].type==="lineEndingBlank");)u[0]==="enter"&&(l&&(n[l][1].type="lineEndingBlank"),u[1].type="lineEnding",l=o);l&&(t[1].end=Object.assign({},n[l][1].start),s=n.slice(l,r),s.unshift(t),J(n,l,r-l+1,s))}}return!h}function Dn(n,a){const r=n[a][1],t=n[a][2];let l=a-1;const o=[],u=r._tokenizer||t.parser[r.contentType](r.start),s=u.events,g=[],h={};let x,p,c=-1,m=r,E=0,C=0;const I=[C];for(;m;){for(;n[++l][1]!==m;);o.push(l),m._tokenizer||(x=t.sliceStream(m),m.next||x.push(null),p&&u.defineSkip(m.start),m._isInFirstContentOfListItem&&(u._gfmTasklistFirstContentOfListItem=!0),u.write(x),m._isInFirstContentOfListItem&&(u._gfmTasklistFirstContentOfListItem=void 0)),p=m,m=m.next}for(m=r;++c<s.length;)s[c][0]==="exit"&&s[c-1][0]==="enter"&&s[c][1].type===s[c-1][1].type&&s[c][1].start.line!==s[c][1].end.line&&(C=c+1,I.push(C),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(u.events=[],m?(m._tokenizer=void 0,m.previous=void 0):I.pop(),c=I.length;c--;){const D=s.slice(I[c],I[c+1]),w=o.pop();g.unshift([w,w+D.length-1]),J(n,w,2,D)}for(c=-1;++c<g.length;)h[E+g[c][0]]=E+g[c][1],E+=g[c][1]-g[c][0]-1;return h}const Qt={tokenize:Rn,resolve:jn},_n={tokenize:Hn,partial:!0};function jn(n){return qn(n),n}function Rn(n,a){let r;return t;function t(s){return n.enter("content"),r=n.enter("chunkContent",{contentType:"content"}),l(s)}function l(s){return s===null?o(s):b(s)?n.check(_n,u,o)(s):(n.consume(s),l)}function o(s){return n.exit("chunkContent"),n.exit("content"),a(s)}function u(s){return n.consume(s),n.exit("chunkContent"),r.next=n.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,l}}function Hn(n,a,r){const t=this;return l;function l(u){return n.exit("chunkContent"),n.enter("lineEnding"),n.consume(u),n.exit("lineEnding"),f(n,o,"linePrefix")}function o(u){if(u===null||b(u))return r(u);const s=t.events[t.events.length-1];return!t.parser.constructs.disable.null.includes("codeIndented")&&s&&s[1].type==="linePrefix"&&s[2].sliceSerialize(s[1],!0).length>=4?a(u):n.interrupt(t.parser.constructs.flow,r,a)(u)}}const Wt={name:"definition",tokenize:Nn},Vn={tokenize:Qn,partial:!0};function Nn(n,a,r){const t=this;let l;return o;function o(m){return n.enter("definition"),u(m)}function u(m){return an.call(t,n,s,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function s(m){return l=$(t.sliceSerialize(t.events[t.events.length-1][1]).slice(1,-1)),m===58?(n.enter("definitionMarker"),n.consume(m),n.exit("definitionMarker"),g):r(m)}function g(m){return L(m)?G(n,h)(m):h(m)}function h(m){return un(n,x,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function x(m){return n.attempt(Vn,p,p)(m)}function p(m){return S(m)?f(n,c,"whitespace")(m):c(m)}function c(m){return m===null||b(m)?(n.exit("definition"),t.parser.defined.push(l),a(m)):r(m)}}function Qn(n,a,r){return t;function t(s){return L(s)?G(n,l)(s):r(s)}function l(s){return ln(n,o,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(s)}function o(s){return S(s)?f(n,u,"whitespace")(s):u(s)}function u(s){return s===null||b(s)?a(s):r(s)}}const Ut={name:"hardBreakEscape",tokenize:Wn};function Wn(n,a,r){return t;function t(o){return n.enter("hardBreakEscape"),n.consume(o),l}function l(o){return b(o)?(n.exit("hardBreakEscape"),a(o)):r(o)}}const Gt={name:"headingAtx",tokenize:Gn,resolve:Un};function Un(n,a){let r=n.length-2,t=3,l,o;return n[t][1].type==="whitespace"&&(t+=2),r-2>t&&n[r][1].type==="whitespace"&&(r-=2),n[r][1].type==="atxHeadingSequence"&&(t===r-1||r-4>t&&n[r-2][1].type==="whitespace")&&(r-=t+1===r?2:4),r>t&&(l={type:"atxHeadingText",start:n[t][1].start,end:n[r][1].end},o={type:"chunkText",start:n[t][1].start,end:n[r][1].end,contentType:"text"},J(n,t,r-t+1,[["enter",l,a],["enter",o,a],["exit",o,a],["exit",l,a]])),n}function Gn(n,a,r){let t=0;return l;function l(x){return n.enter("atxHeading"),o(x)}function o(x){return n.enter("atxHeadingSequence"),u(x)}function u(x){return x===35&&t++<6?(n.consume(x),u):x===null||L(x)?(n.exit("atxHeadingSequence"),s(x)):r(x)}function s(x){return x===35?(n.enter("atxHeadingSequence"),g(x)):x===null||b(x)?(n.exit("atxHeading"),a(x)):S(x)?f(n,s,"whitespace")(x):(n.enter("atxHeadingText"),h(x))}function g(x){return x===35?(n.consume(x),g):(n.exit("atxHeadingSequence"),s(x))}function h(x){return x===null||x===35||L(x)?(n.exit("atxHeadingText"),s(x)):(n.consume(x),h)}}const Jt={name:"htmlFlow",tokenize:Yn,resolveTo:Xn,concrete:!0},Jn={tokenize:$n,partial:!0},Kn={tokenize:Zn,partial:!0};function Xn(n){let a=n.length;for(;a--&&!(n[a][0]==="enter"&&n[a][1].type==="htmlFlow"););return a>1&&n[a-2][1].type==="linePrefix"&&(n[a][1].start=n[a-2][1].start,n[a+1][1].start=n[a-2][1].start,n.splice(a-2,2)),n}function Yn(n,a,r){const t=this;let l,o,u,s,g;return h;function h(i){return x(i)}function x(i){return n.enter("htmlFlow"),n.enter("htmlFlowData"),n.consume(i),p}function p(i){return i===33?(n.consume(i),c):i===47?(n.consume(i),o=!0,C):i===63?(n.consume(i),l=3,t.interrupt?a:e):q(i)?(n.consume(i),u=String.fromCharCode(i),I):r(i)}function c(i){return i===45?(n.consume(i),l=2,m):i===91?(n.consume(i),l=5,s=0,E):q(i)?(n.consume(i),l=4,t.interrupt?a:e):r(i)}function m(i){return i===45?(n.consume(i),t.interrupt?a:e):r(i)}function E(i){const U="CDATA[";return i===U.charCodeAt(s++)?(n.consume(i),s===U.length?t.interrupt?a:y:E):r(i)}function C(i){return q(i)?(n.consume(i),u=String.fromCharCode(i),I):r(i)}function I(i){if(i===null||i===47||i===62||L(i)){const U=i===47,sn=u.toLowerCase();return!U&&!o&&nn.includes(sn)?(l=1,t.interrupt?a(i):y(i)):gn.includes(u.toLowerCase())?(l=6,U?(n.consume(i),D):t.interrupt?a(i):y(i)):(l=7,t.interrupt&&!t.parser.lazy[t.now().line]?r(i):o?w(i):F(i))}return i===45||M(i)?(n.consume(i),u+=String.fromCharCode(i),I):r(i)}function D(i){return i===62?(n.consume(i),t.interrupt?a:y):r(i)}function w(i){return S(i)?(n.consume(i),w):H(i)}function F(i){return i===47?(n.consume(i),H):i===58||i===95||q(i)?(n.consume(i),R):S(i)?(n.consume(i),F):H(i)}function R(i){return i===45||i===46||i===58||i===95||M(i)?(n.consume(i),R):N(i)}function N(i){return i===61?(n.consume(i),k):S(i)?(n.consume(i),N):F(i)}function k(i){return i===null||i===60||i===61||i===62||i===96?r(i):i===34||i===39?(n.consume(i),g=i,T):S(i)?(n.consume(i),k):_(i)}function T(i){return i===g?(n.consume(i),g=null,A):i===null||b(i)?r(i):(n.consume(i),T)}function _(i){return i===null||i===34||i===39||i===47||i===60||i===61||i===62||i===96||L(i)?N(i):(n.consume(i),_)}function A(i){return i===47||i===62||S(i)?F(i):r(i)}function H(i){return i===62?(n.consume(i),V):r(i)}function V(i){return i===null||b(i)?y(i):S(i)?(n.consume(i),V):r(i)}function y(i){return i===45&&l===2?(n.consume(i),j):i===60&&l===1?(n.consume(i),B):i===62&&l===4?(n.consume(i),W):i===63&&l===3?(n.consume(i),e):i===93&&l===5?(n.consume(i),X):b(i)&&(l===6||l===7)?(n.exit("htmlFlowData"),n.check(Jn,Y,P)(i)):i===null||b(i)?(n.exit("htmlFlowData"),P(i)):(n.consume(i),y)}function P(i){return n.check(Kn,Q,Y)(i)}function Q(i){return n.enter("lineEnding"),n.consume(i),n.exit("lineEnding"),z}function z(i){return i===null||b(i)?P(i):(n.enter("htmlFlowData"),y(i))}function j(i){return i===45?(n.consume(i),e):y(i)}function B(i){return i===47?(n.consume(i),u="",K):y(i)}function K(i){if(i===62){const U=u.toLowerCase();return nn.includes(U)?(n.consume(i),W):y(i)}return q(i)&&u.length<8?(n.consume(i),u+=String.fromCharCode(i),K):y(i)}function X(i){return i===93?(n.consume(i),e):y(i)}function e(i){return i===62?(n.consume(i),W):i===45&&l===2?(n.consume(i),e):y(i)}function W(i){return i===null||b(i)?(n.exit("htmlFlowData"),Y(i)):(n.consume(i),W)}function Y(i){return n.exit("htmlFlow"),a(i)}}function Zn(n,a,r){const t=this;return l;function l(u){return b(u)?(n.enter("lineEnding"),n.consume(u),n.exit("lineEnding"),o):r(u)}function o(u){return t.parser.lazy[t.now().line]?r(u):a(u)}}function $n(n,a,r){return t;function t(l){return n.enter("lineEnding"),n.consume(l),n.exit("lineEnding"),n.attempt(v,a,r)}}const Kt={name:"htmlText",tokenize:vn};function vn(n,a,r){const t=this;let l,o,u;return s;function s(e){return n.enter("htmlText"),n.enter("htmlTextData"),n.consume(e),g}function g(e){return e===33?(n.consume(e),h):e===47?(n.consume(e),N):e===63?(n.consume(e),F):q(e)?(n.consume(e),_):r(e)}function h(e){return e===45?(n.consume(e),x):e===91?(n.consume(e),o=0,E):q(e)?(n.consume(e),w):r(e)}function x(e){return e===45?(n.consume(e),m):r(e)}function p(e){return e===null?r(e):e===45?(n.consume(e),c):b(e)?(u=p,B(e)):(n.consume(e),p)}function c(e){return e===45?(n.consume(e),m):p(e)}function m(e){return e===62?j(e):e===45?c(e):p(e)}function E(e){const W="CDATA[";return e===W.charCodeAt(o++)?(n.consume(e),o===W.length?C:E):r(e)}function C(e){return e===null?r(e):e===93?(n.consume(e),I):b(e)?(u=C,B(e)):(n.consume(e),C)}function I(e){return e===93?(n.consume(e),D):C(e)}function D(e){return e===62?j(e):e===93?(n.consume(e),D):C(e)}function w(e){return e===null||e===62?j(e):b(e)?(u=w,B(e)):(n.consume(e),w)}function F(e){return e===null?r(e):e===63?(n.consume(e),R):b(e)?(u=F,B(e)):(n.consume(e),F)}function R(e){return e===62?j(e):F(e)}function N(e){return q(e)?(n.consume(e),k):r(e)}function k(e){return e===45||M(e)?(n.consume(e),k):T(e)}function T(e){return b(e)?(u=T,B(e)):S(e)?(n.consume(e),T):j(e)}function _(e){return e===45||M(e)?(n.consume(e),_):e===47||e===62||L(e)?A(e):r(e)}function A(e){return e===47?(n.consume(e),j):e===58||e===95||q(e)?(n.consume(e),H):b(e)?(u=A,B(e)):S(e)?(n.consume(e),A):j(e)}function H(e){return e===45||e===46||e===58||e===95||M(e)?(n.consume(e),H):V(e)}function V(e){return e===61?(n.consume(e),y):b(e)?(u=V,B(e)):S(e)?(n.consume(e),V):A(e)}function y(e){return e===null||e===60||e===61||e===62||e===96?r(e):e===34||e===39?(n.consume(e),l=e,P):b(e)?(u=y,B(e)):S(e)?(n.consume(e),y):(n.consume(e),Q)}function P(e){return e===l?(n.consume(e),l=void 0,z):e===null?r(e):b(e)?(u=P,B(e)):(n.consume(e),P)}function Q(e){return e===null||e===34||e===39||e===60||e===61||e===96?r(e):e===47||e===62||L(e)?A(e):(n.consume(e),Q)}function z(e){return e===47||e===62||L(e)?A(e):r(e)}function j(e){return e===62?(n.consume(e),n.exit("htmlTextData"),n.exit("htmlText"),a):r(e)}function B(e){return n.exit("htmlTextData"),n.enter("lineEnding"),n.consume(e),n.exit("lineEnding"),K}function K(e){return S(e)?f(n,X,"linePrefix",t.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(e):X(e)}function X(e){return n.enter("htmlTextData"),u(e)}}const on={name:"labelEnd",tokenize:it,resolveTo:et,resolveAll:rt},dn={tokenize:ut},nt={tokenize:at},tt={tokenize:lt};function rt(n){let a=-1;for(;++a<n.length;){const r=n[a][1];(r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd")&&(n.splice(a+1,r.type==="labelImage"?4:2),r.type="data",a++)}return n}function et(n,a){let r=n.length,t=0,l,o,u,s;for(;r--;)if(l=n[r][1],o){if(l.type==="link"||l.type==="labelLink"&&l._inactive)break;n[r][0]==="enter"&&l.type==="labelLink"&&(l._inactive=!0)}else if(u){if(n[r][0]==="enter"&&(l.type==="labelImage"||l.type==="labelLink")&&!l._balanced&&(o=r,l.type!=="labelLink")){t=2;break}}else l.type==="labelEnd"&&(u=r);const g={type:n[o][1].type==="labelLink"?"link":"image",start:Object.assign({},n[o][1].start),end:Object.assign({},n[n.length-1][1].end)},h={type:"label",start:Object.assign({},n[o][1].start),end:Object.assign({},n[u][1].end)},x={type:"labelText",start:Object.assign({},n[o+t+2][1].end),end:Object.assign({},n[u-2][1].start)};return s=[["enter",g,a],["enter",h,a]],s=O(s,n.slice(o+1,o+t+3)),s=O(s,[["enter",x,a]]),s=O(s,en(a.parser.constructs.insideSpan.null,n.slice(o+t+4,u-3),a)),s=O(s,[["exit",x,a],n[u-2],n[u-1],["exit",h,a]]),s=O(s,n.slice(u+1)),s=O(s,[["exit",g,a]]),J(n,o,n.length,s),n}function it(n,a,r){const t=this;let l=t.events.length,o,u;for(;l--;)if((t.events[l][1].type==="labelImage"||t.events[l][1].type==="labelLink")&&!t.events[l][1]._balanced){o=t.events[l][1];break}return s;function s(c){return o?o._inactive?p(c):(u=t.parser.defined.includes($(t.sliceSerialize({start:o.end,end:t.now()}))),n.enter("labelEnd"),n.enter("labelMarker"),n.consume(c),n.exit("labelMarker"),n.exit("labelEnd"),g):r(c)}function g(c){return c===40?n.attempt(dn,x,u?x:p)(c):c===91?n.attempt(nt,x,u?h:p)(c):u?x(c):p(c)}function h(c){return n.attempt(tt,x,p)(c)}function x(c){return a(c)}function p(c){return o._balanced=!0,r(c)}}function ut(n,a,r){return t;function t(p){return n.enter("resource"),n.enter("resourceMarker"),n.consume(p),n.exit("resourceMarker"),l}function l(p){return L(p)?G(n,o)(p):o(p)}function o(p){return p===41?x(p):un(n,u,s,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(p)}function u(p){return L(p)?G(n,g)(p):x(p)}function s(p){return r(p)}function g(p){return p===34||p===39||p===40?ln(n,h,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(p):x(p)}function h(p){return L(p)?G(n,x)(p):x(p)}function x(p){return p===41?(n.enter("resourceMarker"),n.consume(p),n.exit("resourceMarker"),n.exit("resource"),a):r(p)}}function at(n,a,r){const t=this;return l;function l(s){return an.call(t,n,o,u,"reference","referenceMarker","referenceString")(s)}function o(s){return t.parser.defined.includes($(t.sliceSerialize(t.events[t.events.length-1][1]).slice(1,-1)))?a(s):r(s)}function u(s){return r(s)}}function lt(n,a,r){return t;function t(o){return n.enter("reference"),n.enter("referenceMarker"),n.consume(o),n.exit("referenceMarker"),l}function l(o){return o===93?(n.enter("referenceMarker"),n.consume(o),n.exit("referenceMarker"),n.exit("reference"),a):r(o)}}const Xt={name:"labelStartImage",tokenize:ot,resolveAll:on.resolveAll};function ot(n,a,r){const t=this;return l;function l(s){return n.enter("labelImage"),n.enter("labelImageMarker"),n.consume(s),n.exit("labelImageMarker"),o}function o(s){return s===91?(n.enter("labelMarker"),n.consume(s),n.exit("labelMarker"),n.exit("labelImage"),u):r(s)}function u(s){return s===94&&"_hiddenFootnoteSupport"in t.parser.constructs?r(s):a(s)}}const Yt={name:"labelStartLink",tokenize:st,resolveAll:on.resolveAll};function st(n,a,r){const t=this;return l;function l(u){return n.enter("labelLink"),n.enter("labelMarker"),n.consume(u),n.exit("labelMarker"),n.exit("labelLink"),o}function o(u){return u===94&&"_hiddenFootnoteSupport"in t.parser.constructs?r(u):a(u)}}const Zt={name:"lineEnding",tokenize:mt};function mt(n,a){return r;function r(t){return n.enter("lineEnding"),n.consume(t),n.exit("lineEnding"),f(n,a,"linePrefix")}}const pt={name:"thematicBreak",tokenize:ht};function ht(n,a,r){let t=0,l;return o;function o(h){return n.enter("thematicBreak"),u(h)}function u(h){return l=h,s(h)}function s(h){return h===l?(n.enter("thematicBreakSequence"),g(h)):t>=3&&(h===null||b(h))?(n.exit("thematicBreak"),a(h)):r(h)}function g(h){return h===l?(n.consume(h),t++,g):(n.exit("thematicBreakSequence"),S(h)?f(n,s,"whitespace")(h):s(h))}}const xt={name:"list",tokenize:ct,continuation:{tokenize:bt},exit:zt},kt={tokenize:ft,partial:!0},gt={tokenize:St,partial:!0};function ct(n,a,r){const t=this,l=t.events[t.events.length-1];let o=l&&l[1].type==="linePrefix"?l[2].sliceSerialize(l[1],!0).length:0,u=0;return s;function s(m){const E=t.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(E==="listUnordered"?!t.containerState.marker||m===t.containerState.marker:Z(m)){if(t.containerState.type||(t.containerState.type=E,n.enter(E,{_container:!0})),E==="listUnordered")return n.enter("listItemPrefix"),m===42||m===45?n.check(pt,r,h)(m):h(m);if(!t.interrupt||m===49)return n.enter("listItemPrefix"),n.enter("listItemValue"),g(m)}return r(m)}function g(m){return Z(m)&&++u<10?(n.consume(m),g):(!t.interrupt||u<2)&&(t.containerState.marker?m===t.containerState.marker:m===41||m===46)?(n.exit("listItemValue"),h(m)):r(m)}function h(m){return n.enter("listItemMarker"),n.consume(m),n.exit("listItemMarker"),t.containerState.marker=t.containerState.marker||m,n.check(v,t.interrupt?r:x,n.attempt(kt,c,p))}function x(m){return t.containerState.initialBlankLine=!0,o++,c(m)}function p(m){return S(m)?(n.enter("listItemPrefixWhitespace"),n.consume(m),n.exit("listItemPrefixWhitespace"),c):r(m)}function c(m){return t.containerState.size=o+t.sliceSerialize(n.exit("listItemPrefix"),!0).length,a(m)}}function bt(n,a,r){const t=this;return t.containerState._closeFlow=void 0,n.check(v,l,o);function l(s){return t.containerState.furtherBlankLines=t.containerState.furtherBlankLines||t.containerState.initialBlankLine,f(n,a,"listItemIndent",t.containerState.size+1)(s)}function o(s){return t.containerState.furtherBlankLines||!S(s)?(t.containerState.furtherBlankLines=void 0,t.containerState.initialBlankLine=void 0,u(s)):(t.containerState.furtherBlankLines=void 0,t.containerState.initialBlankLine=void 0,n.attempt(gt,a,u)(s))}function u(s){return t.containerState._closeFlow=!0,t.interrupt=void 0,f(n,n.attempt(xt,a,r),"linePrefix",t.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(s)}}function St(n,a,r){const t=this;return f(n,l,"listItemIndent",t.containerState.size+1);function l(o){const u=t.events[t.events.length-1];return u&&u[1].type==="listItemIndent"&&u[2].sliceSerialize(u[1],!0).length===t.containerState.size?a(o):r(o)}}function zt(n){n.exit(this.containerState.type)}function ft(n,a,r){const t=this;return f(n,l,"listItemPrefixWhitespace",t.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function l(o){const u=t.events[t.events.length-1];return!S(o)&&u&&u[1].type==="listItemPrefixWhitespace"?a(o):r(o)}}const $t={name:"setextUnderline",tokenize:Et,resolveTo:yt};function yt(n,a){let r=n.length,t,l,o;for(;r--;)if(n[r][0]==="enter"){if(n[r][1].type==="content"){t=r;break}n[r][1].type==="paragraph"&&(l=r)}else n[r][1].type==="content"&&n.splice(r,1),!o&&n[r][1].type==="definition"&&(o=r);const u={type:"setextHeading",start:Object.assign({},n[l][1].start),end:Object.assign({},n[n.length-1][1].end)};return n[l][1].type="setextHeadingText",o?(n.splice(l,0,["enter",u,a]),n.splice(o+1,0,["exit",n[t][1],a]),n[t][1].end=Object.assign({},n[o][1].end)):n[t][1]=u,n.push(["exit",u,a]),n}function Et(n,a,r){const t=this;let l;return o;function o(h){let x=t.events.length,p;for(;x--;)if(t.events[x][1].type!=="lineEnding"&&t.events[x][1].type!=="linePrefix"&&t.events[x][1].type!=="content"){p=t.events[x][1].type==="paragraph";break}return!t.parser.lazy[t.now().line]&&(t.interrupt||p)?(n.enter("setextHeadingLine"),l=h,u(h)):r(h)}function u(h){return n.enter("setextHeadingLineSequence"),s(h)}function s(h){return h===l?(n.consume(h),s):(n.exit("setextHeadingLineSequence"),S(h)?f(n,g,"lineSuffix")(h):g(h))}function g(h){return h===null||b(h)?(n.exit("setextHeadingLine"),a(h)):r(h)}}export{fn as a,v as b,Qt as c,Wt as d,Vt as e,Jt as f,Ht as g,Gt as h,Rt as i,jt as j,Zt as k,xt as l,Xt as m,Dt as n,_t as o,Kt as p,Yt as q,Ut as r,$t as s,pt as t,on as u,Nt as v};
