import{l as _e,aD as ve,r as c,Z as O,ag as i,m as r,p as v,q as n,U as t,O as s,F,a7 as M,a2 as D,M as h,aE as fe,aF as ge,u as P,T as A,S as he,I as be,R as Ce}from"./vue-df4b15ce.js";import{D as G}from"./index-10138b04.js";import{g as we,G as ke,a as ye,s as xe,K as Ve,d as Ie}from"./index-df13b03a.js";import{u as Ue,a as L,b as $e}from"./knowledge-2c78c2d3.js";import{h as Fe,f as Me}from"./element-13471b23.js";import{_ as De}from"./index-630de61f.js";import"./vxe-8a51e91f.js";const Q=f=>(fe("data-v-0c8a2fad"),f=f(),ge(),f),Se={class:"app-container"},Ne=Q(()=>n("span",null,"帮助中心",-1)),Ke={class:"app-list"},je={class:"app-list-box"},Be={class:"add-icon"},qe=Q(()=>n("h3",null,"创建知识库",-1)),ze=["onClick"],Te={class:"image-slot"},Re={class:"item-dropdown"},Ee={class:"dropdown-menu"},Oe=["onClick"],Pe=["onClick"],Ae={class:"avatar"},Ge=["onClick"],Le=["src"],Qe=["onClick","src"],He=_e({__name:"index",setup(f){const H=()=>{window.open("https://www.yuque.com/skyagents/glwn9v/lud63d1ttrhqohdv")},{proxy:b}=Ue(),C=ve(),p=c(!1),w=c(!0),S=c(0),d=c(0),k=c(),N=c(),J=c(),K=c(0),m=c(!1),y=c(!1),j=c("创建知识库"),Z={pageNum:1,pageSize:1e4,count:!0,keywords:"",parentId:0},B=c([]),l=O({parentId:0,name:"",vectorModel:"SkyChat-MegaVerse",avatarUrl:"https://autoagents.oss-cn-beijing.aliyuncs.com/static/avatar/18.png",tags:[],type:"kb",description:""}),W=O({name:[{required:!0,message:"请填写知识库名称!",trigger:"blur"}],description:[{required:!0,message:"请填写知识库描述!",trigger:"blur"}]}),x=async(o=!1)=>{we(Z).then(async a=>{if(B.value=a.data.list,o){const u=a.data.list.filter(V=>V.id==K.value);await L().setChatData(u[0]),await C.push({name:"importData"})}})};x();const q=()=>{ke("emb_models").then(o=>{N.value=o.data})};q();const X=()=>{p.value=!0,w.value=!0,l.avatarUrl="https://autoagents.oss-cn-beijing.aliyuncs.com/static/avatar/18.png",y.value=!1},Y=o=>{w.value=!1,p.value=!0,y.value=!0,S.value=o,j.value="知识库设置",Ve(o).then(a=>{let u;for(u in l)l.hasOwnProperty(u)&&(l[u]=a.data[u])})},ee=o=>{Me.confirm("此操作将永久删除数据,是否继续?","提醒",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Ie(o).then(()=>{x(),b.$message.success("删除成功!")})}).catch(()=>{})},ae=()=>{var a;const o=(a=l.avatarUrl)==null?void 0:a.match(/\/([^\/]+)\.[a-z]+$/i);o!=null&&o.length?d.value=Number(o[1]):d.value=0,m.value=!0},te=o=>{d.value=o},oe=async()=>{await k.value.validate(async o=>{o&&(w.value?await ye(l).then(a=>{K.value=a.data,b.$message.success("创建成功!")}):await xe(Object.assign(l,{id:S.value})).then(()=>{b.$message.success("修改成功!")}),await x(!0),await q(),await z(),p.value=!1)})},se=()=>{l.avatarUrl=`https://autoagents.oss-cn-beijing.aliyuncs.com/static/avatar/${d.value}.${[4,12,16,20,22].includes(d.value)?"jpg":"png"}`,m.value=!1},z=()=>{k.value.resetFields()},le=()=>{d.value=0,m.value=!1},ne=(o,a)=>{J.value=o,L().setChatData(a),a.dsNum<=1?C.push({name:"importData"}):C.push({name:"knowledgeTable"})};return(o,a)=>{const u=i("SvgIcon"),V=i("Plus"),I=i("el-icon"),U=i("el-col"),ie=i("el-image"),ce=i("el-text"),T=i("svg-icon"),re=i("el-popover"),R=i("el-row"),$=i("el-input"),g=i("el-form-item"),de=i("el-option"),ue=i("el-select"),pe=i("el-form"),me=i("CircleCheckFilled");return r(),v("div",null,[n("div",Se,[n("div",{class:"app-bang",onClick:H},[Ne,t(u,{name:"help",style:{"margin-left":"5px"}})]),n("div",Ke,[n("div",je,[t(R,{gutter:24},{default:s(()=>[t(U,{span:6},{default:s(()=>[n("div",{class:"item add",onClick:X},[n("div",Be,[t(I,{size:20},{default:s(()=>[t(V)]),_:1})]),qe])]),_:1}),(r(!0),v(F,null,M(B.value,(e,_)=>(r(),h(U,{span:6,key:_},{default:s(()=>[n("div",{class:"item",onClick:E=>ne(_,e)},[t(ie,{src:e.avatarUrl?e.avatarUrl:`${P($e)("")}`,class:"logo"},{error:s(()=>[n("div",Te,[t(I,{size:"40"},{default:s(()=>[t(P(Fe))]),_:1})])]),_:2},1032,["src"]),n("h3",null,A(e.name),1),n("p",null,[t(ce,{"line-clamp":2},{default:s(()=>[he(A(e.description),1)]),_:2},1024)]),t(re,{placement:"bottom-end","show-arrow":!1,teleported:!1,width:100,trigger:"hover",offset:0},{reference:s(()=>[n("div",Re,[t(T,{name:"more",class:"icon"})])]),default:s(()=>[n("div",Ee,[n("div",{class:"dropdown-item",onClick:D(E=>Y(e.id),["stop"])},"编辑",8,Oe),n("div",{class:"dropdown-item del",onClick:D(E=>ee(e.id),["stop"])},"删除",8,Pe)])]),_:2},1024)],8,ze)]),_:2},1024))),128))]),_:1})])])]),t(G,{visible:p.value,"onUpdate:visible":a[4]||(a[4]=e=>p.value=e),title:j.value,confirmName:"确定",closeName:"取消",onConfirm:oe,onClose:z,width:"640px"},{main:s(()=>[n("div",Ae,[n("div",{class:"imgiconbox",onClick:D(ae,["stop"])},[l.avatarUrl?(r(),v("img",{key:1,src:l.avatarUrl,alt:""},null,8,Le)):(r(),h(T,{key:0,name:"ImgAdd",class:"imgaddicon"}))],8,Ge)]),t(pe,{ref_key:"ruleFormRef",ref:k,model:l,"status-icon":"",rules:W,"label-position":"top","label-width":"80px",class:"demo-ruleForm"},{default:s(()=>[t(g,{label:"知识库名称",prop:"name"},{default:s(()=>[t($,{modelValue:l.name,"onUpdate:modelValue":a[0]||(a[0]=e=>l.name=e),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),t(g,{label:"知识库描述",prop:"description"},{default:s(()=>[t($,{modelValue:l.description,"onUpdate:modelValue":a[1]||(a[1]=e=>l.description=e),modelModifiers:{trim:!0},type:"textarea",rows:4,placeholder:"请输入对此知识库的描述"},null,8,["modelValue"])]),_:1}),t(g,{label:"索引模型",prop:"vectorModel"},{default:s(()=>[t(ue,{modelValue:l.vectorModel,"onUpdate:modelValue":a[2]||(a[2]=e=>l.vectorModel=e),placeholder:"选择",disabled:y.value},{default:s(()=>[(r(!0),v(F,null,M(N.value,(e,_)=>(r(),h(de,{label:e.name,value:e.model,key:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),t(g,{label:"标签",prop:"tags"},{default:s(()=>[t($,{modelValue:l.tags[0],"onUpdate:modelValue":a[3]||(a[3]=e=>l.tags[0]=e)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","title"]),t(G,{visible:m.value,"onUpdate:visible":a[5]||(a[5]=e=>m.value=e),title:"选择头像",onConfirm:se,onClose:le,width:"640px"},{main:s(()=>[t(R,{span:24,class:"avatrow"},{default:s(()=>[(r(),v(F,null,M(41,e=>t(U,{key:e,span:4,gutter:12,class:"avatcol"},{default:s(()=>[n("img",{onClick:_=>te(e),class:be(["avatarImg",e==d.value?"active":""]),src:`https://autoagents.oss-cn-beijing.aliyuncs.com/static/avatar/${e}.${[4,12,16,20,22].includes(e)?"jpg":"png"}`,alt:""},null,10,Qe),e==d.value?(r(),h(I,{key:0,color:"#4060FF",size:"18px"},{default:s(()=>[t(me)]),_:1})):Ce("",!0)]),_:2},1024)),64))]),_:1})]),_:1},8,["visible"])])}}});const ta=De(He,[["__scopeId","data-v-0c8a2fad"]]);export{ta as default};
