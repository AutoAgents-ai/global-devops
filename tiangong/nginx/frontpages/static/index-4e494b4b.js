import{H as b,aJ as F,ah as w,l as d,m as r,p as e,u as Q,V as s,P as x,F as T,a8 as V,J as q,aG as J,r as U,e as M,d as W,T as L,U as R,S as Z,aD as B,aE as j,a3 as P,c as z}from"./vue-82a6b7fc.js";import{u as K,a as H,b as O,d as ee,C as te}from"./index-5de957b7.js";import{_ as Y}from"./index-570c8e90.js";import{h as ne}from"./element-4990942a.js";import{l as se}from"./agent-b0285fd2.js";import"./agent-e87197b5.js";import"./index-ebc61d5c.js";import"./vxe-45effba2.js";const ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANTSURBVHgBzVg9bNNQEP5eYOkPUiSK2gkZCQk22q7NkA6FbgWVhYkgYGJATF2AthudiIANqjQLLCDajR+JGqldqbtRCYRhAgmkDBQmKPfl2cFxnh07adJ+0sXOy8n35e7evTsrpES+sGPJZUpkmF9Fsp4QFRHXE1tkxV5SLlJAJVUUIgW5XPRIpIEjVop2SZWTKDclJETycimJWGgPrliba0ZMxRBhGOZErmN3URSZl1BWkJSQlyfPofOkE3BFxk35pSLIrKL9EDWDCwMpFSLDMG10gYwPxyNVC18mpDDXRTIEU2I2uFDzkLetS9gb0Es2bw4GFmdNmv29Wkz4+UtLEEMDyXUDoCOO8abqoTjvTJ8Gzk+Yn0LjznugvAKMjQCTuf/GTYSuziIaCgXWKN9DkbVmUwxuGwx8/Q58+CJERoGZy/r7ldvAoT7g+FEzoVjsoCCfZeVt809RevRQbqRx3Q9leVm8tAU8nNek6DUSNRG6dR+xyByARQ9NxSl9lIf39zSub25pAndnxNgT4Okr7Rka5R/o620k1Ax//+Ast30+TsmU0FxjmJgzC4vAtQvAy3XZwye1pwYH0CqG6SErTmPtnZYwnr3WxpnUVdI7+vrgsf6tReQzaLEQMlwkOni4PhxtkCGyJJTF/kE2g30GEqqgRURV8DZQaZkQ602wAA4d0fUnN4p24HKX2SKFKA1u5VMn6tfoGd8w75ncPDpYAliXeM+kD4KJnyDhXXrIidMwhYUPv/NIGyAx/0ryPK/CZFLApofkaKz2uZGEaCgMEmDYSI4F8saC9s70hJlQQpIr/mnPljVv0qDRcMh8A99+yFw0pQm9WNOnPuuSqWUh8fUNxMGRnmjEP+3LUYQmx4AzOfMT/Pbj5j3tMVZu33gYTQkpHaVgx8gT3wrr8Z/29Zifsf270Tg9FAV6NAKueKfaoAU7xkvQ00YdmnR6aYxGQ1V7+SpqldrraYvoPurG7PDRwSxw0D24ns0a6gh589E5T7EbZMbDI3XD4epNkuPoLCl/QHTDPxhPe0+RnXQncqoYRYZI8jqmAD2zWWgPrpJRZ7Wk3sYppX1hxXEp7RsRW6ws7doLKzQSs6AnlTy01yjBV3oV6A7CkbFm+c2i+owU+AdOuB7Rr1KudAAAAABJRU5ErkJggg==",oe={class:"aside-angent"},ie={class:"logo-box"},ce={class:"agent-box"},de=["onClick"],re=["src"],le=b({__name:"Aside",props:{agentId:{}},setup(f){const{agentHistory:I}=K(),l=F(),m=g=>{l.push({name:"dialogue",query:{agentId:g}})};return(g,o)=>{const _=w("svg-icon"),y=w("el-scrollbar");return d(),r("div",oe,[e("div",ie,[e("img",{src:ae,class:"logo",onClick:o[0]||(o[0]=(...i)=>Q(l).back&&Q(l).back(...i))})]),e("div",ce,[s(y,null,{default:x(()=>[(d(!0),r(T,null,V(Q(I),i=>(d(),r("div",{class:q(["item",{active:g.agentId==i.agentId}]),key:i.agentId,onClick:E=>m(i.agentId)},[e("img",{src:i.avatar,class:"agent-logo"},null,8,re),s(_,{name:"agent-active",class:"agent-active"})],10,de))),128))]),_:1})])])}}});const ue=Y(le,[["__scopeId","data-v-8f6984f7"]]),X=f=>(B("data-v-112e4135"),f=f(),j(),f),ge={class:"dialogue-history"},_e={class:"dialogue-header"},pe={class:"history-list"},me={key:0,class:"create"},he=X(()=>e("span",null,"新的对话",-1)),Ae=["onClick"],ve={class:"more"},fe={class:"item-dropdown"},Ie={class:"dropdown-menu"},ye=["onClick"],ke=["onClick"],we={class:"agent-footer"},Ce={class:"link"},De={class:"item"},Re={class:"item"},xe={class:"item"},Ue=X(()=>e("p",null,"V 1.0",-1)),Ee=b({__name:"DialogueList",props:{agentInfo:{},agentId:{}},setup(f,{expose:I}){const l=f,m=F(),g=J(),o=U([]),_=M(()=>g.query.chatId||""),y=async()=>{const{data:n}=await H({agentUUid:l.agentId});o.value=E(n)},i=n=>{m.push({name:"dialogue",query:{agentId:l.agentId,chatId:n.id}})};function E(n){const C=new Date,A=new Date(C.getTime()-6*24*60*60*1e3),N=n.reduce((a,v)=>{const u=new Date(v.createAt),c=`${u.getFullYear()}-${u.getMonth()+1}`;return u>=A&&u<=C?(a.近7天||(a.近7天=[]),a.近7天.push(v)):(a[c]||(a[c]=[]),a[c].push(v)),a},{});return Object.entries(N).map(([a,v])=>{const u=a==="近7天",c=!u;let k="";if(u)k="近7天";else if(c){const[p,D]=a.split("-").map(Number),$=new Date().getFullYear();p!==$?k=`${p}年${D}月`:k=`${D}月`}return{title:k,items:v}})}const h=()=>{m.push({name:"dialogue",query:{agentId:l.agentId}})},t=n=>{ne.prompt("","自定义历史会话标题",{}).then(async C=>{await O({chatId:n.id,customTitle:C.value,top:!1}),y()})},S=async n=>{await ee({chatId:n.id}),m.push({name:"dialogue",query:{agentId:n.agentId}})};return W(()=>l.agentId,n=>{n&&y()},{immediate:!0}),I({getAgentChatHistory:y}),(n,C)=>{var v,u;const A=w("svg-icon"),N=w("el-text"),G=w("el-popover"),a=w("el-scrollbar");return d(),r("div",ge,[e("div",_e,[e("h3",null,[L(R((v=n.agentInfo)==null?void 0:v.name)+" ",1),s(A,{name:"Edit",class:"edit-icon",onClick:h})]),e("p",null,[s(N,{"line-clamp":2},{default:x(()=>{var c;return[L(R((c=n.agentInfo)==null?void 0:c.intro),1)]}),_:1})])]),e("div",pe,[_.value?Z("",!0):(d(),r("div",me,[s(A,{name:"new-dialogue",class:"create-icon"}),he])),s(a,null,{default:x(()=>[(d(!0),r(T,null,V(o.value,(c,k)=>(d(),r("div",{class:"list",key:k},[e("h4",null,R(c.title),1),(d(!0),r(T,null,V(c.items,p=>(d(),r("div",{class:q(["item",{active:_.value==p.id}]),key:p.id,onClick:D=>i(p)},[e("span",null,R(p.title),1),e("div",ve,[s(G,{placement:"bottom-end","show-arrow":!1,teleported:!1,width:120,trigger:"hover",offset:0},{reference:x(()=>[e("div",fe,[s(A,{name:"more",class:"more-icon"})])]),default:x(()=>[e("div",Ie,[e("div",{class:"dropdown-item",onClick:P(D=>t(p),["stop"])},"自定义标题",8,ye),e("div",{class:"dropdown-item del",onClick:P(D=>S(p),["stop"])},"删除",8,ke)])]),_:2},1024)])],10,Ae))),128))]))),128))]),_:1})]),e("div",we,[e("div",Ce,[e("div",De,[s(A,{name:"agent-footer-icon1"})]),e("div",Re,[s(A,{name:"agent-footer-icon2"})]),e("div",xe,[s(A,{name:"agent-footer-icon3"})])]),e("p",null,R((u=n.agentInfo)==null?void 0:u.name),1),Ue])])}}});const Qe=Y(Ee,[["__scopeId","data-v-112e4135"]]),Se={class:"dialogue-container"},Ne={key:0,class:"aside-container"},Te=b({__name:"index",setup(f){const I=J(),{setAgentHistory:l}=K(),m=U(),g=U();let o=U(!0);const _=U(""),y=M(()=>I.query.chatId||""),i=async h=>{const{data:t}=await se(h);t.uuid=t.agentUuid,_.value=t.agentUuid,t.guides=t.guides.map(S=>({guide:S})),g.value=t,l({avatar:t==null?void 0:t.avatar,name:t==null?void 0:t.name,agentId:t.agentUuid})};z(()=>{window.innerWidth<=1200?o.value=!1:window.innerWidth>1200&&(o.value=!0),window.addEventListener("resize",()=>{window.innerWidth<=1200?o.value=!1:window.innerWidth>1200&&(o.value=!0)})});const E=()=>{m.value.getAgentChatHistory()};return W(()=>[I.query.hash,I.query.agentId],h=>{h[0]?i({hash:h[0]}):i({agentUUid:h[1]})},{immediate:!0}),(h,t)=>(d(),r("div",Se,[Q(o)===!0?(d(),r("div",Ne,[s(ue,{agentId:_.value},null,8,["agentId"]),s(Qe,{ref_key:"dialogueListRef",ref:m,agentInfo:g.value,agentId:_.value},null,8,["agentInfo","agentId"])])):Z("",!0),s(te,{class:"chat-container",agentId:_.value,chatId:y.value,agentData:g.value,onRefreshHistory:E},null,8,["agentId","chatId","agentData"])]))}});const Je=Y(Te,[["__scopeId","data-v-6c544efe"]]);export{Je as default};
