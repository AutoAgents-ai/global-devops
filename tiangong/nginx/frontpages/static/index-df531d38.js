import{H as S,aJ as F,ah as w,l as d,m as r,p as e,u as V,V as s,P as x,F as b,a8 as T,J as G,aG as q,r as U,e as J,d as K,T as M,U as R,S as W,aD as j,aE as B,a3 as P,c as H}from"./vue-82a6b7fc.js";import{u as X,a as z,b as $,d as ee,C as te}from"./index-c18194c5.js";import{_ as Y,f as ne}from"./index-65e7859b.js";import{h as se}from"./element-4990942a.js";import{l as ae}from"./agent-51f92b5b.js";import"./agent-1726939f.js";import"./index-ebc61d5c.js";import"./vxe-45effba2.js";const oe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANTSURBVHgBzVg9bNNQEP5eYOkPUiSK2gkZCQk22q7NkA6FbgWVhYkgYGJATF2AthudiIANqjQLLCDajR+JGqldqbtRCYRhAgmkDBQmKPfl2cFxnh07adJ+0sXOy8n35e7evTsrpES+sGPJZUpkmF9Fsp4QFRHXE1tkxV5SLlJAJVUUIgW5XPRIpIEjVop2SZWTKDclJETycimJWGgPrliba0ZMxRBhGOZErmN3URSZl1BWkJSQlyfPofOkE3BFxk35pSLIrKL9EDWDCwMpFSLDMG10gYwPxyNVC18mpDDXRTIEU2I2uFDzkLetS9gb0Es2bw4GFmdNmv29Wkz4+UtLEEMDyXUDoCOO8abqoTjvTJ8Gzk+Yn0LjznugvAKMjQCTuf/GTYSuziIaCgXWKN9DkbVmUwxuGwx8/Q58+CJERoGZy/r7ldvAoT7g+FEzoVjsoCCfZeVt809RevRQbqRx3Q9leVm8tAU8nNek6DUSNRG6dR+xyByARQ9NxSl9lIf39zSub25pAndnxNgT4Okr7Rka5R/o620k1Ax//+Ast30+TsmU0FxjmJgzC4vAtQvAy3XZwye1pwYH0CqG6SErTmPtnZYwnr3WxpnUVdI7+vrgsf6tReQzaLEQMlwkOni4PhxtkCGyJJTF/kE2g30GEqqgRURV8DZQaZkQ602wAA4d0fUnN4p24HKX2SKFKA1u5VMn6tfoGd8w75ncPDpYAliXeM+kD4KJnyDhXXrIidMwhYUPv/NIGyAx/0ryPK/CZFLApofkaKz2uZGEaCgMEmDYSI4F8saC9s70hJlQQpIr/mnPljVv0qDRcMh8A99+yFw0pQm9WNOnPuuSqWUh8fUNxMGRnmjEP+3LUYQmx4AzOfMT/Pbj5j3tMVZu33gYTQkpHaVgx8gT3wrr8Z/29Zifsf270Tg9FAV6NAKueKfaoAU7xkvQ00YdmnR6aYxGQ1V7+SpqldrraYvoPurG7PDRwSxw0D24ns0a6gh589E5T7EbZMbDI3XD4epNkuPoLCl/QHTDPxhPe0+RnXQncqoYRYZI8jqmAD2zWWgPrpJRZ7Wk3sYppX1hxXEp7RsRW6ws7doLKzQSs6AnlTy01yjBV3oV6A7CkbFm+c2i+owU+AdOuB7Rr1KudAAAAABJRU5ErkJggg==",ie={class:"aside-angent"},ce={class:"logo-box"},de={class:"agent-box"},re=["onClick"],le=["src"],ue=S({__name:"Aside",props:{agentId:{}},setup(v){const{agentHistory:f}=X(),l=F(),m=g=>{l.push({name:"dialogue",query:{agentId:g}})};return(g,o)=>{const _=w("svg-icon"),I=w("el-scrollbar");return d(),r("div",ie,[e("div",ce,[e("img",{src:oe,class:"logo",onClick:o[0]||(o[0]=(...i)=>V(l).back&&V(l).back(...i))})]),e("div",de,[s(I,null,{default:x(()=>[(d(!0),r(b,null,T(V(f),i=>(d(),r("div",{class:G(["item",{active:g.agentId==i.agentId}]),key:i.agentId,onClick:E=>m(i.agentId)},[e("img",{src:i.avatar,class:"agent-logo"},null,8,le),s(_,{name:"agent-active",class:"agent-active"})],10,re))),128))]),_:1})])])}}});const ge=Y(ue,[["__scopeId","data-v-8f6984f7"]]),Z=v=>(j("data-v-edde65a1"),v=v(),B(),v),_e={class:"dialogue-history"},pe={class:"dialogue-header"},me={class:"history-list"},he={key:0,class:"create"},Ae=Z(()=>e("span",null,"新的对话",-1)),ve=["onClick"],fe={class:"more"},Ie={class:"item-dropdown"},ye={class:"dropdown-menu"},ke=["onClick"],we=["onClick"],Ce={class:"agent-footer"},De={class:"link"},Re={class:"item"},xe={class:"item"},Ue={class:"item"},Ee=Z(()=>e("p",null,"V 1.0",-1)),Ve=S({__name:"DialogueList",props:{agentInfo:{},agentId:{}},setup(v,{expose:f}){const l=v,m=F(),g=q(),o=U([]),_=J(()=>g.query.chatId||""),I=async()=>{const{data:n}=await z({agentUUid:l.agentId});o.value=E(n)},i=n=>{m.push({name:"dialogue",query:{agentId:l.agentId,chatId:n.id}})};function E(n){const C=new Date,h=new Date(C.getTime()-6*24*60*60*1e3),Q=n.reduce((a,A)=>{const u=new Date(A.createAt),c=`${u.getFullYear()}-${u.getMonth()+1}`;return u>=h&&u<=C?(a.近7天||(a.近7天=[]),a.近7天.push(A)):(a[c]||(a[c]=[]),a[c].push(A)),a},{});return Object.entries(Q).map(([a,A])=>{const u=a==="近7天",c=!u;let k="";if(u)k="近7天";else if(c){const[p,D]=a.split("-").map(Number),O=new Date().getFullYear();p!==O?k=`${p}年${D}月`:k=`${D}月`}return{title:k,items:A}})}const y=()=>{m.push({name:"dialogue",query:{agentId:l.agentId}})},t=n=>{se.prompt("","自定义历史会话标题",{}).then(async C=>{await $({chatId:n.id,customTitle:C.value,top:!1}),I()})},N=async n=>{await ee({chatId:n.id}),m.push({name:"dialogue",query:{agentId:n.agentId}})};return K(()=>l.agentId,n=>{n&&I()},{immediate:!0}),f({getAgentChatHistory:I}),(n,C)=>{var A,u;const h=w("svg-icon"),Q=w("el-text"),L=w("el-popover"),a=w("el-scrollbar");return d(),r("div",_e,[e("div",pe,[e("h3",null,[M(R((A=n.agentInfo)==null?void 0:A.name)+" ",1),s(h,{name:"Edit",class:"edit-icon",onClick:y})]),e("p",null,[s(Q,{"line-clamp":2},{default:x(()=>{var c;return[M(R((c=n.agentInfo)==null?void 0:c.intro),1)]}),_:1})])]),e("div",me,[_.value?W("",!0):(d(),r("div",he,[s(h,{name:"new-dialogue",class:"create-icon"}),Ae])),s(a,null,{default:x(()=>[(d(!0),r(b,null,T(o.value,(c,k)=>(d(),r("div",{class:"list",key:k},[e("h4",null,R(c.title),1),(d(!0),r(b,null,T(c.items,p=>(d(),r("div",{class:G(["item",{active:_.value==p.id}]),key:p.id,onClick:D=>i(p)},[e("span",null,R(p.title),1),e("div",fe,[s(L,{placement:"bottom-end","show-arrow":!1,teleported:!1,width:120,trigger:"hover",offset:0},{reference:x(()=>[e("div",Ie,[s(h,{name:"more",class:"more-icon"})])]),default:x(()=>[e("div",ye,[e("div",{class:"dropdown-item",onClick:P(D=>t(p),["stop"])},"自定义标题",8,ke),e("div",{class:"dropdown-item del",onClick:P(D=>N(p),["stop"])},"删除",8,we)])]),_:2},1024)])],10,ve))),128))]))),128))]),_:1})]),e("div",Ce,[e("div",De,[e("div",Re,[s(h,{name:"agent-footer-icon1"})]),e("div",xe,[s(h,{name:"agent-footer-icon2"})]),e("div",Ue,[s(h,{name:"agent-footer-icon3"})])]),e("p",null,R((u=n.agentInfo)==null?void 0:u.name),1),Ee])])}}});const Ne=Y(Ve,[["__scopeId","data-v-edde65a1"]]),Qe={class:"dialogue-container"},be={key:0,class:"aside-container"},Te=S({__name:"index",setup(v){const f=q(),{setAgentHistory:l}=X(),m=U(),g=U();let o=U(!0);const _=U(""),I=J(()=>f.query.chatId||""),i=async y=>{const{data:t}=await ae();t.uuid=t.agentUuid,_.value=t.agentUuid,t.guides=t.guides.map(N=>({guide:N})),g.value=t,l({avatar:t==null?void 0:t.avatar,name:t==null?void 0:t.name,agentId:t.agentUuid})};H(()=>{ne.set("k_sso_token","Nmb5Mmgbf577gPjVcmCBpPs_GK0CNn0fOX8Ukifw_-Il9u2Fz66FVnn2xMhM3qkTJ1MHs4O22YE0-aoLKrM2EzHvcsrJo4dYV4RvKy_IOkip-OQbnVoWXXcP3jxRZc1TOWNOK3saIUc1fmL6nF4m605UtCBLjsRMHOc1fgUvH_o.cv4"),window.innerWidth<=1200?o.value=!1:window.innerWidth>1200&&(o.value=!0),window.addEventListener("resize",()=>{window.innerWidth<=1200?o.value=!1:window.innerWidth>1200&&(o.value=!0)})});const E=()=>{m.value.getAgentChatHistory()};return K(()=>[f.query.hash,f.query.agentId],y=>{y[0]?i({hash:y[0]}):i({agentUUid:y[1]})},{immediate:!0}),(y,t)=>(d(),r("div",Qe,[V(o)===!0?(d(),r("div",be,[s(ge,{agentId:_.value},null,8,["agentId"]),s(Ne,{ref_key:"dialogueListRef",ref:m,agentInfo:g.value,agentId:_.value},null,8,["agentInfo","agentId"])])):W("",!0),s(te,{class:"chat-container",agentId:_.value,chatId:I.value,agentData:g.value,onRefreshHistory:E},null,8,["agentId","chatId","agentData"])]))}});const Je=Y(Te,[["__scopeId","data-v-53d3326c"]]);export{Je as default};
