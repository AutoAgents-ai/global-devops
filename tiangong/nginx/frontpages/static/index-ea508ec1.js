import{H as N,aD as G,ah as k,l,m as u,p as e,u as E,V as a,P as x,F as Q,a8 as S,J as P,aE as L,r as R,e as q,d as J,T as Y,U as w,S as B,aF as j,aG as W,a3 as F}from"./vue-6e387ee8.js";import{u as M,a as z,b as H,d as O,C as ee}from"./index-8a6d9d8c.js";import{_ as T}from"./index-0c15d20b.js";import{f as te}from"./element-3f409242.js";import{k as se}from"./agent-776835a8.js";import"./agent-ac1dba84.js";import"./index-8b71f48f.js";import"./index-7f15ee15.js";import"./vxe-e514f80f.js";const ae="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANTSURBVHgBzVg9bNNQEP5eYOkPUiSK2gkZCQk22q7NkA6FbgWVhYkgYGJATF2AthudiIANqjQLLCDajR+JGqldqbtRCYRhAgmkDBQmKPfl2cFxnh07adJ+0sXOy8n35e7evTsrpES+sGPJZUpkmF9Fsp4QFRHXE1tkxV5SLlJAJVUUIgW5XPRIpIEjVop2SZWTKDclJETycimJWGgPrliba0ZMxRBhGOZErmN3URSZl1BWkJSQlyfPofOkE3BFxk35pSLIrKL9EDWDCwMpFSLDMG10gYwPxyNVC18mpDDXRTIEU2I2uFDzkLetS9gb0Es2bw4GFmdNmv29Wkz4+UtLEEMDyXUDoCOO8abqoTjvTJ8Gzk+Yn0LjznugvAKMjQCTuf/GTYSuziIaCgXWKN9DkbVmUwxuGwx8/Q58+CJERoGZy/r7ldvAoT7g+FEzoVjsoCCfZeVt809RevRQbqRx3Q9leVm8tAU8nNek6DUSNRG6dR+xyByARQ9NxSl9lIf39zSub25pAndnxNgT4Okr7Rka5R/o620k1Ax//+Ast30+TsmU0FxjmJgzC4vAtQvAy3XZwye1pwYH0CqG6SErTmPtnZYwnr3WxpnUVdI7+vrgsf6tReQzaLEQMlwkOni4PhxtkCGyJJTF/kE2g30GEqqgRURV8DZQaZkQ602wAA4d0fUnN4p24HKX2SKFKA1u5VMn6tfoGd8w75ncPDpYAliXeM+kD4KJnyDhXXrIidMwhYUPv/NIGyAx/0ryPK/CZFLApofkaKz2uZGEaCgMEmDYSI4F8saC9s70hJlQQpIr/mnPljVv0qDRcMh8A99+yFw0pQm9WNOnPuuSqWUh8fUNxMGRnmjEP+3LUYQmx4AzOfMT/Pbj5j3tMVZu33gYTQkpHaVgx8gT3wrr8Z/29Zifsf270Tg9FAV6NAKueKfaoAU7xkvQ00YdmnR6aYxGQ1V7+SpqldrraYvoPurG7PDRwSxw0D24ns0a6gh589E5T7EbZMbDI3XD4epNkuPoLCl/QHTDPxhPe0+RnXQncqoYRYZI8jqmAD2zWWgPrpJRZ7Wk3sYppX1hxXEp7RsRW6ws7doLKzQSs6AnlTy01yjBV3oV6A7CkbFm+c2i+owU+AdOuB7Rr1KudAAAAABJRU5ErkJggg==",ne={class:"aside-angent"},oe={class:"logo-box"},ce={class:"agent-box"},ie=["onClick"],de=["src"],re=N({__name:"Aside",props:{agentId:{}},setup(v){const{agentHistory:f}=M(),i=G(),p=g=>{i.push({name:"dialogue",query:{agentId:g}})};return(g,d)=>{const I=k("svg-icon"),m=k("el-scrollbar");return l(),u("div",ne,[e("div",oe,[e("img",{src:ae,class:"logo",onClick:d[0]||(d[0]=(...r)=>E(i).back&&E(i).back(...r))})]),e("div",ce,[a(m,null,{default:x(()=>[(l(!0),u(Q,null,S(E(f),r=>(l(),u("div",{class:P(["item",{active:g.agentId==r.agentId}]),key:r.agentId,onClick:_=>p(r.agentId)},[e("img",{src:r.avatar,class:"agent-logo"},null,8,de),a(I,{name:"agent-active",class:"agent-active"})],10,ie))),128))]),_:1})])])}}});const le=T(re,[["__scopeId","data-v-8f6984f7"]]),Z=v=>(j("data-v-c8dcd4c1"),v=v(),W(),v),ue={class:"dialogue-history"},ge={class:"dialogue-header"},_e={class:"history-list"},pe={key:0,class:"create"},me=Z(()=>e("span",null,"新的对话",-1)),he=["onClick"],Ae={class:"more"},ve={class:"item-dropdown"},fe={class:"dropdown-menu"},Ie=["onClick"],ye=["onClick"],ke={class:"agent-footer"},Ce={class:"link"},De={class:"item"},we={class:"item"},xe={class:"item"},Re=Z(()=>e("p",null,"V 1.0",-1)),Ue=N({__name:"DialogueList",props:{agentInfo:{},agentId:{}},setup(v,{expose:f}){const i=v,p=G(),g=L(),d=R([]),I=q(()=>g.query.chatId||""),m=async()=>{const{data:t}=await z({agentUUid:i.agentId});d.value=_(t)},r=t=>{p.push({name:"dialogue",query:{agentId:i.agentId,chatId:t.id}})};function _(t){const C=new Date,h=new Date(C.getTime()-6*24*60*60*1e3),U=t.reduce((o,A)=>{const n=new Date(A.createAt),y=`${n.getFullYear()}-${n.getMonth()+1}`;return n>=h&&n<=C&&(o.近7天||(o.近7天=[]),o.近7天.push(A)),o[y]||(o[y]=[]),o[y].push(A),o},{});return Object.entries(U).map(([o,A])=>{const n=o==="近7天",y=!n;let c="";if(n)c="近7天";else if(y){const[D,b]=o.split("-").map(Number),$=new Date().getFullYear();D!==$?c=`${D}年${b}月`:c=`${b}月`}return{title:c,items:A}})}const s=()=>{p.push({name:"dialogue",query:{agentId:i.agentId}})},K=t=>{te.prompt("","自定义历史会话标题",{}).then(async C=>{await H({chatId:t.id,customTitle:C.value,top:!1}),m()})},X=async t=>{await O({chatId:t.id}),p.push({name:"dialogue",query:{agentId:t.agentId}})};return J(()=>i.agentId,t=>{t&&m()},{immediate:!0}),f({getAgentChatHistory:m}),(t,C)=>{var A;const h=k("svg-icon"),U=k("el-text"),V=k("el-popover"),o=k("el-scrollbar");return l(),u("div",ue,[e("div",ge,[e("h3",null,[Y(w((A=t.agentInfo)==null?void 0:A.name)+" ",1),a(h,{name:"Edit",class:"edit-icon",onClick:s})]),e("p",null,[a(U,{"line-clamp":2},{default:x(()=>{var n;return[Y(w((n=t.agentInfo)==null?void 0:n.intro),1)]}),_:1})])]),e("div",_e,[I.value?B("",!0):(l(),u("div",pe,[a(h,{name:"new-dialogue",class:"create-icon"}),me])),a(o,null,{default:x(()=>[(l(!0),u(Q,null,S(d.value,(n,y)=>(l(),u("div",{class:"list",key:y},[e("h4",null,w(n.title),1),(l(!0),u(Q,null,S(n.items,c=>(l(),u("div",{class:P(["item",{active:I.value==c.id}]),key:c.id,onClick:D=>r(c)},[e("span",null,w(c.title),1),e("div",Ae,[a(V,{placement:"bottom-end","show-arrow":!1,teleported:!1,width:120,trigger:"hover",offset:0},{reference:x(()=>[e("div",ve,[a(h,{name:"more",class:"more-icon"})])]),default:x(()=>[e("div",fe,[e("div",{class:"dropdown-item",onClick:F(D=>K(c),["stop"])},"自定义标题",8,Ie),e("div",{class:"dropdown-item del",onClick:F(D=>X(c),["stop"])},"删除",8,ye)])]),_:2},1024)])],10,he))),128))]))),128))]),_:1})]),e("div",ke,[e("div",Ce,[e("div",De,[a(h,{name:"agent-footer-icon1"})]),e("div",we,[a(h,{name:"agent-footer-icon2"})]),e("div",xe,[a(h,{name:"agent-footer-icon3"})])]),e("p",null,"行政问题小助手"+w(I.value),1),Re])])}}});const Ee=T(Ue,[["__scopeId","data-v-c8dcd4c1"]]),Qe={class:"dialogue-container"},Se={class:"aside-container"},Ne=N({__name:"index",setup(v){const f=L(),{setAgentHistory:i}=M(),p=R(),g=R(),d=R(),I=q(()=>f.query.chatId||""),m=async _=>{const{data:s}=await se(_);s.uuid=s.agentUuid,d.value=s.agentUuid,g.value=s,i({avatar:s==null?void 0:s.avatar,name:s==null?void 0:s.name,agentId:s.agentUuid})},r=()=>{p.value.getAgentChatHistory()};return J(()=>[f.query.hash,f.query.agentId],_=>{_[0]?m({hash:_[0]}):m({agentUUid:_[1]})},{immediate:!0}),(_,s)=>(l(),u("div",Qe,[e("div",Se,[a(le,{agentId:d.value},null,8,["agentId"]),a(Ee,{ref_key:"dialogueListRef",ref:p,agentInfo:g.value,agentId:d.value},null,8,["agentInfo","agentId"])]),a(ee,{class:"chat-container",agentId:d.value,chatId:I.value,agentData:g.value,onRefreshHistory:r},null,8,["agentId","chatId","agentData"])]))}});const Je=T(Ne,[["__scopeId","data-v-87430137"]]);export{Je as default};
