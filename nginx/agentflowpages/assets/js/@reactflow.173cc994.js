import{r as x,j as E}from"./react.3139565a.js";import"./d3-transition.42ff895a.js";import{z as Ro,i as Le}from"./d3-zoom.f9fb7460.js";import{c as le}from"./classcat.fbd937ed.js";import{u as _o,s as re,c as To}from"./zustand.b96a3e62.js";import{r as Io}from"./react-dom.84320756.js";import{s as fn,p as Bo}from"./d3-selection.a6bf8644.js";import{d as jo}from"./d3-drag.0d22c9fb.js";const lt=x.createContext(null),zo=lt.Provider,ge={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},gn=ge.error001();function U(e,t){const n=x.useContext(lt);if(n===null)throw new Error(gn);return _o(n,e,t)}const ne=()=>{const e=x.useContext(lt);if(e===null)throw new Error(gn);return x.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Ho=e=>e.userSelectionActive?"none":"all";function Lo({position:e,children:t,className:n,style:o,...s}){const i=U(Ho),r=`${e}`.split("-");return E.jsx("div",{className:le(["react-flow__panel",n,...r]),style:{...o,pointerEvents:i},...s,children:t})}function Oo({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:E.jsx(Lo,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:E.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Vo=({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:r=[2,4],labelBgBorderRadius:c=2,children:l,className:d,...a})=>{const u=x.useRef(null),[h,f]=x.useState({x:0,y:0,width:0,height:0}),m=le(["react-flow__edge-textwrapper",d]);return x.useEffect(()=>{if(u.current){const g=u.current.getBBox();f({x:g.x,y:g.y,width:g.width,height:g.height})}},[n]),typeof n>"u"||!n?null:E.jsxs("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:m,visibility:h.width?"visible":"hidden",...a,children:[s&&E.jsx("rect",{width:h.width+2*r[0],x:-r[0],y:-r[1],height:h.height+2*r[1],className:"react-flow__edge-textbg",style:i,rx:c,ry:c}),E.jsx("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:u,style:o,children:n}),l]})};var Fo=x.memo(Vo);const Pt=e=>({width:e.offsetWidth,height:e.offsetHeight}),Fe=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),$t=(e={x:0,y:0},t)=>({x:Fe(e.x,t[0][0],t[1][0]),y:Fe(e.y,t[0][1],t[1][1])}),Vt=(e,t,n)=>e<t?Fe(Math.abs(e-t),1,50)/50:e>n?-Fe(Math.abs(e-n),1,50)/50:0,hn=(e,t)=>{const n=Vt(e.x,35,t.width-35)*20,o=Vt(e.y,35,t.height-35)*20;return[n,o]},pn=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},Yo=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),vt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),Zo=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),Ft=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),bt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Xo=e=>ae(e.width)&&ae(e.height)&&ae(e.x)&&ae(e.y),ae=e=>!isNaN(e)&&isFinite(e),J=Symbol.for("internals"),yn=["Enter"," ","Escape"],Wo=(e,t)=>{},Ko=e=>"nativeEvent"in e;function wt(e){var s,i;const t=Ko(e)?e.nativeEvent:e,n=((i=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const mn=e=>"clientX"in e,be=(e,t)=>{var i,r;const n=mn(e),o=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,s=n?e.clientY:(r=e.touches)==null?void 0:r[0].clientY;return{x:o-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},rt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Je=({id:e,path:t,labelX:n,labelY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:d,style:a,markerEnd:u,markerStart:h,interactionWidth:f=20})=>E.jsxs(E.Fragment,{children:[E.jsx("path",{id:e,style:a,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:u,markerStart:h}),f&&E.jsx("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}),s&&ae(n)&&ae(o)?E.jsx(Fo,{x:n,y:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:d}):null]});Je.displayName="BaseEdge";function Ke(e,t,n){return n===void 0?n:o=>{const s=t().edges.find(i=>i.id===e);s&&n(o,{...s})}}function xn({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,r=Math.abs(o-t)/2,c=o<t?o+r:o-r;return[i,c,s,r]}function Sn({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:i,targetControlX:r,targetControlY:c}){const l=e*.125+s*.375+r*.375+n*.125,d=t*.125+i*.375+c*.375+o*.125,a=Math.abs(l-e),u=Math.abs(d-t);return[l,d,a,u]}var De;(function(e){e.Strict="strict",e.Loose="loose"})(De||(De={}));var ke;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(ke||(ke={}));var qe;(function(e){e.Partial="partial",e.Full="full"})(qe||(qe={}));var Se;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Se||(Se={}));var it;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(it||(it={}));var B;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(B||(B={}));function Yt({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===B.Left||e===B.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function bn({sourceX:e,sourceY:t,sourcePosition:n=B.Bottom,targetX:o,targetY:s,targetPosition:i=B.Top}){const[r,c]=Yt({pos:n,x1:e,y1:t,x2:o,y2:s}),[l,d]=Yt({pos:i,x1:o,y1:s,x2:e,y2:t}),[a,u,h,f]=Sn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:r,sourceControlY:c,targetControlX:l,targetControlY:d});return[`M${e},${t} C${r},${c} ${l},${d} ${o},${s}`,a,u,h,f]}const kt=x.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=B.Bottom,targetPosition:i=B.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:d,labelBgPadding:a,labelBgBorderRadius:u,style:h,markerEnd:f,markerStart:m,interactionWidth:g})=>{const[y,S,b]=bn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i});return E.jsx(Je,{path:y,labelX:S,labelY:b,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:d,labelBgPadding:a,labelBgBorderRadius:u,style:h,markerEnd:f,markerStart:m,interactionWidth:g})});kt.displayName="SimpleBezierEdge";const Zt={[B.Left]:{x:-1,y:0},[B.Right]:{x:1,y:0},[B.Top]:{x:0,y:-1},[B.Bottom]:{x:0,y:1}},Uo=({source:e,sourcePosition:t=B.Bottom,target:n})=>t===B.Left||t===B.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Xt=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Go({source:e,sourcePosition:t=B.Bottom,target:n,targetPosition:o=B.Top,center:s,offset:i}){const r=Zt[t],c=Zt[o],l={x:e.x+r.x*i,y:e.y+r.y*i},d={x:n.x+c.x*i,y:n.y+c.y*i},a=Uo({source:l,sourcePosition:t,target:d}),u=a.x!==0?"x":"y",h=a[u];let f=[],m,g;const y={x:0,y:0},S={x:0,y:0},[b,N,C,$]=xn({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(r[u]*c[u]===-1){m=s.x||b,g=s.y||N;const v=[{x:m,y:l.y},{x:m,y:d.y}],T=[{x:l.x,y:g},{x:d.x,y:g}];r[u]===h?f=u==="x"?v:T:f=u==="x"?T:v}else{const v=[{x:l.x,y:d.y}],T=[{x:d.x,y:l.y}];if(u==="x"?f=r.x===h?T:v:f=r.y===h?v:T,t===o){const w=Math.abs(e[u]-n[u]);if(w<=i){const D=Math.min(i-1,i-w);r[u]===h?y[u]=(l[u]>e[u]?-1:1)*D:S[u]=(d[u]>n[u]?-1:1)*D}}if(t!==o){const w=u==="x"?"y":"x",D=r[u]===c[w],_=l[w]>d[w],j=l[w]<d[w];(r[u]===1&&(!D&&_||D&&j)||r[u]!==1&&(!D&&j||D&&_))&&(f=u==="x"?v:T)}const R={x:l.x+y.x,y:l.y+y.y},H={x:d.x+S.x,y:d.y+S.y},P=Math.max(Math.abs(R.x-f[0].x),Math.abs(H.x-f[0].x)),k=Math.max(Math.abs(R.y-f[0].y),Math.abs(H.y-f[0].y));P>=k?(m=(R.x+H.x)/2,g=f[0].y):(m=f[0].x,g=(R.y+H.y)/2)}return[[e,{x:l.x+y.x,y:l.y+y.y},...f,{x:d.x+S.x,y:d.y+S.y},n],m,g,C,$]}function qo(e,t,n,o){const s=Math.min(Xt(e,t)/2,Xt(t,n)/2,o),{x:i,y:r}=t;if(e.x===i&&i===n.x||e.y===r&&r===n.y)return`L${i} ${r}`;if(e.y===r){const d=e.x<n.x?-1:1,a=e.y<n.y?1:-1;return`L ${i+s*d},${r}Q ${i},${r} ${i},${r+s*a}`}const c=e.x<n.x?1:-1,l=e.y<n.y?-1:1;return`L ${i},${r+s*l}Q ${i},${r} ${i+s*c},${r}`}function Et({sourceX:e,sourceY:t,sourcePosition:n=B.Bottom,targetX:o,targetY:s,targetPosition:i=B.Top,borderRadius:r=5,centerX:c,centerY:l,offset:d=20}){const[a,u,h,f,m]=Go({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:i,center:{x:c,y:l},offset:d});return[a.reduce((y,S,b)=>{let N="";return b>0&&b<a.length-1?N=qo(a[b-1],S,a[b+1],r):N=`${b===0?"M":"L"}${S.x} ${S.y}`,y+=N,y},""),u,h,f,m]}const dt=x.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:d,style:a,sourcePosition:u=B.Bottom,targetPosition:h=B.Top,markerEnd:f,markerStart:m,pathOptions:g,interactionWidth:y})=>{const[S,b,N]=Et({sourceX:e,sourceY:t,sourcePosition:u,targetX:n,targetY:o,targetPosition:h,borderRadius:g==null?void 0:g.borderRadius,offset:g==null?void 0:g.offset});return E.jsx(Je,{path:S,labelX:b,labelY:N,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:d,style:a,markerEnd:f,markerStart:m,interactionWidth:y})});dt.displayName="SmoothStepEdge";const Dt=x.memo(e=>{var t;return E.jsx(dt,{...e,pathOptions:x.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Dt.displayName="StepEdge";function Qo({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,i,r,c]=xn({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,i,r,c]}const Rt=x.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:d,style:a,markerEnd:u,markerStart:h,interactionWidth:f})=>{const[m,g,y]=Qo({sourceX:e,sourceY:t,targetX:n,targetY:o});return E.jsx(Je,{path:m,labelX:g,labelY:y,label:s,labelStyle:i,labelShowBg:r,labelBgStyle:c,labelBgPadding:l,labelBgBorderRadius:d,style:a,markerEnd:u,markerStart:h,interactionWidth:f})});Rt.displayName="StraightEdge";function tt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Wt({pos:e,x1:t,y1:n,x2:o,y2:s,c:i}){switch(e){case B.Left:return[t-tt(t-o,i),n];case B.Right:return[t+tt(o-t,i),n];case B.Top:return[t,n-tt(n-s,i)];case B.Bottom:return[t,n+tt(s-n,i)]}}function wn({sourceX:e,sourceY:t,sourcePosition:n=B.Bottom,targetX:o,targetY:s,targetPosition:i=B.Top,curvature:r=.25}){const[c,l]=Wt({pos:n,x1:e,y1:t,x2:o,y2:s,c:r}),[d,a]=Wt({pos:i,x1:o,y1:s,x2:e,y2:t,c:r}),[u,h,f,m]=Sn({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:l,targetControlX:d,targetControlY:a});return[`M${e},${t} C${c},${l} ${d},${a} ${o},${s}`,u,h,f,m]}const ct=x.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=B.Bottom,targetPosition:i=B.Top,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:d,labelBgPadding:a,labelBgBorderRadius:u,style:h,markerEnd:f,markerStart:m,pathOptions:g,interactionWidth:y})=>{const[S,b,N]=wn({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:i,curvature:g==null?void 0:g.curvature});return E.jsx(Je,{path:S,labelX:b,labelY:N,label:r,labelStyle:c,labelShowBg:l,labelBgStyle:d,labelBgPadding:a,labelBgBorderRadius:u,style:h,markerEnd:f,markerStart:m,interactionWidth:y})});ct.displayName="BezierEdge";const _t=x.createContext(null),Jo=_t.Provider;_t.Consumer;const es=()=>x.useContext(_t),ts=e=>"id"in e&&"source"in e&&"target"in e,ns=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${n}${o||""}`,Nt=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,os=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),ss=(e,t)=>{if(!e.source||!e.target)return t;let n;return ts(e)?n={...e}:n={...e,id:ns(e)},os(n,t)?t:t.concat(n)},En=({x:e,y:t},[n,o,s],i,[r,c])=>{const l={x:(e-n)/s,y:(t-o)/s};return i?{x:r*Math.round(l.x/r),y:c*Math.round(l.y/c)}:l},rs=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o}),Oe=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-o}:s}},Tt=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const{x:i,y:r}=Oe(s,t).positionAbsolute;return Yo(o,vt({x:i,y:r,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Zo(n)},Nn=(e,t,[n,o,s]=[0,0,1],i=!1,r=!1,c=[0,0])=>{const l={x:(t.x-n)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},d=[];return e.forEach(a=>{const{width:u,height:h,selectable:f=!0,hidden:m=!1}=a;if(r&&!f||m)return!1;const{positionAbsolute:g}=Oe(a,c),y={x:g.x,y:g.y,width:u||0,height:h||0},S=bt(l,y),b=typeof u>"u"||typeof h>"u"||u===null||h===null,N=i&&S>0,C=(u||0)*(h||0);(b||N||S>=C||a.dragging)&&d.push(a)}),d},Cn=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},Mn=(e,t,n,o,s,i=.1)=>{const r=t/(e.width*(1+i)),c=n/(e.height*(1+i)),l=Math.min(r,c),d=Fe(l,o,s),a=e.x+e.width/2,u=e.y+e.height/2,h=t/2-a*d,f=n/2-u*d;return[h,f,d]},ve=(e,t=0)=>e.transition().duration(t);function Kt(e,t,n,o){return(t[n]||[]).reduce((s,i)=>{var r,c;return`${e.id}-${i.id}-${n}`!==o&&s.push({id:i.id||null,type:n,nodeId:e.id,x:(((r=e.positionAbsolute)==null?void 0:r.x)??0)+i.x+i.width/2,y:(((c=e.positionAbsolute)==null?void 0:c.y)??0)+i.y+i.height/2}),s},[])}function is(e,t,n,o,s,i){const{x:r,y:c}=be(e),d=t.elementsFromPoint(r,c).find(m=>m.classList.contains("react-flow__handle"));if(d){const m=d.getAttribute("data-nodeid");if(m){const g=It(void 0,d),y=d.getAttribute("data-handleid"),S=i({nodeId:m,id:y,type:g});if(S)return{handle:{id:y,type:g,nodeId:m,x:n.x,y:n.y},validHandleResult:S}}}let a=[],u=1/0;if(s.forEach(m=>{const g=Math.sqrt((m.x-n.x)**2+(m.y-n.y)**2);if(g<=o){const y=i(m);g<=u&&(g<u?a=[{handle:m,validHandleResult:y}]:g===u&&a.push({handle:m,validHandleResult:y}),u=g)}}),!a.length)return{handle:null,validHandleResult:An()};if(a.length===1)return a[0];const h=a.some(({validHandleResult:m})=>m.isValid),f=a.some(({handle:m})=>m.type==="target");return a.find(({handle:m,validHandleResult:g})=>f?m.type==="target":h?g.isValid:!0)||a[0]}const cs={source:null,target:null,sourceHandle:null,targetHandle:null},An=()=>({handleDomNode:null,isValid:!1,connection:cs,endHandle:null});function Pn(e,t,n,o,s,i,r){const c=s==="target",l=r.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...An(),handleDomNode:l};if(l){const a=It(void 0,l),u=l.getAttribute("data-nodeid"),h=l.getAttribute("data-handleid"),f=l.classList.contains("connectable"),m=l.classList.contains("connectableend"),g={source:c?u:n,sourceHandle:c?h:o,target:c?n:u,targetHandle:c?o:h};d.connection=g,f&&m&&(t===De.Strict?c&&a==="source"||!c&&a==="target":u!==n||h!==o)&&(d.endHandle={nodeId:u,handleId:h,type:a},d.isValid=i(g))}return d}function as({nodes:e,nodeId:t,handleId:n,handleType:o}){return e.reduce((s,i)=>{if(i[J]){const{handleBounds:r}=i[J];let c=[],l=[];r&&(c=Kt(i,r,"source",`${t}-${n}-${o}`),l=Kt(i,r,"target",`${t}-${n}-${o}`)),s.push(...c,...l)}return s},[])}function It(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function pt(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function ls(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function $n({event:e,handleId:t,nodeId:n,onConnect:o,isTarget:s,getState:i,setState:r,isValidConnection:c,edgeUpdaterType:l,onEdgeUpdateEnd:d}){const a=pn(e.target),{connectionMode:u,domNode:h,autoPanOnConnect:f,connectionRadius:m,onConnectStart:g,panBy:y,getNodes:S,cancelConnection:b}=i();let N=0,C;const{x:$,y:A}=be(e),v=a==null?void 0:a.elementFromPoint($,A),T=It(l,v),R=h==null?void 0:h.getBoundingClientRect();if(!R||!T)return;let H,P=be(e,R),k=!1,w=null,D=!1,_=null;const j=as({nodes:S(),nodeId:n,handleId:t,handleType:T}),L=()=>{if(!f)return;const[M,I]=hn(P,R);y({x:M,y:I}),N=requestAnimationFrame(L)};r({connectionPosition:P,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:T,connectionStartHandle:{nodeId:n,handleId:t,type:T},connectionEndHandle:null}),g==null||g(e,{nodeId:n,handleId:t,handleType:T});function z(M){const{transform:I}=i();P=be(M,R);const{handle:V,validHandleResult:F}=is(M,a,En(P,I,!1,[1,1]),m,j,Z=>Pn(Z,u,n,t,s?"target":"source",c,a));if(C=V,k||(L(),k=!0),_=F.handleDomNode,w=F.connection,D=F.isValid,r({connectionPosition:C&&D?rs({x:C.x,y:C.y},I):P,connectionStatus:ls(!!C,D),connectionEndHandle:F.endHandle}),!C&&!D&&!_)return pt(H);w.source!==w.target&&_&&(pt(H),H=_,_.classList.add("connecting","react-flow__handle-connecting"),_.classList.toggle("valid",D),_.classList.toggle("react-flow__handle-valid",D))}function p(M){var I,V;(C||_)&&w&&D&&(o==null||o(w)),(V=(I=i()).onConnectEnd)==null||V.call(I,M),l&&(d==null||d(M)),pt(H),b(),cancelAnimationFrame(N),k=!1,D=!1,w=null,_=null,a.removeEventListener("mousemove",z),a.removeEventListener("mouseup",p),a.removeEventListener("touchmove",z),a.removeEventListener("touchend",p)}a.addEventListener("mousemove",z),a.addEventListener("mouseup",p),a.addEventListener("touchmove",z),a.addEventListener("touchend",p)}const Ut=()=>!0,ds=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),us=(e,t,n)=>o=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:r}=o;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(r==null?void 0:r.nodeId)===e&&(r==null?void 0:r.handleId)===t&&(r==null?void 0:r.type)===n}},vn=x.forwardRef(({type:e="source",position:t=B.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:r,onConnect:c,children:l,className:d,onMouseDown:a,onTouchStart:u,...h},f)=>{var R,H;const m=r||null,g=e==="target",y=ne(),S=es(),{connectOnClick:b,noPanClassName:N}=U(ds,re),{connecting:C,clickConnecting:$}=U(us(S,m,e),re);S||(H=(R=y.getState()).onError)==null||H.call(R,"010",ge.error010());const A=P=>{const{defaultEdgeOptions:k,onConnect:w,hasDefaultEdges:D}=y.getState(),_={...k,...P};if(D){const{edges:j,setEdges:L}=y.getState();L(ss(_,j))}w==null||w(_),c==null||c(_)},v=P=>{if(!S)return;const k=mn(P);s&&(k&&P.button===0||!k)&&$n({event:P,handleId:m,nodeId:S,onConnect:A,isTarget:g,getState:y.getState,setState:y.setState,isValidConnection:n||y.getState().isValidConnection||Ut}),k?a==null||a(P):u==null||u(P)},T=P=>{const{onClickConnectStart:k,onClickConnectEnd:w,connectionClickStartHandle:D,connectionMode:_,isValidConnection:j}=y.getState();if(!S||!D&&!s)return;if(!D){k==null||k(P,{nodeId:S,handleId:m,handleType:e}),y.setState({connectionClickStartHandle:{nodeId:S,type:e,handleId:m}});return}const L=pn(P.target),z=n||j||Ut,{connection:p,isValid:M}=Pn({nodeId:S,id:m,type:e},_,D.nodeId,D.handleId||null,D.type,z,L);M&&A(p),w==null||w(P),y.setState({connectionClickStartHandle:null})};return E.jsx("div",{"data-handleid":m,"data-nodeid":S,"data-handlepos":t,"data-id":`${S}-${m}-${e}`,className:le(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",N,d,{source:!g,target:g,connectable:o,connectablestart:s,connectableend:i,connecting:$,connectionindicator:o&&(s&&!C||i&&C)}]),onMouseDown:v,onTouchStart:v,onClick:b?T:void 0,ref:f,...h,children:l})});vn.displayName="Handle";var at=x.memo(vn);const kn=({data:e,isConnectable:t,targetPosition:n=B.Top,sourcePosition:o=B.Bottom})=>E.jsxs(E.Fragment,{children:[E.jsx(at,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,E.jsx(at,{type:"source",position:o,isConnectable:t})]});kn.displayName="DefaultNode";var Ct=x.memo(kn);const Dn=({data:e,isConnectable:t,sourcePosition:n=B.Bottom})=>E.jsxs(E.Fragment,{children:[e==null?void 0:e.label,E.jsx(at,{type:"source",position:n,isConnectable:t})]});Dn.displayName="InputNode";var Rn=x.memo(Dn);const _n=({data:e,isConnectable:t,targetPosition:n=B.Top})=>E.jsxs(E.Fragment,{children:[E.jsx(at,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]});_n.displayName="OutputNode";var Tn=x.memo(_n);const Bt=()=>null;Bt.displayName="GroupNode";const fs=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected)}),nt=e=>e.id;function gs(e,t){return re(e.selectedNodes.map(nt),t.selectedNodes.map(nt))&&re(e.selectedEdges.map(nt),t.selectedEdges.map(nt))}const In=x.memo(({onSelectionChange:e})=>{const t=ne(),{selectedNodes:n,selectedEdges:o}=U(fs,gs);return x.useEffect(()=>{var i,r;const s={nodes:n,edges:o};e==null||e(s),(r=(i=t.getState()).onSelectionChange)==null||r.call(i,s)},[n,o,e]),null});In.displayName="SelectionListener";const hs=e=>!!e.onSelectionChange;function ps({onSelectionChange:e}){const t=U(hs);return e||t?E.jsx(In,{onSelectionChange:e}):null}const ys=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Ie(e,t){x.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Y(e,t,n){x.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const ms=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:s,onConnectStart:i,onConnectEnd:r,onClickConnectStart:c,onClickConnectEnd:l,nodesDraggable:d,nodesConnectable:a,nodesFocusable:u,edgesFocusable:h,edgesUpdatable:f,elevateNodesOnSelect:m,minZoom:g,maxZoom:y,nodeExtent:S,onNodesChange:b,onEdgesChange:N,elementsSelectable:C,connectionMode:$,snapGrid:A,snapToGrid:v,translateExtent:T,connectOnClick:R,defaultEdgeOptions:H,fitView:P,fitViewOptions:k,onNodesDelete:w,onEdgesDelete:D,onNodeDrag:_,onNodeDragStart:j,onNodeDragStop:L,onSelectionDrag:z,onSelectionDragStart:p,onSelectionDragStop:M,noPanClassName:I,nodeOrigin:V,rfId:F,autoPanOnConnect:Z,autoPanOnNodeDrag:X,onError:G,connectionRadius:ee,isValidConnection:Q})=>{const{setNodes:te,setEdges:K,setDefaultNodesAndEdges:ie,setMinZoom:de,setMaxZoom:fe,setTranslateExtent:q,setNodeExtent:W,reset:se}=U(ys,re),O=ne();return x.useEffect(()=>{const he=o==null?void 0:o.map(we=>({...we,...H}));return ie(n,he),()=>{se()}},[]),Y("defaultEdgeOptions",H,O.setState),Y("connectionMode",$,O.setState),Y("onConnect",s,O.setState),Y("onConnectStart",i,O.setState),Y("onConnectEnd",r,O.setState),Y("onClickConnectStart",c,O.setState),Y("onClickConnectEnd",l,O.setState),Y("nodesDraggable",d,O.setState),Y("nodesConnectable",a,O.setState),Y("nodesFocusable",u,O.setState),Y("edgesFocusable",h,O.setState),Y("edgesUpdatable",f,O.setState),Y("elementsSelectable",C,O.setState),Y("elevateNodesOnSelect",m,O.setState),Y("snapToGrid",v,O.setState),Y("snapGrid",A,O.setState),Y("onNodesChange",b,O.setState),Y("onEdgesChange",N,O.setState),Y("connectOnClick",R,O.setState),Y("fitViewOnInit",P,O.setState),Y("fitViewOnInitOptions",k,O.setState),Y("onNodesDelete",w,O.setState),Y("onEdgesDelete",D,O.setState),Y("onNodeDrag",_,O.setState),Y("onNodeDragStart",j,O.setState),Y("onNodeDragStop",L,O.setState),Y("onSelectionDrag",z,O.setState),Y("onSelectionDragStart",p,O.setState),Y("onSelectionDragStop",M,O.setState),Y("noPanClassName",I,O.setState),Y("nodeOrigin",V,O.setState),Y("rfId",F,O.setState),Y("autoPanOnConnect",Z,O.setState),Y("autoPanOnNodeDrag",X,O.setState),Y("onError",G,O.setState),Y("connectionRadius",ee,O.setState),Y("isValidConnection",Q,O.setState),Ie(e,te),Ie(t,K),Ie(g,de),Ie(y,fe),Ie(T,q),Ie(S,W),null},Gt={display:"none"},xs={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Bn="react-flow__node-desc",jn="react-flow__edge-desc",Ss="react-flow__aria-live",bs=e=>e.ariaLiveMessage;function ws({rfId:e}){const t=U(bs);return E.jsx("div",{id:`${Ss}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:xs,children:t})}function Es({rfId:e,disableKeyboardA11y:t}){return E.jsxs(E.Fragment,{children:[E.jsxs("div",{id:`${Bn}-${e}`,style:Gt,children:["Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),E.jsx("div",{id:`${jn}-${e}`,style:Gt,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!t&&E.jsx(ws,{rfId:e})]})}const Ns=typeof document<"u"?document:null;var Qe=(e=null,t={target:Ns})=>{const[n,o]=x.useState(!1),s=x.useRef(!1),i=x.useRef(new Set([])),[r,c]=x.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(u=>typeof u=="string").map(u=>u.split("+")),a=d.reduce((u,h)=>u.concat(...h),[]);return[d,a]}return[[],[]]},[e]);return x.useEffect(()=>{var l,d;if(e!==null){const a=f=>{if(s.current=f.ctrlKey||f.metaKey||f.shiftKey,!s.current&&wt(f))return!1;const m=Qt(f.code,c);i.current.add(f[m]),qt(r,i.current,!1)&&(f.preventDefault(),o(!0))},u=f=>{if(!s.current&&wt(f))return!1;const m=Qt(f.code,c);qt(r,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(f[m]),f.key==="Meta"&&i.current.clear(),s.current=!1},h=()=>{i.current.clear(),o(!1)};return(l=t==null?void 0:t.target)==null||l.addEventListener("keydown",a),(d=t==null?void 0:t.target)==null||d.addEventListener("keyup",u),window.addEventListener("blur",h),()=>{var f,m;(f=t==null?void 0:t.target)==null||f.removeEventListener("keydown",a),(m=t==null?void 0:t.target)==null||m.removeEventListener("keyup",u),window.removeEventListener("blur",h)}}},[e,o]),n};function qt(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function Qt(e,t){return t.includes(e)?"code":"key"}function zn(e,t,n,o){var r,c;if(!e.parentNode)return n;const s=t.get(e.parentNode),i=Oe(s,o);return zn(s,t,{x:(n.x??0)+i.x,y:(n.y??0)+i.y,z:(((r=s[J])==null?void 0:r.z)??0)>(n.z??0)?((c=s[J])==null?void 0:c.z)??0:n.z??0},o)}function Hn(e,t,n){e.forEach(o=>{var s;if(o.parentNode&&!e.has(o.parentNode))throw new Error(`Parent node ${o.parentNode} not found`);if(o.parentNode||n!=null&&n[o.id]){const{x:i,y:r,z:c}=zn(o,e,{...o.position,z:((s=o[J])==null?void 0:s.z)??0},t);o.positionAbsolute={x:i,y:r},o[J].z=c,n!=null&&n[o.id]&&(o[J].isParent=!0)}})}function yt(e,t,n,o){const s=new Map,i={},r=o?1e3:0;return e.forEach(c=>{var u;const l=(ae(c.zIndex)?c.zIndex:0)+(c.selected?r:0),d=t.get(c.id),a={width:d==null?void 0:d.width,height:d==null?void 0:d.height,...c,positionAbsolute:{x:c.position.x,y:c.position.y}};c.parentNode&&(a.parentNode=c.parentNode,i[c.parentNode]=!0),Object.defineProperty(a,J,{enumerable:!1,value:{handleBounds:(u=d==null?void 0:d[J])==null?void 0:u.handleBounds,z:l}}),s.set(c.id,a)}),Hn(s,n,i),s}function Ln(e,t={}){const{getNodes:n,width:o,height:s,minZoom:i,maxZoom:r,d3Zoom:c,d3Selection:l,fitViewOnInitDone:d,fitViewOnInit:a,nodeOrigin:u}=e(),h=t.initial&&!d&&a;if(c&&l&&(h||!t.initial)){const m=n().filter(y=>{var b;const S=t.includeHiddenNodes?y.width&&y.height:!y.hidden;return(b=t.nodes)!=null&&b.length?S&&t.nodes.some(N=>N.id===y.id):S}),g=m.every(y=>y.width&&y.height);if(m.length>0&&g){const y=Tt(m,u),[S,b,N]=Mn(y,o,s,t.minZoom??i,t.maxZoom??r,t.padding??.1),C=Le.translate(S,b).scale(N);return typeof t.duration=="number"&&t.duration>0?c.transform(ve(l,t.duration),C):c.transform(l,C),!0}}return!1}function Cs(e,t){return e.forEach(n=>{const o=t.get(n.id);o&&t.set(o.id,{...o,[J]:o[J],selected:n.selected})}),new Map(t)}function Ms(e,t){return t.map(n=>{const o=e.find(s=>s.id===n.id);return o&&(n.selected=o.selected),n})}function ot({changedNodes:e,changedEdges:t,get:n,set:o}){const{nodeInternals:s,edges:i,onNodesChange:r,onEdgesChange:c,hasDefaultNodes:l,hasDefaultEdges:d}=n();e!=null&&e.length&&(l&&o({nodeInternals:Cs(e,s)}),r==null||r(e)),t!=null&&t.length&&(d&&o({edges:Ms(t,i)}),c==null||c(t))}const Be=()=>{},As={zoomIn:Be,zoomOut:Be,zoomTo:Be,getZoom:()=>1,setViewport:Be,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Be,fitBounds:Be,project:e=>e,viewportInitialized:!1},Ps=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),$s=()=>{const e=ne(),{d3Zoom:t,d3Selection:n}=U(Ps,re);return x.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy(ve(n,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(ve(n,s==null?void 0:s.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo(ve(n,i==null?void 0:i.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[r,c,l]=e.getState().transform,d=Le.translate(s.x??r,s.y??c).scale(s.zoom??l);t.transform(ve(n,i==null?void 0:i.duration),d)},getViewport:()=>{const[s,i,r]=e.getState().transform;return{x:s,y:i,zoom:r}},fitView:s=>Ln(e.getState,s),setCenter:(s,i,r)=>{const{width:c,height:l,maxZoom:d}=e.getState(),a=typeof(r==null?void 0:r.zoom)<"u"?r.zoom:d,u=c/2-s*a,h=l/2-i*a,f=Le.translate(u,h).scale(a);t.transform(ve(n,r==null?void 0:r.duration),f)},fitBounds:(s,i)=>{const{width:r,height:c,minZoom:l,maxZoom:d}=e.getState(),[a,u,h]=Mn(s,r,c,l,d,(i==null?void 0:i.padding)??.1),f=Le.translate(a,u).scale(h);t.transform(ve(n,i==null?void 0:i.duration),f)},project:s=>{const{transform:i,snapToGrid:r,snapGrid:c}=e.getState();return En(s,i,r,c)},viewportInitialized:!0}:As,[t,n])};function On(){const e=$s(),t=ne(),n=x.useCallback(()=>t.getState().getNodes().map(g=>({...g})),[]),o=x.useCallback(g=>t.getState().nodeInternals.get(g),[]),s=x.useCallback(()=>{const{edges:g=[]}=t.getState();return g.map(y=>({...y}))},[]),i=x.useCallback(g=>{const{edges:y=[]}=t.getState();return y.find(S=>S.id===g)},[]),r=x.useCallback(g=>{const{getNodes:y,setNodes:S,hasDefaultNodes:b,onNodesChange:N}=t.getState(),C=y(),$=typeof g=="function"?g(C):g;if(b)S($);else if(N){const A=$.length===0?C.map(v=>({type:"remove",id:v.id})):$.map(v=>({item:v,type:"reset"}));N(A)}},[]),c=x.useCallback(g=>{const{edges:y=[],setEdges:S,hasDefaultEdges:b,onEdgesChange:N}=t.getState(),C=typeof g=="function"?g(y):g;if(b)S(C);else if(N){const $=C.length===0?y.map(A=>({type:"remove",id:A.id})):C.map(A=>({item:A,type:"reset"}));N($)}},[]),l=x.useCallback(g=>{const y=Array.isArray(g)?g:[g],{getNodes:S,setNodes:b,hasDefaultNodes:N,onNodesChange:C}=t.getState();if(N){const A=[...S(),...y];b(A)}else if(C){const $=y.map(A=>({item:A,type:"add"}));C($)}},[]),d=x.useCallback(g=>{const y=Array.isArray(g)?g:[g],{edges:S=[],setEdges:b,hasDefaultEdges:N,onEdgesChange:C}=t.getState();if(N)b([...S,...y]);else if(C){const $=y.map(A=>({item:A,type:"add"}));C($)}},[]),a=x.useCallback(()=>{const{getNodes:g,edges:y=[],transform:S}=t.getState(),[b,N,C]=S;return{nodes:g().map($=>({...$})),edges:y.map($=>({...$})),viewport:{x:b,y:N,zoom:C}}},[]),u=x.useCallback(({nodes:g,edges:y})=>{const{nodeInternals:S,getNodes:b,edges:N,hasDefaultNodes:C,hasDefaultEdges:$,onNodesDelete:A,onEdgesDelete:v,onNodesChange:T,onEdgesChange:R}=t.getState(),H=(g||[]).map(_=>_.id),P=(y||[]).map(_=>_.id),k=b().reduce((_,j)=>{const L=!H.includes(j.id)&&j.parentNode&&_.find(p=>p.id===j.parentNode);return(typeof j.deletable=="boolean"?j.deletable:!0)&&(H.includes(j.id)||L)&&_.push(j),_},[]),w=N.filter(_=>typeof _.deletable=="boolean"?_.deletable:!0),D=w.filter(_=>P.includes(_.id));if(k||D){const _=Cn(k,w),j=[...D,..._],L=j.reduce((z,p)=>(z.includes(p.id)||z.push(p.id),z),[]);if(($||C)&&($&&t.setState({edges:N.filter(z=>!L.includes(z.id))}),C&&(k.forEach(z=>{S.delete(z.id)}),t.setState({nodeInternals:new Map(S)}))),L.length>0&&(v==null||v(j),R&&R(L.map(z=>({id:z,type:"remove"})))),k.length>0&&(A==null||A(k),T)){const z=k.map(p=>({id:p.id,type:"remove"}));T(z)}}},[]),h=x.useCallback(g=>{const y=Xo(g),S=y?null:t.getState().nodeInternals.get(g.id);return[y?g:Ft(S),S,y]},[]),f=x.useCallback((g,y=!0,S)=>{const[b,N,C]=h(g);return b?(S||t.getState().getNodes()).filter($=>{if(!C&&($.id===N.id||!$.positionAbsolute))return!1;const A=Ft($),v=bt(A,b);return y&&v>0||v>=g.width*g.height}):[]},[]),m=x.useCallback((g,y,S=!0)=>{const[b]=h(g);if(!b)return!1;const N=bt(b,y);return S&&N>0||N>=g.width*g.height},[]);return x.useMemo(()=>({...e,getNodes:n,getNode:o,getEdges:s,getEdge:i,setNodes:r,setEdges:c,addNodes:l,addEdges:d,toObject:a,deleteElements:u,getIntersectingNodes:f,isNodeIntersecting:m}),[e,n,o,s,i,r,c,l,d,a,u,f,m])}var vs=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ne(),{deleteElements:o}=On(),s=Qe(e),i=Qe(t);x.useEffect(()=>{if(s){const{edges:r,getNodes:c}=n.getState(),l=c().filter(a=>a.selected),d=r.filter(a=>a.selected);o({nodes:l,edges:d}),n.setState({nodesSelectionActive:!1})}},[s]),x.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function ks(e){const t=ne();x.useEffect(()=>{let n;const o=()=>{var i,r;if(!e.current)return;const s=Pt(e.current);(s.height===0||s.width===0)&&((r=(i=t.getState()).onError)==null||r.call(i,"004",ge.error004())),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(n=new ResizeObserver(()=>o()),n.observe(e.current)),()=>{window.removeEventListener("resize",o),n&&e.current&&n.unobserve(e.current)}},[])}const jt={position:"absolute",width:"100%",height:"100%",top:0,left:0},Ds=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,st=e=>({x:e.x,y:e.y,zoom:e.k}),je=(e,t)=>e.target.closest(`.${t}`),Jt=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),en=e=>{const t=e.ctrlKey&&rt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},Rs=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),_s=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:r=!1,panOnScrollSpeed:c=.5,panOnScrollMode:l=ke.Free,zoomOnDoubleClick:d=!0,elementsSelectable:a,panOnDrag:u=!0,defaultViewport:h,translateExtent:f,minZoom:m,maxZoom:g,zoomActivationKeyCode:y,preventScrolling:S=!0,children:b,noWheelClassName:N,noPanClassName:C})=>{const $=x.useRef(),A=ne(),v=x.useRef(!1),T=x.useRef(!1),R=x.useRef(null),H=x.useRef({x:0,y:0,zoom:0}),{d3Zoom:P,d3Selection:k,d3ZoomHandler:w,userSelectionActive:D}=U(Rs,re),_=Qe(y),j=x.useRef(0),L=x.useRef(!1),z=x.useRef();return ks(R),x.useEffect(()=>{if(R.current){const p=R.current.getBoundingClientRect(),M=Ro().scaleExtent([m,g]).translateExtent(f),I=fn(R.current).call(M),V=Le.translate(h.x,h.y).scale(Fe(h.zoom,m,g)),F=[[0,0],[p.width,p.height]],Z=M.constrain()(V,F,f);M.transform(I,Z),M.wheelDelta(en),A.setState({d3Zoom:M,d3Selection:I,d3ZoomHandler:I.on("wheel.zoom"),transform:[Z.x,Z.y,Z.k],domNode:R.current.closest(".react-flow")})}},[]),x.useEffect(()=>{k&&P&&(r&&!_&&!D?k.on("wheel.zoom",p=>{if(je(p,N))return!1;p.preventDefault(),p.stopImmediatePropagation();const M=k.property("__zoom").k||1,I=rt();if(p.ctrlKey&&i&&I){const te=Bo(p),K=en(p),ie=M*Math.pow(2,K);P.scaleTo(k,ie,te,p);return}const V=p.deltaMode===1?20:1;let F=l===ke.Vertical?0:p.deltaX*V,Z=l===ke.Horizontal?0:p.deltaY*V;!I&&p.shiftKey&&l!==ke.Vertical&&(F=p.deltaY*V,Z=0),P.translateBy(k,-(F/M)*c,-(Z/M)*c,{internal:!0});const X=st(k.property("__zoom")),{onViewportChangeStart:G,onViewportChange:ee,onViewportChangeEnd:Q}=A.getState();clearTimeout(z.current),L.current||(L.current=!0,t==null||t(p,X),G==null||G(X)),L.current&&(e==null||e(p,X),ee==null||ee(X),z.current=setTimeout(()=>{n==null||n(p,X),Q==null||Q(X),L.current=!1},150))},{passive:!1}):typeof w<"u"&&k.on("wheel.zoom",function(p,M){if(!S||je(p,N))return null;p.preventDefault(),w.call(this,p,M)},{passive:!1}))},[D,r,l,k,P,w,_,i,S,N,t,e,n]),x.useEffect(()=>{P&&P.on("start",p=>{var V,F;if(!p.sourceEvent||p.sourceEvent.internal)return null;j.current=(V=p.sourceEvent)==null?void 0:V.button;const{onViewportChangeStart:M}=A.getState(),I=st(p.transform);v.current=!0,H.current=I,((F=p.sourceEvent)==null?void 0:F.type)==="mousedown"&&A.setState({paneDragging:!0}),M==null||M(I),t==null||t(p.sourceEvent,I)})},[P,t]),x.useEffect(()=>{P&&(D&&!v.current?P.on("zoom",null):D||P.on("zoom",p=>{var I;const{onViewportChange:M}=A.getState();if(A.setState({transform:[p.transform.x,p.transform.y,p.transform.k]}),T.current=!!(o&&Jt(u,j.current??0)),(e||M)&&!((I=p.sourceEvent)!=null&&I.internal)){const V=st(p.transform);M==null||M(V),e==null||e(p.sourceEvent,V)}}))},[D,P,e,u,o]),x.useEffect(()=>{P&&P.on("end",p=>{if(!p.sourceEvent||p.sourceEvent.internal)return null;const{onViewportChangeEnd:M}=A.getState();if(v.current=!1,A.setState({paneDragging:!1}),o&&Jt(u,j.current??0)&&!T.current&&o(p.sourceEvent),T.current=!1,(n||M)&&Ds(H.current,p.transform)){const I=st(p.transform);H.current=I,clearTimeout($.current),$.current=setTimeout(()=>{M==null||M(I),n==null||n(p.sourceEvent,I)},r?150:0)}})},[P,r,u,n,o]),x.useEffect(()=>{P&&P.filter(p=>{const M=_||s,I=i&&p.ctrlKey;if(p.button===1&&p.type==="mousedown"&&(je(p,"react-flow__node")||je(p,"react-flow__edge")))return!0;if(!u&&!M&&!r&&!d&&!i||D||!d&&p.type==="dblclick"||je(p,N)&&p.type==="wheel"||je(p,C)&&p.type!=="wheel"||!i&&p.ctrlKey&&p.type==="wheel"||!M&&!r&&!I&&p.type==="wheel"||!u&&(p.type==="mousedown"||p.type==="touchstart")||Array.isArray(u)&&!u.includes(p.button)&&(p.type==="mousedown"||p.type==="touchstart"))return!1;const V=Array.isArray(u)&&u.includes(p.button)||!p.button||p.button<=1;return(!p.ctrlKey||p.type==="wheel")&&V})},[D,P,s,i,r,d,u,a,_]),E.jsx("div",{className:"react-flow__renderer",ref:R,style:jt,children:b})},Ts=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Is(){const{userSelectionActive:e,userSelectionRect:t}=U(Ts,re);return e&&t?E.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function tn(e,t){const n=e.find(o=>o.id===t.parentNode);if(n){const o=t.position.x+t.width-n.width,s=t.position.y+t.height-n.height;if(o>0||s>0||t.position.x<0||t.position.y<0){if(n.style={...n.style},n.style.width=n.style.width??n.width,n.style.height=n.style.height??n.height,o>0&&(n.style.width+=o),s>0&&(n.style.height+=s),t.position.x<0){const i=Math.abs(t.position.x);n.position.x=n.position.x-i,n.style.width+=i,t.position.x=0}if(t.position.y<0){const i=Math.abs(t.position.y);n.position.y=n.position.y-i,n.style.height+=i,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function Bs(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const n=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const i=e.filter(c=>c.id===s.id);if(i.length===0)return o.push(s),o;const r={...s};for(const c of i)if(c)switch(c.type){case"select":{r.selected=c.selected;break}case"position":{typeof c.position<"u"&&(r.position=c.position),typeof c.positionAbsolute<"u"&&(r.positionAbsolute=c.positionAbsolute),typeof c.dragging<"u"&&(r.dragging=c.dragging),r.expandParent&&tn(o,r);break}case"dimensions":{typeof c.dimensions<"u"&&(r.width=c.dimensions.width,r.height=c.dimensions.height),typeof c.updateStyle<"u"&&(r.style={...r.style||{},...c.dimensions}),typeof c.resizing=="boolean"&&(r.resizing=c.resizing),r.expandParent&&tn(o,r);break}case"remove":return o}return o.push(r),o},n)}function js(e,t){return Bs(e,t)}const xe=(e,t)=>({id:e,type:"select",selected:t});function He(e,t){return e.reduce((n,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,n.push(xe(o.id,!0))):o.selected&&!s&&(o.selected=!1,n.push(xe(o.id,!1))),n},[])}const mt=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},zs=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Vn=x.memo(({isSelecting:e,selectionMode:t=qe.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:r,onPaneScroll:c,onPaneMouseEnter:l,onPaneMouseMove:d,onPaneMouseLeave:a,children:u})=>{const h=x.useRef(null),f=ne(),m=x.useRef(0),g=x.useRef(0),y=x.useRef(),{userSelectionActive:S,elementsSelectable:b,dragging:N}=U(zs,re),C=()=>{f.setState({userSelectionActive:!1,userSelectionRect:null}),m.current=0,g.current=0},$=w=>{i==null||i(w),f.getState().resetSelectedElements(),f.setState({nodesSelectionActive:!1})},A=w=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){w.preventDefault();return}r==null||r(w)},v=c?w=>c(w):void 0,T=w=>{const{resetSelectedElements:D,domNode:_}=f.getState();if(y.current=_==null?void 0:_.getBoundingClientRect(),!b||!e||w.button!==0||w.target!==h.current||!y.current)return;const{x:j,y:L}=be(w,y.current);D(),f.setState({userSelectionRect:{width:0,height:0,startX:j,startY:L,x:j,y:L}}),o==null||o(w)},R=w=>{const{userSelectionRect:D,nodeInternals:_,edges:j,transform:L,onNodesChange:z,onEdgesChange:p,nodeOrigin:M,getNodes:I}=f.getState();if(!e||!y.current||!D)return;f.setState({userSelectionActive:!0,nodesSelectionActive:!1});const V=be(w,y.current),F=D.startX??0,Z=D.startY??0,X={...D,x:V.x<F?V.x:F,y:V.y<Z?V.y:Z,width:Math.abs(V.x-F),height:Math.abs(V.y-Z)},G=I(),ee=Nn(_,X,L,t===qe.Partial,!0,M),Q=Cn(ee,j).map(K=>K.id),te=ee.map(K=>K.id);if(m.current!==te.length){m.current=te.length;const K=He(G,te);K.length&&(z==null||z(K))}if(g.current!==Q.length){g.current=Q.length;const K=He(j,Q);K.length&&(p==null||p(K))}f.setState({userSelectionRect:X})},H=w=>{if(w.button!==0)return;const{userSelectionRect:D}=f.getState();!S&&D&&w.target===h.current&&($==null||$(w)),f.setState({nodesSelectionActive:m.current>0}),C(),s==null||s(w)},P=w=>{S&&(f.setState({nodesSelectionActive:m.current>0}),s==null||s(w)),C()},k=b&&(e||S);return E.jsxs("div",{className:le(["react-flow__pane",{dragging:N,selection:e}]),onClick:k?void 0:mt($,h),onContextMenu:mt(A,h),onWheel:mt(v,h),onMouseEnter:k?void 0:l,onMouseDown:k?T:void 0,onMouseMove:k?R:d,onMouseUp:k?H:void 0,onMouseLeave:k?P:a,ref:h,style:jt,children:[u,E.jsx(Is,{})]})});Vn.displayName="Pane";function Fn(e,t){if(!e.parentNode)return!1;const n=t.get(e.parentNode);return n?n.selected?!0:Fn(n,t):!1}function nn(e,t,n){let o=e;do{if(o!=null&&o.matches(t))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function Hs(e,t,n,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||!Fn(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var i,r;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((i=s.positionAbsolute)==null?void 0:i.x)??0),y:n.y-(((r=s.positionAbsolute)==null?void 0:r.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode,width:s.width,height:s.height}})}function Ls(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Yn(e,t,n,o,s=[0,0],i){const r=Ls(e,e.extent||o);let c=r;if(e.extent==="parent")if(e.parentNode&&e.width&&e.height){const a=n.get(e.parentNode),{x:u,y:h}=Oe(a,s).positionAbsolute;c=a&&ae(u)&&ae(h)&&ae(a.width)&&ae(a.height)?[[u+e.width*s[0],h+e.height*s[1]],[u+a.width-e.width+e.width*s[0],h+a.height-e.height+e.height*s[1]]]:c}else i==null||i("005",ge.error005()),c=r;else if(e.extent&&e.parentNode){const a=n.get(e.parentNode),{x:u,y:h}=Oe(a,s).positionAbsolute;c=[[e.extent[0][0]+u,e.extent[0][1]+h],[e.extent[1][0]+u,e.extent[1][1]+h]]}let l={x:0,y:0};if(e.parentNode){const a=n.get(e.parentNode);l=Oe(a,s).positionAbsolute}const d=c&&c!=="parent"?$t(t,c):t;return{position:{x:d.x-l.x,y:d.y-l.y},positionAbsolute:d}}function xt({nodeId:e,dragItems:t,nodeInternals:n}){const o=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const on=(e,t,n,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),r=t.getBoundingClientRect(),c={x:r.width*o[0],y:r.height*o[1]};return i.map(l=>{const d=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(d.left-r.left-c.x)/n,y:(d.top-r.top-c.y)/n,...Pt(l)}})};function Ue(e,t,n){return n===void 0?n:o=>{const s=t().nodeInternals.get(e);s&&n(o,{...s})}}function Mt({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:r,nodeInternals:c,onError:l}=t.getState(),d=c.get(e);if(!d){l==null||l("012",ge.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(n||d.selected&&r)&&(i({nodes:[d]}),requestAnimationFrame(()=>{var a;return(a=o==null?void 0:o.current)==null?void 0:a.blur()})):s([e])}function Os(){const e=ne();return x.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:s,snapToGrid:i}=e.getState(),r=n.touches?n.touches[0].clientX:n.clientX,c=n.touches?n.touches[0].clientY:n.clientY,l={x:(r-o[0])/o[2],y:(c-o[1])/o[2]};return{xSnapped:i?s[0]*Math.round(l.x/s[0]):l.x,ySnapped:i?s[1]*Math.round(l.y/s[1]):l.y,...l}},[])}function St(e){return(t,n,o)=>e==null?void 0:e(t,o)}function Zn({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:i,selectNodesOnDrag:r}){const c=ne(),[l,d]=x.useState(!1),a=x.useRef([]),u=x.useRef({x:null,y:null}),h=x.useRef(0),f=x.useRef(null),m=x.useRef({x:0,y:0}),g=x.useRef(null),y=x.useRef(!1),S=Os();return x.useEffect(()=>{if(e!=null&&e.current){const b=fn(e.current),N=({x:$,y:A})=>{const{nodeInternals:v,onNodeDrag:T,onSelectionDrag:R,updateNodePositions:H,nodeExtent:P,snapGrid:k,snapToGrid:w,nodeOrigin:D,onError:_}=c.getState();u.current={x:$,y:A};let j=!1,L={x:0,y:0,x2:0,y2:0};if(a.current.length>1&&P){const p=Tt(a.current,D);L=vt(p)}if(a.current=a.current.map(p=>{const M={x:$-p.distance.x,y:A-p.distance.y};w&&(M.x=k[0]*Math.round(M.x/k[0]),M.y=k[1]*Math.round(M.y/k[1]));const I=[[P[0][0],P[0][1]],[P[1][0],P[1][1]]];a.current.length>1&&P&&!p.extent&&(I[0][0]=p.positionAbsolute.x-L.x+P[0][0],I[1][0]=p.positionAbsolute.x+(p.width??0)-L.x2+P[1][0],I[0][1]=p.positionAbsolute.y-L.y+P[0][1],I[1][1]=p.positionAbsolute.y+(p.height??0)-L.y2+P[1][1]);const V=Yn(p,M,v,I,D,_);return j=j||p.position.x!==V.position.x||p.position.y!==V.position.y,p.position=V.position,p.positionAbsolute=V.positionAbsolute,p}),!j)return;H(a.current,!0,!0),d(!0);const z=s?T:St(R);if(z&&g.current){const[p,M]=xt({nodeId:s,dragItems:a.current,nodeInternals:v});z(g.current,p,M)}},C=()=>{if(!f.current)return;const[$,A]=hn(m.current,f.current);if($!==0||A!==0){const{transform:v,panBy:T}=c.getState();u.current.x=(u.current.x??0)-$/v[2],u.current.y=(u.current.y??0)-A/v[2],T({x:$,y:A})&&N(u.current)}h.current=requestAnimationFrame(C)};if(t)b.on(".drag",null);else{const $=jo().on("start",A=>{var j;const{nodeInternals:v,multiSelectionActive:T,domNode:R,nodesDraggable:H,unselectNodesAndEdges:P,onNodeDragStart:k,onSelectionDragStart:w}=c.getState(),D=s?k:St(w);!r&&!T&&s&&((j=v.get(s))!=null&&j.selected||P()),s&&i&&r&&Mt({id:s,store:c,nodeRef:e});const _=S(A);if(u.current=_,a.current=Hs(v,H,_,s),D&&a.current){const[L,z]=xt({nodeId:s,dragItems:a.current,nodeInternals:v});D(A.sourceEvent,L,z)}f.current=(R==null?void 0:R.getBoundingClientRect())||null,m.current=be(A.sourceEvent,f.current)}).on("drag",A=>{const v=S(A),{autoPanOnNodeDrag:T}=c.getState();!y.current&&T&&(y.current=!0,C()),(u.current.x!==v.xSnapped||u.current.y!==v.ySnapped)&&a.current&&(g.current=A.sourceEvent,m.current=be(A.sourceEvent,f.current),N(v))}).on("end",A=>{if(d(!1),y.current=!1,cancelAnimationFrame(h.current),a.current){const{updateNodePositions:v,nodeInternals:T,onNodeDragStop:R,onSelectionDragStop:H}=c.getState(),P=s?R:St(H);if(v(a.current,!1,!1),P){const[k,w]=xt({nodeId:s,dragItems:a.current,nodeInternals:T});P(A.sourceEvent,k,w)}}}).filter(A=>{const v=A.target;return!A.button&&(!n||!nn(v,`.${n}`,e))&&(!o||nn(v,o,e))});return b.call($),()=>{b.on(".drag",null)}}}},[e,t,n,o,i,c,s,r,S]),l}function Xn(){const e=ne();return x.useCallback(n=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:i,getNodes:r,snapToGrid:c,snapGrid:l,onError:d,nodesDraggable:a}=e.getState(),u=r().filter(b=>b.selected&&(b.draggable||a&&typeof b.draggable>"u")),h=c?l[0]:5,f=c?l[1]:5,m=n.isShiftPressed?4:1,g=n.x*h*m,y=n.y*f*m,S=u.map(b=>{if(b.positionAbsolute){const N={x:b.positionAbsolute.x+g,y:b.positionAbsolute.y+y};c&&(N.x=l[0]*Math.round(N.x/l[0]),N.y=l[1]*Math.round(N.y/l[1]));const{positionAbsolute:C,position:$}=Yn(b,N,o,s,void 0,d);b.position=$,b.positionAbsolute=C}return b});i(S,!0,!1)},[])}const Ve={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Ge=e=>{const t=({id:n,type:o,data:s,xPos:i,yPos:r,xPosOrigin:c,yPosOrigin:l,selected:d,onClick:a,onMouseEnter:u,onMouseMove:h,onMouseLeave:f,onContextMenu:m,onDoubleClick:g,style:y,className:S,isDraggable:b,isSelectable:N,isConnectable:C,isFocusable:$,selectNodesOnDrag:A,sourcePosition:v,targetPosition:T,hidden:R,resizeObserver:H,dragHandle:P,zIndex:k,isParent:w,noDragClassName:D,noPanClassName:_,initialized:j,disableKeyboardA11y:L,ariaLabel:z,rfId:p})=>{const M=ne(),I=x.useRef(null),V=x.useRef(v),F=x.useRef(T),Z=x.useRef(o),X=N||b||a||u||h||f,G=Xn(),ee=Ue(n,M.getState,u),Q=Ue(n,M.getState,h),te=Ue(n,M.getState,f),K=Ue(n,M.getState,m),ie=Ue(n,M.getState,g),de=W=>{if(N&&(!A||!b)&&Mt({id:n,store:M,nodeRef:I}),a){const se=M.getState().nodeInternals.get(n);se&&a(W,{...se})}},fe=W=>{if(!wt(W))if(yn.includes(W.key)&&N){const se=W.key==="Escape";Mt({id:n,store:M,unselect:se,nodeRef:I})}else!L&&b&&d&&Object.prototype.hasOwnProperty.call(Ve,W.key)&&(M.setState({ariaLiveMessage:`Moved selected node ${W.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~r}`}),G({x:Ve[W.key].x,y:Ve[W.key].y,isShiftPressed:W.shiftKey}))};x.useEffect(()=>{if(I.current&&!R){const W=I.current;return H==null||H.observe(W),()=>H==null?void 0:H.unobserve(W)}},[R]),x.useEffect(()=>{const W=Z.current!==o,se=V.current!==v,O=F.current!==T;I.current&&(W||se||O)&&(W&&(Z.current=o),se&&(V.current=v),O&&(F.current=T),M.getState().updateNodeDimensions([{id:n,nodeElement:I.current,forceUpdate:!0}]))},[n,o,v,T]);const q=Zn({nodeRef:I,disabled:R||!b,noDragClassName:D,handleSelector:P,nodeId:n,isSelectable:N,selectNodesOnDrag:A});return R?null:E.jsx("div",{className:le(["react-flow__node",`react-flow__node-${o}`,{[_]:b},S,{selected:d,selectable:N,parent:w,dragging:q}]),ref:I,style:{zIndex:k,transform:`translate(${c}px,${l}px)`,pointerEvents:X?"all":"none",visibility:j?"visible":"hidden",...y},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:ee,onMouseMove:Q,onMouseLeave:te,onContextMenu:K,onClick:de,onDoubleClick:ie,onKeyDown:$?fe:void 0,tabIndex:$?0:void 0,role:$?"button":void 0,"aria-describedby":L?void 0:`${Bn}-${p}`,"aria-label":z,children:E.jsx(Jo,{value:n,children:E.jsx(e,{id:n,data:s,type:o,xPos:i,yPos:r,selected:d,isConnectable:C,sourcePosition:v,targetPosition:T,dragging:q,dragHandle:P,zIndex:k})})})};return t.displayName="NodeWrapper",x.memo(t)};const Vs=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Tt(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Fs({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ne(),{width:s,height:i,x:r,y:c,transformString:l,userSelectionActive:d}=U(Vs,re),a=Xn(),u=x.useRef(null);if(x.useEffect(()=>{var m;n||(m=u.current)==null||m.focus({preventScroll:!0})},[n]),Zn({nodeRef:u}),d||!s||!i)return null;const h=e?m=>{const g=o.getState().getNodes().filter(y=>y.selected);e(m,g)}:void 0,f=m=>{Object.prototype.hasOwnProperty.call(Ve,m.key)&&a({x:Ve[m.key].x,y:Ve[m.key].y,isShiftPressed:m.shiftKey})};return E.jsx("div",{className:le(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l},children:E.jsx("div",{ref:u,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:f,style:{width:s,height:i,top:c,left:r}})})}var Ys=x.memo(Fs);const Zs=e=>e.nodesSelectionActive,Wn=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,deleteKeyCode:c,onMove:l,onMoveStart:d,onMoveEnd:a,selectionKeyCode:u,selectionOnDrag:h,selectionMode:f,onSelectionStart:m,onSelectionEnd:g,multiSelectionKeyCode:y,panActivationKeyCode:S,zoomActivationKeyCode:b,elementsSelectable:N,zoomOnScroll:C,zoomOnPinch:$,panOnScroll:A,panOnScrollSpeed:v,panOnScrollMode:T,zoomOnDoubleClick:R,panOnDrag:H,defaultViewport:P,translateExtent:k,minZoom:w,maxZoom:D,preventScrolling:_,onSelectionContextMenu:j,noWheelClassName:L,noPanClassName:z,disableKeyboardA11y:p})=>{const M=U(Zs),I=Qe(u),F=Qe(S)||H,Z=I||h&&F!==!0;return vs({deleteKeyCode:c,multiSelectionKeyCode:y}),E.jsx(_s,{onMove:l,onMoveStart:d,onMoveEnd:a,onPaneContextMenu:i,elementsSelectable:N,zoomOnScroll:C,zoomOnPinch:$,panOnScroll:A,panOnScrollSpeed:v,panOnScrollMode:T,zoomOnDoubleClick:R,panOnDrag:!I&&F,defaultViewport:P,translateExtent:k,minZoom:w,maxZoom:D,zoomActivationKeyCode:b,preventScrolling:_,noWheelClassName:L,noPanClassName:z,children:E.jsxs(Vn,{onSelectionStart:m,onSelectionEnd:g,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:r,panOnDrag:F,isSelecting:!!Z,selectionMode:f,children:[e,M&&E.jsx(Ys,{onSelectionContextMenu:j,noPanClassName:z,disableKeyboardA11y:p})]})})};Wn.displayName="FlowRenderer";var Xs=x.memo(Wn);function Ws(e){return U(x.useCallback(n=>e?Nn(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Ks(e){const t={input:Ge(e.input||Rn),default:Ge(e.default||Ct),output:Ge(e.output||Tn),group:Ge(e.group||Bt)},n={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=Ge(e[i]||Ct),s),n);return{...t,...o}}const Us=({x:e,y:t,width:n,height:o,origin:s})=>!n||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-o*s[1]},Gs=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),Kn=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:i,onError:r}=U(Gs,re),c=Ws(e.onlyRenderVisibleElements),l=x.useRef(),d=x.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const a=new ResizeObserver(u=>{const h=u.map(f=>({id:f.target.getAttribute("data-id"),nodeElement:f.target,forceUpdate:!0}));i(h)});return l.current=a,a},[]);return x.useEffect(()=>()=>{var a;(a=l==null?void 0:l.current)==null||a.disconnect()},[]),E.jsx("div",{className:"react-flow__nodes",style:jt,children:c.map(a=>{var $,A;let u=a.type||"default";e.nodeTypes[u]||(r==null||r("003",ge.error003(u)),u="default");const h=e.nodeTypes[u]||e.nodeTypes.default,f=!!(a.draggable||t&&typeof a.draggable>"u"),m=!!(a.selectable||s&&typeof a.selectable>"u"),g=!!(a.connectable||n&&typeof a.connectable>"u"),y=!!(a.focusable||o&&typeof a.focusable>"u"),S=e.nodeExtent?$t(a.positionAbsolute,e.nodeExtent):a.positionAbsolute,b=(S==null?void 0:S.x)??0,N=(S==null?void 0:S.y)??0,C=Us({x:b,y:N,width:a.width??0,height:a.height??0,origin:e.nodeOrigin});return E.jsx(h,{id:a.id,className:a.className,style:a.style,type:u,data:a.data,sourcePosition:a.sourcePosition||B.Bottom,targetPosition:a.targetPosition||B.Top,hidden:a.hidden,xPos:b,yPos:N,xPosOrigin:C.x,yPosOrigin:C.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!a.selected,isDraggable:f,isSelectable:m,isConnectable:g,isFocusable:y,resizeObserver:d,dragHandle:a.dragHandle,zIndex:(($=a[J])==null?void 0:$.z)??0,isParent:!!((A=a[J])!=null&&A.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!a.width&&!!a.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:a.ariaLabel},a.id)})})};Kn.displayName="NodeRenderer";var qs=x.memo(Kn);const Qs=(e,t,n)=>n===B.Left?e-t:n===B.Right?e+t:e,Js=(e,t,n)=>n===B.Top?e-t:n===B.Bottom?e+t:e,sn="react-flow__edgeupdater",rn=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:i,onMouseOut:r,type:c})=>E.jsx("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:r,className:le([sn,`${sn}-${c}`]),cx:Qs(t,o,e),cy:Js(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),er=()=>!0;var ze=e=>{const t=({id:n,className:o,type:s,data:i,onClick:r,onEdgeDoubleClick:c,selected:l,animated:d,label:a,labelStyle:u,labelShowBg:h,labelBgStyle:f,labelBgPadding:m,labelBgBorderRadius:g,style:y,source:S,target:b,sourceX:N,sourceY:C,targetX:$,targetY:A,sourcePosition:v,targetPosition:T,elementsSelectable:R,hidden:H,sourceHandleId:P,targetHandleId:k,onContextMenu:w,onMouseEnter:D,onMouseMove:_,onMouseLeave:j,edgeUpdaterRadius:L,onEdgeUpdate:z,onEdgeUpdateStart:p,onEdgeUpdateEnd:M,markerEnd:I,markerStart:V,rfId:F,ariaLabel:Z,isFocusable:X,isUpdatable:G,pathOptions:ee,interactionWidth:Q})=>{const te=x.useRef(null),[K,ie]=x.useState(!1),[de,fe]=x.useState(!1),q=ne(),W=x.useMemo(()=>`url(#${Nt(V,F)})`,[V,F]),se=x.useMemo(()=>`url(#${Nt(I,F)})`,[I,F]);if(H)return null;const O=oe=>{const{edges:ce,addSelectedEdges:Ce}=q.getState();if(R&&(q.setState({nodesSelectionActive:!1}),Ce([n])),r){const Me=ce.find(Ae=>Ae.id===n);r(oe,Me)}},he=Ke(n,q.getState,c),we=Ke(n,q.getState,w),Ye=Ke(n,q.getState,D),Ze=Ke(n,q.getState,_),Re=Ke(n,q.getState,j),Ee=(oe,ce)=>{if(oe.button!==0)return;const{edges:Ce,isValidConnection:Me}=q.getState(),Ae=ce?b:S,et=(ce?k:P)||null,Pe=ce?"target":"source",ut=Me||er,ft=ce,We=Ce.find($e=>$e.id===n);fe(!0),p==null||p(oe,We,Pe);const gt=$e=>{fe(!1),M==null||M($e,We,Pe)};$n({event:oe,handleId:et,nodeId:Ae,onConnect:$e=>z==null?void 0:z(We,$e),isTarget:ft,getState:q.getState,setState:q.setState,isValidConnection:ut,edgeUpdaterType:Pe,onEdgeUpdateEnd:gt})},pe=oe=>Ee(oe,!0),_e=oe=>Ee(oe,!1),ye=()=>ie(!0),Ne=()=>ie(!1),Xe=!R&&!r,Te=oe=>{var ce;if(yn.includes(oe.key)&&R){const{unselectNodesAndEdges:Ce,addSelectedEdges:Me,edges:Ae}=q.getState();oe.key==="Escape"?((ce=te.current)==null||ce.blur(),Ce({edges:[Ae.find(Pe=>Pe.id===n)]})):Me([n])}};return E.jsxs("g",{className:le(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:l,animated:d,inactive:Xe,updating:K}]),onClick:O,onDoubleClick:he,onContextMenu:we,onMouseEnter:Ye,onMouseMove:Ze,onMouseLeave:Re,onKeyDown:X?Te:void 0,tabIndex:X?0:void 0,role:X?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":Z===null?void 0:Z||`Edge from ${S} to ${b}`,"aria-describedby":X?`${jn}-${F}`:void 0,ref:te,children:[!de&&E.jsx(e,{id:n,source:S,target:b,selected:l,animated:d,label:a,labelStyle:u,labelShowBg:h,labelBgStyle:f,labelBgPadding:m,labelBgBorderRadius:g,data:i,style:y,sourceX:N,sourceY:C,targetX:$,targetY:A,sourcePosition:v,targetPosition:T,sourceHandleId:P,targetHandleId:k,markerStart:W,markerEnd:se,pathOptions:ee,interactionWidth:Q}),G&&E.jsxs(E.Fragment,{children:[(G==="source"||G===!0)&&E.jsx(rn,{position:v,centerX:N,centerY:C,radius:L,onMouseDown:pe,onMouseEnter:ye,onMouseOut:Ne,type:"source"}),(G==="target"||G===!0)&&E.jsx(rn,{position:T,centerX:$,centerY:A,radius:L,onMouseDown:_e,onMouseEnter:ye,onMouseOut:Ne,type:"target"})]})]})};return t.displayName="EdgeWrapper",x.memo(t)};function tr(e){const t={default:ze(e.default||ct),straight:ze(e.bezier||Rt),step:ze(e.step||Dt),smoothstep:ze(e.step||dt),simplebezier:ze(e.simplebezier||kt)},n={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=ze(e[i]||ct),s),n);return{...t,...o}}function cn(e,t,n=null){const o=((n==null?void 0:n.x)||0)+t.x,s=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,r=(n==null?void 0:n.height)||t.height;switch(e){case B.Top:return{x:o+i/2,y:s};case B.Right:return{x:o+i,y:s+r/2};case B.Bottom:return{x:o+i/2,y:s+r};case B.Left:return{x:o,y:s+r/2}}}function an(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const nr=(e,t,n,o,s,i)=>{const r=cn(n,e,t),c=cn(i,o,s);return{sourceX:r.x,sourceY:r.y,targetX:c.x,targetY:c.y}};function or({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:s,targetHeight:i,width:r,height:c,transform:l}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+o,t.y+i)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const a=vt({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:r/l[2],height:c/l[2]}),u=Math.max(0,Math.min(a.x2,d.x2)-Math.max(a.x,d.x)),h=Math.max(0,Math.min(a.y2,d.y2)-Math.max(a.y,d.y));return Math.ceil(u*h)>0}function ln(e){var o,s,i,r,c;const t=((o=e==null?void 0:e[J])==null?void 0:o.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((r=e==null?void 0:e.positionAbsolute)==null?void 0:r.x)||0,y:((c=e==null?void 0:e.positionAbsolute)==null?void 0:c.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const sr=[{level:0,isMaxLevel:!0,edges:[]}];function rr(e,t,n=!1){let o=-1;const s=e.reduce((r,c)=>{var a,u;const l=ae(c.zIndex);let d=l?c.zIndex:0;if(n){const h=t.get(c.target),f=t.get(c.source),m=c.selected||(h==null?void 0:h.selected)||(f==null?void 0:f.selected),g=Math.max(((a=f==null?void 0:f[J])==null?void 0:a.z)||0,((u=h==null?void 0:h[J])==null?void 0:u.z)||0,1e3);d=(l?c.zIndex:0)+(m?g:0)}return r[d]?r[d].push(c):r[d]=[c],o=d>o?d:o,r},{}),i=Object.entries(s).map(([r,c])=>{const l=+r;return{edges:c,level:l,isMaxLevel:l===o}});return i.length===0?sr:i}function ir(e,t,n){const o=U(x.useCallback(s=>e?s.edges.filter(i=>{const r=t.get(i.source),c=t.get(i.target);return(r==null?void 0:r.width)&&(r==null?void 0:r.height)&&(c==null?void 0:c.width)&&(c==null?void 0:c.height)&&or({sourcePos:r.positionAbsolute||{x:0,y:0},targetPos:c.positionAbsolute||{x:0,y:0},sourceWidth:r.width,sourceHeight:r.height,targetWidth:c.width,targetHeight:c.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return rr(o,t,n)}const cr=({color:e="none",strokeWidth:t=1})=>E.jsx("polyline",{stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,fill:"none",points:"-5,-4 0,0 -5,4"}),ar=({color:e="none",strokeWidth:t=1})=>E.jsx("polyline",{stroke:e,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:t,fill:e,points:"-5,-4 0,0 -5,4 -5,-4"}),dn={[it.Arrow]:cr,[it.ArrowClosed]:ar};function lr(e){const t=ne();return x.useMemo(()=>{var s,i;return Object.prototype.hasOwnProperty.call(dn,e)?dn[e]:((i=(s=t.getState()).onError)==null||i.call(s,"009",ge.error009(e)),null)},[e])}const dr=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:r,orient:c="auto-start-reverse"})=>{const l=lr(t);return l?E.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:c,refX:"0",refY:"0",children:E.jsx(l,{color:n,strokeWidth:r})}):null},ur=({defaultColor:e,rfId:t})=>n=>{const o=[];return n.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(r=>{if(r&&typeof r=="object"){const c=Nt(r,t);o.includes(c)||(s.push({id:c,color:r.color||e,...r}),o.push(c))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},Un=({defaultColor:e,rfId:t})=>{const n=U(x.useCallback(ur({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((i,r)=>i.id!==s[r].id)));return E.jsx("defs",{children:n.map(o=>E.jsx(dr,{id:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient},o.id))})};Un.displayName="MarkerDefinitions";var fr=x.memo(Un);const gr=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Gn=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:s,noPanClassName:i,onEdgeUpdate:r,onEdgeContextMenu:c,onEdgeMouseEnter:l,onEdgeMouseMove:d,onEdgeMouseLeave:a,onEdgeClick:u,edgeUpdaterRadius:h,onEdgeDoubleClick:f,onEdgeUpdateStart:m,onEdgeUpdateEnd:g,children:y})=>{const{edgesFocusable:S,edgesUpdatable:b,elementsSelectable:N,width:C,height:$,connectionMode:A,nodeInternals:v,onError:T}=U(gr,re),R=ir(t,v,n);return C?E.jsxs(E.Fragment,{children:[R.map(({level:H,edges:P,isMaxLevel:k})=>E.jsxs("svg",{style:{zIndex:H},width:C,height:$,className:"react-flow__edges react-flow__container",children:[k&&E.jsx(fr,{defaultColor:e,rfId:o}),E.jsx("g",{children:P.map(w=>{const[D,_,j]=ln(v.get(w.source)),[L,z,p]=ln(v.get(w.target));if(!j||!p)return null;let M=w.type||"default";s[M]||(T==null||T("011",ge.error011(M)),M="default");const I=s[M]||s.default,V=A===De.Strict?z.target:(z.target??[]).concat(z.source??[]),F=an(_.source,w.sourceHandle),Z=an(V,w.targetHandle),X=(F==null?void 0:F.position)||B.Bottom,G=(Z==null?void 0:Z.position)||B.Top,ee=!!(w.focusable||S&&typeof w.focusable>"u"),Q=typeof r<"u"&&(w.updatable||b&&typeof w.updatable>"u");if(!F||!Z)return T==null||T("008",ge.error008(F,w)),null;const{sourceX:te,sourceY:K,targetX:ie,targetY:de}=nr(D,F,X,L,Z,G);return E.jsx(I,{id:w.id,className:le([w.className,i]),type:M,data:w.data,selected:!!w.selected,animated:!!w.animated,hidden:!!w.hidden,label:w.label,labelStyle:w.labelStyle,labelShowBg:w.labelShowBg,labelBgStyle:w.labelBgStyle,labelBgPadding:w.labelBgPadding,labelBgBorderRadius:w.labelBgBorderRadius,style:w.style,source:w.source,target:w.target,sourceHandleId:w.sourceHandle,targetHandleId:w.targetHandle,markerEnd:w.markerEnd,markerStart:w.markerStart,sourceX:te,sourceY:K,targetX:ie,targetY:de,sourcePosition:X,targetPosition:G,elementsSelectable:N,onEdgeUpdate:r,onContextMenu:c,onMouseEnter:l,onMouseMove:d,onMouseLeave:a,onClick:u,edgeUpdaterRadius:h,onEdgeDoubleClick:f,onEdgeUpdateStart:m,onEdgeUpdateEnd:g,rfId:o,ariaLabel:w.ariaLabel,isFocusable:ee,isUpdatable:Q,pathOptions:"pathOptions"in w?w.pathOptions:void 0,interactionWidth:w.interactionWidth},w.id)})})]},H)),y]}):null};Gn.displayName="EdgeRenderer";var hr=x.memo(Gn);const pr=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function yr({children:e}){const t=U(pr);return E.jsx("div",{className:"react-flow__viewport react-flow__container",style:{transform:t},children:e})}function mr(e){const t=On(),n=x.useRef(!1);x.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const xr={[B.Left]:B.Right,[B.Right]:B.Left,[B.Top]:B.Bottom,[B.Bottom]:B.Top},qn=({nodeId:e,handleType:t,style:n,type:o=Se.Bezier,CustomComponent:s,connectionStatus:i})=>{var A,v,T;const{fromNode:r,handleId:c,toX:l,toY:d,connectionMode:a}=U(x.useCallback(R=>({fromNode:R.nodeInternals.get(e),handleId:R.connectionHandleId,toX:(R.connectionPosition.x-R.transform[0])/R.transform[2],toY:(R.connectionPosition.y-R.transform[1])/R.transform[2],connectionMode:R.connectionMode}),[e]),re),u=(A=r==null?void 0:r[J])==null?void 0:A.handleBounds;let h=u==null?void 0:u[t];if(a===De.Loose&&(h=h||(u==null?void 0:u[t==="source"?"target":"source"])),!r||!h)return null;const f=c?h.find(R=>R.id===c):h[0],m=f?f.x+f.width/2:(r.width??0)/2,g=f?f.y+f.height/2:r.height??0,y=(((v=r.positionAbsolute)==null?void 0:v.x)??0)+m,S=(((T=r.positionAbsolute)==null?void 0:T.y)??0)+g,b=f==null?void 0:f.position,N=b?xr[b]:null;if(!b||!N)return null;if(s)return E.jsx(s,{connectionLineType:o,connectionLineStyle:n,fromNode:r,fromHandle:f,fromX:y,fromY:S,toX:l,toY:d,fromPosition:b,toPosition:N,connectionStatus:i});let C="";const $={sourceX:y,sourceY:S,sourcePosition:b,targetX:l,targetY:d,targetPosition:N};return o===Se.Bezier?[C]=wn($):o===Se.Step?[C]=Et({...$,borderRadius:0}):o===Se.SmoothStep?[C]=Et($):o===Se.SimpleBezier?[C]=bn($):C=`M${y},${S} ${l},${d}`,E.jsx("path",{d:C,fill:"none",className:"react-flow__connection-path",style:n})};qn.displayName="ConnectionLine";const Sr=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function br({containerStyle:e,style:t,type:n,component:o}){const{nodeId:s,handleType:i,nodesConnectable:r,width:c,height:l,connectionStatus:d}=U(Sr,re);return!(s&&i&&c&&r)?null:E.jsx("svg",{style:e,width:c,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container",children:E.jsx("g",{className:le(["react-flow__connection",d]),children:E.jsx(qn,{nodeId:s,handleType:i,style:t,type:n,CustomComponent:o,connectionStatus:d})})})}function un(e,t){return x.useRef(null),ne(),x.useMemo(()=>t(e),[e])}const Qn=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:o,onMoveEnd:s,onInit:i,onNodeClick:r,onEdgeClick:c,onNodeDoubleClick:l,onEdgeDoubleClick:d,onNodeMouseEnter:a,onNodeMouseMove:u,onNodeMouseLeave:h,onNodeContextMenu:f,onSelectionContextMenu:m,onSelectionStart:g,onSelectionEnd:y,connectionLineType:S,connectionLineStyle:b,connectionLineComponent:N,connectionLineContainerStyle:C,selectionKeyCode:$,selectionOnDrag:A,selectionMode:v,multiSelectionKeyCode:T,panActivationKeyCode:R,zoomActivationKeyCode:H,deleteKeyCode:P,onlyRenderVisibleElements:k,elementsSelectable:w,selectNodesOnDrag:D,defaultViewport:_,translateExtent:j,minZoom:L,maxZoom:z,preventScrolling:p,defaultMarkerColor:M,zoomOnScroll:I,zoomOnPinch:V,panOnScroll:F,panOnScrollSpeed:Z,panOnScrollMode:X,zoomOnDoubleClick:G,panOnDrag:ee,onPaneClick:Q,onPaneMouseEnter:te,onPaneMouseMove:K,onPaneMouseLeave:ie,onPaneScroll:de,onPaneContextMenu:fe,onEdgeUpdate:q,onEdgeContextMenu:W,onEdgeMouseEnter:se,onEdgeMouseMove:O,onEdgeMouseLeave:he,edgeUpdaterRadius:we,onEdgeUpdateStart:Ye,onEdgeUpdateEnd:Ze,noDragClassName:Re,noWheelClassName:Ee,noPanClassName:pe,elevateEdgesOnSelect:_e,disableKeyboardA11y:ye,nodeOrigin:Ne,nodeExtent:Xe,rfId:Te})=>{const oe=un(e,Ks),ce=un(t,tr);return mr(i),E.jsx(Xs,{onPaneClick:Q,onPaneMouseEnter:te,onPaneMouseMove:K,onPaneMouseLeave:ie,onPaneContextMenu:fe,onPaneScroll:de,deleteKeyCode:P,selectionKeyCode:$,selectionOnDrag:A,selectionMode:v,onSelectionStart:g,onSelectionEnd:y,multiSelectionKeyCode:T,panActivationKeyCode:R,zoomActivationKeyCode:H,elementsSelectable:w,onMove:n,onMoveStart:o,onMoveEnd:s,zoomOnScroll:I,zoomOnPinch:V,zoomOnDoubleClick:G,panOnScroll:F,panOnScrollSpeed:Z,panOnScrollMode:X,panOnDrag:ee,defaultViewport:_,translateExtent:j,minZoom:L,maxZoom:z,onSelectionContextMenu:m,preventScrolling:p,noDragClassName:Re,noWheelClassName:Ee,noPanClassName:pe,disableKeyboardA11y:ye,children:E.jsxs(yr,{children:[E.jsx(hr,{edgeTypes:ce,onEdgeClick:c,onEdgeDoubleClick:d,onEdgeUpdate:q,onlyRenderVisibleElements:k,onEdgeContextMenu:W,onEdgeMouseEnter:se,onEdgeMouseMove:O,onEdgeMouseLeave:he,onEdgeUpdateStart:Ye,onEdgeUpdateEnd:Ze,edgeUpdaterRadius:we,defaultMarkerColor:M,noPanClassName:pe,elevateEdgesOnSelect:!!_e,disableKeyboardA11y:ye,rfId:Te,children:E.jsx(br,{style:b,type:S,component:N,containerStyle:C})}),E.jsx("div",{className:"react-flow__edgelabel-renderer"}),E.jsx(qs,{nodeTypes:oe,onNodeClick:r,onNodeDoubleClick:l,onNodeMouseEnter:a,onNodeMouseMove:u,onNodeMouseLeave:h,onNodeContextMenu:f,selectNodesOnDrag:D,onlyRenderVisibleElements:k,noPanClassName:pe,noDragClassName:Re,disableKeyboardA11y:ye,nodeOrigin:Ne,nodeExtent:Xe,rfId:Te})]})})};Qn.displayName="GraphView";var wr=x.memo(Qn);const At=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],me={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:At,nodeExtent:At,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:De.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Wo,isValidConnection:void 0},Er=()=>To((e,t)=>({...me,setNodes:n=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:yt(n,o,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=t();e({edges:n.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(n,o)=>{const s=typeof n<"u",i=typeof o<"u",r=s?yt(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:r,edges:i?o:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:r,fitViewOnInitOptions:c,domNode:l,nodeOrigin:d}=t(),a=l==null?void 0:l.querySelector(".react-flow__viewport");if(!a)return;const u=window.getComputedStyle(a),{m22:h}=new window.DOMMatrixReadOnly(u.transform),f=n.reduce((g,y)=>{const S=s.get(y.id);if(S){const b=Pt(y.nodeElement);!!(b.width&&b.height&&(S.width!==b.width||S.height!==b.height||y.forceUpdate))&&(s.set(S.id,{...S,[J]:{...S[J],handleBounds:{source:on(".source",y.nodeElement,h,d),target:on(".target",y.nodeElement,h,d)}},...b}),g.push({id:S.id,type:"dimensions",dimensions:b}))}return g},[]);Hn(s,d);const m=r||i&&!r&&Ln(t,{initial:!0,...c});e({nodeInternals:new Map(s),fitViewOnInitDone:m}),(f==null?void 0:f.length)>0&&(o==null||o(f))},updateNodePositions:(n,o=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),r=n.map(c=>{const l={id:c.id,type:"position",dragging:s};return o&&(l.positionAbsolute=c.positionAbsolute,l.position=c.position),l});i(r)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:r,getNodes:c,elevateNodesOnSelect:l}=t();if(n!=null&&n.length){if(i){const d=js(n,c()),a=yt(d,s,r,l);e({nodeInternals:a})}o==null||o(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>xe(l,!0)):(r=He(i(),n),c=He(s,[])),ot({changedNodes:r,changedEdges:c,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:s,getNodes:i}=t();let r,c=null;o?r=n.map(l=>xe(l,!0)):(r=He(s,n),c=He(i(),[])),ot({changedNodes:c,changedEdges:r,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:s,getNodes:i}=t(),r=n||i(),c=o||s,l=r.map(a=>(a.selected=!1,xe(a.id,!1))),d=c.map(a=>xe(a.id,!1));ot({changedNodes:l,changedEdges:d,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:s}=t();o==null||o.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:s}=t();o==null||o.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{var o;(o=t().d3Zoom)==null||o.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=t(),i=o().filter(c=>c.selected).map(c=>xe(c.id,!1)),r=n.filter(c=>c.selected).map(c=>xe(c.id,!1));ot({changedNodes:i,changedEdges:r,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=$t(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:s,height:i,d3Zoom:r,d3Selection:c,translateExtent:l}=t();if(!r||!c||!n.x&&!n.y)return!1;const d=Le.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),a=[[0,0],[s,i]],u=r==null?void 0:r.constrain()(d,a,l);return r.transform(c,u),o[0]!==u.x||o[1]!==u.y||o[2]!==u.k},cancelConnection:()=>e({connectionNodeId:me.connectionNodeId,connectionHandleId:me.connectionHandleId,connectionHandleType:me.connectionHandleType,connectionStatus:me.connectionStatus,connectionStartHandle:me.connectionStartHandle,connectionEndHandle:me.connectionEndHandle}),reset:()=>e({...me})}),Object.is),Jn=({children:e})=>{const t=x.useRef(null);return t.current||(t.current=Er()),E.jsx(zo,{value:t.current,children:e})};Jn.displayName="ReactFlowProvider";const eo=({children:e})=>x.useContext(lt)?E.jsx(E.Fragment,{children:e}):E.jsx(Jn,{children:e});eo.displayName="ReactFlowWrapper";const Nr={input:Rn,default:Ct,output:Tn,group:Bt},Cr={default:ct,straight:Rt,step:Dt,smoothstep:dt,simplebezier:kt},Mr=[0,0],Ar=[15,15],Pr={x:0,y:0,zoom:1},$r={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},vr=x.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:i=Nr,edgeTypes:r=Cr,onNodeClick:c,onEdgeClick:l,onInit:d,onMove:a,onMoveStart:u,onMoveEnd:h,onConnect:f,onConnectStart:m,onConnectEnd:g,onClickConnectStart:y,onClickConnectEnd:S,onNodeMouseEnter:b,onNodeMouseMove:N,onNodeMouseLeave:C,onNodeContextMenu:$,onNodeDoubleClick:A,onNodeDragStart:v,onNodeDrag:T,onNodeDragStop:R,onNodesDelete:H,onEdgesDelete:P,onSelectionChange:k,onSelectionDragStart:w,onSelectionDrag:D,onSelectionDragStop:_,onSelectionContextMenu:j,onSelectionStart:L,onSelectionEnd:z,connectionMode:p=De.Strict,connectionLineType:M=Se.Bezier,connectionLineStyle:I,connectionLineComponent:V,connectionLineContainerStyle:F,deleteKeyCode:Z="Backspace",selectionKeyCode:X="Shift",selectionOnDrag:G=!1,selectionMode:ee=qe.Full,panActivationKeyCode:Q="Space",multiSelectionKeyCode:te=rt()?"Meta":"Control",zoomActivationKeyCode:K=rt()?"Meta":"Control",snapToGrid:ie=!1,snapGrid:de=Ar,onlyRenderVisibleElements:fe=!1,selectNodesOnDrag:q=!0,nodesDraggable:W,nodesConnectable:se,nodesFocusable:O,nodeOrigin:he=Mr,edgesFocusable:we,edgesUpdatable:Ye,elementsSelectable:Ze,defaultViewport:Re=Pr,minZoom:Ee=.5,maxZoom:pe=2,translateExtent:_e=At,preventScrolling:ye=!0,nodeExtent:Ne,defaultMarkerColor:Xe="#b1b1b7",zoomOnScroll:Te=!0,zoomOnPinch:oe=!0,panOnScroll:ce=!1,panOnScrollSpeed:Ce=.5,panOnScrollMode:Me=ke.Free,zoomOnDoubleClick:Ae=!0,panOnDrag:et=!0,onPaneClick:Pe,onPaneMouseEnter:ut,onPaneMouseMove:ft,onPaneMouseLeave:We,onPaneScroll:gt,onPaneContextMenu:zt,children:$e,onEdgeUpdate:no,onEdgeContextMenu:oo,onEdgeDoubleClick:so,onEdgeMouseEnter:ro,onEdgeMouseMove:io,onEdgeMouseLeave:co,onEdgeUpdateStart:ao,onEdgeUpdateEnd:lo,edgeUpdaterRadius:uo=10,onNodesChange:fo,onEdgesChange:go,noDragClassName:ho="nodrag",noWheelClassName:po="nowheel",noPanClassName:Ht="nopan",fitView:yo=!1,fitViewOptions:mo,connectOnClick:xo=!0,attributionPosition:So,proOptions:bo,defaultEdgeOptions:wo,elevateNodesOnSelect:Eo=!0,elevateEdgesOnSelect:No=!1,disableKeyboardA11y:Lt=!1,autoPanOnConnect:Co=!0,autoPanOnNodeDrag:Mo=!0,connectionRadius:Ao=20,isValidConnection:Po,onError:$o,style:vo,id:Ot,...ko},Do)=>{const ht=Ot||"1";return E.jsx("div",{...ko,style:{...vo,...$r},ref:Do,className:le(["react-flow",s]),"data-testid":"rf__wrapper",id:Ot,children:E.jsxs(eo,{children:[E.jsx(wr,{onInit:d,onMove:a,onMoveStart:u,onMoveEnd:h,onNodeClick:c,onEdgeClick:l,onNodeMouseEnter:b,onNodeMouseMove:N,onNodeMouseLeave:C,onNodeContextMenu:$,onNodeDoubleClick:A,nodeTypes:i,edgeTypes:r,connectionLineType:M,connectionLineStyle:I,connectionLineComponent:V,connectionLineContainerStyle:F,selectionKeyCode:X,selectionOnDrag:G,selectionMode:ee,deleteKeyCode:Z,multiSelectionKeyCode:te,panActivationKeyCode:Q,zoomActivationKeyCode:K,onlyRenderVisibleElements:fe,selectNodesOnDrag:q,defaultViewport:Re,translateExtent:_e,minZoom:Ee,maxZoom:pe,preventScrolling:ye,zoomOnScroll:Te,zoomOnPinch:oe,zoomOnDoubleClick:Ae,panOnScroll:ce,panOnScrollSpeed:Ce,panOnScrollMode:Me,panOnDrag:et,onPaneClick:Pe,onPaneMouseEnter:ut,onPaneMouseMove:ft,onPaneMouseLeave:We,onPaneScroll:gt,onPaneContextMenu:zt,onSelectionContextMenu:j,onSelectionStart:L,onSelectionEnd:z,onEdgeUpdate:no,onEdgeContextMenu:oo,onEdgeDoubleClick:so,onEdgeMouseEnter:ro,onEdgeMouseMove:io,onEdgeMouseLeave:co,onEdgeUpdateStart:ao,onEdgeUpdateEnd:lo,edgeUpdaterRadius:uo,defaultMarkerColor:Xe,noDragClassName:ho,noWheelClassName:po,noPanClassName:Ht,elevateEdgesOnSelect:No,rfId:ht,disableKeyboardA11y:Lt,nodeOrigin:he,nodeExtent:Ne}),E.jsx(ms,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:f,onConnectStart:m,onConnectEnd:g,onClickConnectStart:y,onClickConnectEnd:S,nodesDraggable:W,nodesConnectable:se,nodesFocusable:O,edgesFocusable:we,edgesUpdatable:Ye,elementsSelectable:Ze,elevateNodesOnSelect:Eo,minZoom:Ee,maxZoom:pe,nodeExtent:Ne,onNodesChange:fo,onEdgesChange:go,snapToGrid:ie,snapGrid:de,connectionMode:p,translateExtent:_e,connectOnClick:xo,defaultEdgeOptions:wo,fitView:yo,fitViewOptions:mo,onNodesDelete:H,onEdgesDelete:P,onNodeDragStart:v,onNodeDrag:T,onNodeDragStop:R,onSelectionDrag:D,onSelectionDragStart:w,onSelectionDragStop:_,noPanClassName:Ht,nodeOrigin:he,rfId:ht,autoPanOnConnect:Co,autoPanOnNodeDrag:Mo,onError:$o,connectionRadius:Ao,isValidConnection:Po}),E.jsx(ps,{onSelectionChange:k}),$e,E.jsx(Oo,{proOptions:bo,position:So}),E.jsx(Es,{rfId:ht,disableKeyboardA11y:Lt})]})})});vr.displayName="ReactFlow";const kr=e=>{var t;return(t=e.domNode)==null?void 0:t.querySelector(".react-flow__edgelabel-renderer")};function Yr({children:e}){const t=U(kr);return t?Io.createPortal(e,t):null}var ue;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ue||(ue={}));function Dr({color:e,dimensions:t,lineWidth:n}){return E.jsx("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Rr({color:e,radius:t}){return E.jsx("circle",{cx:t,cy:t,r:t,fill:e})}const _r={[ue.Dots]:"#91919a",[ue.Lines]:"#eee",[ue.Cross]:"#e2e2e2"},Tr={[ue.Dots]:1,[ue.Lines]:1,[ue.Cross]:6},Ir=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function to({id:e,variant:t=ue.Dots,gap:n=20,size:o,lineWidth:s=1,offset:i=2,color:r,style:c,className:l}){const d=x.useRef(null),{transform:a,patternId:u}=U(Ir,re),h=r||_r[t],f=o||Tr[t],m=t===ue.Dots,g=t===ue.Cross,y=Array.isArray(n)?n:[n,n],S=[y[0]*a[2]||1,y[1]*a[2]||1],b=f*a[2],N=g?[b,b]:S,C=m?[b/i,b/i]:[N[0]/i,N[1]/i];return E.jsxs("svg",{className:le(["react-flow__background",l]),style:{...c,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:d,"data-testid":"rf__background",children:[E.jsx("pattern",{id:u+e,x:a[0]%S[0],y:a[1]%S[1],width:S[0],height:S[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${C[0]},-${C[1]})`,children:m?E.jsx(Rr,{color:h,radius:b/i}):E.jsx(Dr,{dimensions:N,color:h,lineWidth:s})}),E.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${u+e})`})]})}to.displayName="Background";var Zr=x.memo(to);export{Je as B,Yr as E,at as H,B as P,vr as R,Zr as a,Et as g};
