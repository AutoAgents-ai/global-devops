import{H as T,aJ as P,ah as C,l,m as u,p as e,u as Q,V as s,P as x,F as S,a8 as N,J as F,aG as L,r as U,e as q,d as J,T as Y,U as R,S as B,aD as j,aE as W,a3 as G}from"./vue-82a6b7fc.js";import{u as M,a as z,b as H,d as O,C as ee}from"./index-8b95399e.js";import{_ as V}from"./index-a3bb6398.js";import{f as te}from"./element-9671e45a.js";import{l as ae}from"./agent-bc06a724.js";import"./agent-7bb36847.js";import"./index-6ffedc1d.js";import"./vxe-2d660f6a.js";const se="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANTSURBVHgBzVg9bNNQEP5eYOkPUiSK2gkZCQk22q7NkA6FbgWVhYkgYGJATF2AthudiIANqjQLLCDajR+JGqldqbtRCYRhAgmkDBQmKPfl2cFxnh07adJ+0sXOy8n35e7evTsrpES+sGPJZUpkmF9Fsp4QFRHXE1tkxV5SLlJAJVUUIgW5XPRIpIEjVop2SZWTKDclJETycimJWGgPrliba0ZMxRBhGOZErmN3URSZl1BWkJSQlyfPofOkE3BFxk35pSLIrKL9EDWDCwMpFSLDMG10gYwPxyNVC18mpDDXRTIEU2I2uFDzkLetS9gb0Es2bw4GFmdNmv29Wkz4+UtLEEMDyXUDoCOO8abqoTjvTJ8Gzk+Yn0LjznugvAKMjQCTuf/GTYSuziIaCgXWKN9DkbVmUwxuGwx8/Q58+CJERoGZy/r7ldvAoT7g+FEzoVjsoCCfZeVt809RevRQbqRx3Q9leVm8tAU8nNek6DUSNRG6dR+xyByARQ9NxSl9lIf39zSub25pAndnxNgT4Okr7Rka5R/o620k1Ax//+Ast30+TsmU0FxjmJgzC4vAtQvAy3XZwye1pwYH0CqG6SErTmPtnZYwnr3WxpnUVdI7+vrgsf6tReQzaLEQMlwkOni4PhxtkCGyJJTF/kE2g30GEqqgRURV8DZQaZkQ602wAA4d0fUnN4p24HKX2SKFKA1u5VMn6tfoGd8w75ncPDpYAliXeM+kD4KJnyDhXXrIidMwhYUPv/NIGyAx/0ryPK/CZFLApofkaKz2uZGEaCgMEmDYSI4F8saC9s70hJlQQpIr/mnPljVv0qDRcMh8A99+yFw0pQm9WNOnPuuSqWUh8fUNxMGRnmjEP+3LUYQmx4AzOfMT/Pbj5j3tMVZu33gYTQkpHaVgx8gT3wrr8Z/29Zifsf270Tg9FAV6NAKueKfaoAU7xkvQ00YdmnR6aYxGQ1V7+SpqldrraYvoPurG7PDRwSxw0D24ns0a6gh589E5T7EbZMbDI3XD4epNkuPoLCl/QHTDPxhPe0+RnXQncqoYRYZI8jqmAD2zWWgPrpJRZ7Wk3sYppX1hxXEp7RsRW6ws7doLKzQSs6AnlTy01yjBV3oV6A7CkbFm+c2i+owU+AdOuB7Rr1KudAAAAABJRU5ErkJggg==",ne={class:"aside-angent"},oe={class:"logo-box"},ie={class:"agent-box"},ce=["onClick"],de=["src"],re=T({__name:"Aside",props:{agentId:{}},setup(f){const{agentHistory:I}=M(),i=P(),m=g=>{i.push({name:"dialogue",query:{agentId:g}})};return(g,c)=>{const y=C("svg-icon"),h=C("el-scrollbar");return l(),u("div",ne,[e("div",oe,[e("img",{src:se,class:"logo",onClick:c[0]||(c[0]=(...d)=>Q(i).back&&Q(i).back(...d))})]),e("div",ie,[s(h,null,{default:x(()=>[(l(!0),u(S,null,N(Q(I),d=>(l(),u("div",{class:F(["item",{active:g.agentId==d.agentId}]),key:d.agentId,onClick:_=>m(d.agentId)},[e("img",{src:d.avatar,class:"agent-logo"},null,8,de),s(y,{name:"agent-active",class:"agent-active"})],10,ce))),128))]),_:1})])])}}});const le=V(re,[["__scopeId","data-v-c8aa641f"]]),Z=f=>(j("data-v-112e4135"),f=f(),W(),f),ue={class:"dialogue-history"},ge={class:"dialogue-header"},_e={class:"history-list"},pe={key:0,class:"create"},me=Z(()=>e("span",null,"新的对话",-1)),he=["onClick"],Ae={class:"more"},ve={class:"item-dropdown"},fe={class:"dropdown-menu"},Ie=["onClick"],ye=["onClick"],ke={class:"agent-footer"},Ce={class:"link"},De={class:"item"},we={class:"item"},Re={class:"item"},xe=Z(()=>e("p",null,"V 1.0",-1)),Ue=T({__name:"DialogueList",props:{agentInfo:{},agentId:{}},setup(f,{expose:I}){const i=f,m=P(),g=L(),c=U([]),y=q(()=>g.query.chatId||""),h=async()=>{const{data:t}=await z({agentUUid:i.agentId});c.value=_(t)},d=t=>{m.push({name:"dialogue",query:{agentId:i.agentId,chatId:t.id}})};function _(t){const D=new Date,A=new Date(D.getTime()-6*24*60*60*1e3),E=t.reduce((n,v)=>{const r=new Date(v.createAt),o=`${r.getFullYear()}-${r.getMonth()+1}`;return r>=A&&r<=D?(n.近7天||(n.近7天=[]),n.近7天.push(v)):(n[o]||(n[o]=[]),n[o].push(v)),n},{});return Object.entries(E).map(([n,v])=>{const r=n==="近7天",o=!r;let k="";if(r)k="近7天";else if(o){const[p,w]=n.split("-").map(Number),$=new Date().getFullYear();p!==$?k=`${p}年${w}月`:k=`${w}月`}return{title:k,items:v}})}const a=()=>{m.push({name:"dialogue",query:{agentId:i.agentId}})},K=t=>{te.prompt("","自定义历史会话标题",{}).then(async D=>{await H({chatId:t.id,customTitle:D.value,top:!1}),h()})},X=async t=>{await O({chatId:t.id}),m.push({name:"dialogue",query:{agentId:t.agentId}})};return J(()=>i.agentId,t=>{t&&h()},{immediate:!0}),I({getAgentChatHistory:h}),(t,D)=>{var v,r;const A=C("svg-icon"),E=C("el-text"),b=C("el-popover"),n=C("el-scrollbar");return l(),u("div",ue,[e("div",ge,[e("h3",null,[Y(R((v=t.agentInfo)==null?void 0:v.name)+" ",1),s(A,{name:"Edit",class:"edit-icon",onClick:a})]),e("p",null,[s(E,{"line-clamp":2},{default:x(()=>{var o;return[Y(R((o=t.agentInfo)==null?void 0:o.intro),1)]}),_:1})])]),e("div",_e,[y.value?B("",!0):(l(),u("div",pe,[s(A,{name:"new-dialogue",class:"create-icon"}),me])),s(n,null,{default:x(()=>[(l(!0),u(S,null,N(c.value,(o,k)=>(l(),u("div",{class:"list",key:k},[e("h4",null,R(o.title),1),(l(!0),u(S,null,N(o.items,p=>(l(),u("div",{class:F(["item",{active:y.value==p.id}]),key:p.id,onClick:w=>d(p)},[e("span",null,R(p.title),1),e("div",Ae,[s(b,{placement:"bottom-end","show-arrow":!1,teleported:!1,width:120,trigger:"hover",offset:0},{reference:x(()=>[e("div",ve,[s(A,{name:"more",class:"more-icon"})])]),default:x(()=>[e("div",fe,[e("div",{class:"dropdown-item",onClick:G(w=>K(p),["stop"])},"自定义标题",8,Ie),e("div",{class:"dropdown-item del",onClick:G(w=>X(p),["stop"])},"删除",8,ye)])]),_:2},1024)])],10,he))),128))]))),128))]),_:1})]),e("div",ke,[e("div",Ce,[e("div",De,[s(A,{name:"agent-footer-icon1"})]),e("div",we,[s(A,{name:"agent-footer-icon2"})]),e("div",Re,[s(A,{name:"agent-footer-icon3"})])]),e("p",null,R((r=t.agentInfo)==null?void 0:r.name),1),xe])])}}});const Ee=V(Ue,[["__scopeId","data-v-112e4135"]]),Qe={class:"dialogue-container"},Se={class:"aside-container"},Ne=T({__name:"index",setup(f){const I=L(),{setAgentHistory:i}=M(),m=U(),g=U(),c=U(),y=q(()=>I.query.chatId||""),h=async _=>{const{data:a}=await ae(_);a.uuid=a.agentUuid,c.value=a.agentUuid,g.value=a,i({avatar:a==null?void 0:a.avatar,name:a==null?void 0:a.name,agentId:a.agentUuid})},d=()=>{m.value.getAgentChatHistory()};return J(()=>[I.query.hash,I.query.agentId],_=>{_[0]?h({hash:_[0]}):h({agentUUid:_[1]})},{immediate:!0}),(_,a)=>(l(),u("div",Qe,[e("div",Se,[s(le,{agentId:c.value},null,8,["agentId"]),s(Ee,{ref_key:"dialogueListRef",ref:m,agentInfo:g.value,agentId:c.value},null,8,["agentInfo","agentId"])]),s(ee,{class:"chat-container",agentId:c.value,chatId:y.value,agentData:g.value,onRefreshHistory:d},null,8,["agentId","chatId","agentData"])]))}});const qe=V(Ne,[["__scopeId","data-v-f8d35ca3"]]);export{qe as default};
