import{e as he,b as k,g as Je,c as _,_ as Rt,a as pt,d as De,h as Mt}from"./@babel-8debb48f.js";import{r as t}from"./react-f8c4b268.js";import{r as Ae}from"./react-dom-daa06353.js";import{c as be}from"./classnames-25f5e917.js";import{R as Qe}from"./rc-resize-observer-db8399b3.js";import{j as X,H as bt,a as Me,f as je}from"./rc-util-35a1817f.js";import"./react-is-e8e5dbb3.js";var et=t.forwardRef(function(e,s){var r=e.height,l=e.offsetY,m=e.offsetX,n=e.children,u=e.prefixCls,h=e.onInnerResize,g=e.innerProps,S=e.rtl,v=e.extra,c={},f={display:"flex",flexDirection:"column"};if(l!==void 0){var d;c={height:r,position:"relative",overflow:"hidden"},f=he(he({},f),{},(d={transform:"translateY(".concat(l,"px)")},k(d,S?"marginRight":"marginLeft",-m),k(d,"position","absolute"),k(d,"left",0),k(d,"right",0),k(d,"top",0),d))}return t.createElement("div",{style:c},t.createElement(Qe,{onResize:function(i){var p=i.offsetHeight;p&&h&&h()}},t.createElement("div",Je({style:f,className:be(k({},"".concat(u,"-holder-inner"),u)),ref:s},g),n,v)))});et.displayName="Filler";function Ge(e,s){var r="touches"in e?e.touches[0]:e;return r[s?"pageX":"pageY"]}var Ue=t.forwardRef(function(e,s){var r,l=e.prefixCls,m=e.rtl,n=e.scrollOffset,u=e.scrollRange,h=e.onStartMove,g=e.onStopMove,S=e.onScroll,v=e.horizontal,c=e.spinSize,f=e.containerSize,d=t.useState(!1),M=_(d,2),i=M[0],p=M[1],y=t.useState(null),b=_(y,2),I=b[0],P=b[1],K=t.useState(null),Y=_(K,2),F=Y[0],L=Y[1],$=!m,z=t.useRef(),Z=t.useRef(),x=t.useState(!1),T=_(x,2),A=T[0],q=T[1],ae=t.useRef(),O=function(){clearTimeout(ae.current),q(!0),ae.current=setTimeout(function(){q(!1)},3e3)},U=u-f||0,ie=f-c||0,ge=U>0,W=t.useMemo(function(){if(n===0||U===0)return 0;var D=n/U;return D*ie},[n,U,ie]),J=function(E){E.stopPropagation(),E.preventDefault()},oe=t.useRef({top:W,dragging:i,pageY:I,startTop:F});oe.current={top:W,dragging:i,pageY:I,startTop:F};var Q=function(E){p(!0),P(Ge(E,v)),L(oe.current.top),h(),E.stopPropagation(),E.preventDefault()};t.useEffect(function(){var D=function(ue){ue.preventDefault()},E=z.current,V=Z.current;return E.addEventListener("touchstart",D),V.addEventListener("touchstart",Q),function(){E.removeEventListener("touchstart",D),V.removeEventListener("touchstart",Q)}},[]);var Se=t.useRef();Se.current=U;var le=t.useRef();le.current=ie,t.useEffect(function(){if(i){var D,E=function(ue){var ce=oe.current,xe=ce.dragging,Ee=ce.pageY,ee=ce.startTop;if(X.cancel(D),xe){var Re=Ge(ue,v)-Ee,te=ee;!$&&v?te-=Re:te+=Re;var re=Se.current,pe=le.current,ne=pe?te/pe:0,N=Math.ceil(ne*re);N=Math.max(N,0),N=Math.min(N,re),D=X(function(){S(N,v)})}},V=function(){p(!1),g()};return window.addEventListener("mousemove",E),window.addEventListener("touchmove",E),window.addEventListener("mouseup",V),window.addEventListener("touchend",V),function(){window.removeEventListener("mousemove",E),window.removeEventListener("touchmove",E),window.removeEventListener("mouseup",V),window.removeEventListener("touchend",V),X.cancel(D)}}},[i]),t.useEffect(function(){O()},[n]),t.useImperativeHandle(s,function(){return{delayHidden:O}});var B="".concat(l,"-scrollbar"),C={position:"absolute",visibility:A&&ge?null:"hidden"},H={position:"absolute",background:"rgba(0, 0, 0, 0.5)",borderRadius:99,cursor:"pointer",userSelect:"none"};return v?(C.height=8,C.left=0,C.right=0,C.bottom=0,H.height="100%",H.width=c,$?H.left=W:H.right=W):(C.width=8,C.top=0,C.bottom=0,$?C.right=0:C.left=0,H.width="100%",H.height=c,H.top=W),t.createElement("div",{ref:z,className:be(B,(r={},k(r,"".concat(B,"-horizontal"),v),k(r,"".concat(B,"-vertical"),!v),k(r,"".concat(B,"-visible"),A),r)),style:C,onMouseDown:J,onMouseMove:O},t.createElement("div",{ref:Z,className:be("".concat(B,"-thumb"),k({},"".concat(B,"-thumb-moving"),i)),style:H,onMouseDown:Q}))});function xt(e){var s=e.children,r=e.setRef,l=t.useCallback(function(m){r(m)},[]);return t.cloneElement(s,{ref:l})}function Et(e,s,r,l,m,n,u){var h=u.getKey;return e.slice(s,r+1).map(function(g,S){var v=s+S,c=n(g,v,{style:{width:l}}),f=h(g);return t.createElement(xt,{key:f,setRef:function(M){return m(g,M)}},c)})}var yt=function(){function e(){pt(this,e),this.maps=void 0,this.id=0,this.maps=Object.create(null)}return Rt(e,[{key:"set",value:function(r,l){this.maps[r]=l,this.id+=1}},{key:"get",value:function(r){return this.maps[r]}}]),e}();function wt(e,s,r){var l=t.useState(0),m=_(l,2),n=m[0],u=m[1],h=t.useRef(new Map),g=t.useRef(new yt),S=t.useRef();function v(){X.cancel(S.current)}function c(){v(),S.current=X(function(){h.current.forEach(function(d,M){if(d&&d.offsetParent){var i=bt(d),p=i.offsetHeight;g.current.get(M)!==p&&g.current.set(M,i.offsetHeight)}}),u(function(d){return d+1})})}function f(d,M){var i=e(d),p=h.current.get(i);M?(h.current.set(i,M),c()):h.current.delete(i),!p!=!M&&(M?s==null||s(d):r==null||r(d))}return t.useEffect(function(){return v},[]),[f,c,g.current,n]}function zt(e,s,r,l,m,n,u,h){var g=t.useRef();return function(S){if(S==null){h();return}if(X.cancel(g.current),typeof S=="number")u(S);else if(S&&De(S)==="object"){var v,c=S.align;"index"in S?v=S.index:v=s.findIndex(function(i){return m(i)===S.key});var f=S.offset,d=f===void 0?0:f,M=function i(p,y){if(!(p<0||!e.current)){var b=e.current.clientHeight,I=!1,P=y;if(b){for(var K=y||c,Y=0,F=0,L=0,$=Math.min(s.length,v),z=0;z<=$;z+=1){var Z=m(s[z]);F=Y;var x=r.get(Z);L=F+(x===void 0?l:x),Y=L,z===v&&x===void 0&&(I=!0)}var T=null;switch(K){case"top":T=F-d;break;case"bottom":T=L-b+d;break;default:{var A=e.current.scrollTop,q=A+b;F<A?P="top":L>q&&(P="bottom")}}T!==null&&T!==e.current.scrollTop&&u(T)}g.current=X(function(){I&&n(),i(p-1,P)},2)}};M(3)}}}function Lt(e,s,r){var l=e.length,m=s.length,n,u;if(l===0&&m===0)return null;l<m?(n=e,u=s):(n=s,u=e);var h={__EMPTY_ITEM__:!0};function g(M){return M!==void 0?r(M):h}for(var S=null,v=Math.abs(l-m)!==1,c=0;c<u.length;c+=1){var f=g(n[c]),d=g(u[c]);if(f!==d){S=c,v=v||f!==g(u[c+1]);break}}return S===null?null:{index:S,multiple:v}}function Ht(e,s,r){var l=t.useState(e),m=_(l,2),n=m[0],u=m[1],h=t.useState(null),g=_(h,2),S=g[0],v=g[1];return t.useEffect(function(){var c=Lt(n||[],e||[],s);(c==null?void 0:c.index)!==void 0&&(r==null||r(c.index),v(e[c.index])),u(e)},[e]),[S]}var Ze=(typeof navigator>"u"?"undefined":De(navigator))==="object"&&/Firefox/i.test(navigator.userAgent);const tt=function(e,s){var r=t.useRef(!1),l=t.useRef(null);function m(){clearTimeout(l.current),r.current=!0,l.current=setTimeout(function(){r.current=!1},50)}var n=t.useRef({top:e,bottom:s});return n.current.top=e,n.current.bottom=s,function(u){var h=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,g=u<0&&n.current.top||u>0&&n.current.bottom;return h&&g?(clearTimeout(l.current),r.current=!1):(!g||r.current)&&m(),!r.current&&g}};function _t(e,s,r,l,m){var n=t.useRef(0),u=t.useRef(null),h=t.useRef(null),g=t.useRef(!1),S=tt(s,r);function v(p,y){X.cancel(u.current),n.current+=y,h.current=y,!S(y)&&(Ze||p.preventDefault(),u.current=X(function(){var b=g.current?10:1;m(n.current*b),n.current=0}))}function c(p,y){m(y,!0),Ze||p.preventDefault()}var f=t.useRef(null),d=t.useRef(null);function M(p){if(e){X.cancel(d.current),d.current=X(function(){f.current=null},2);var y=p.deltaX,b=p.deltaY,I=p.shiftKey,P=y,K=b;(f.current==="sx"||!f.current&&I&&b&&!y)&&(P=b,K=0,f.current="sx");var Y=Math.abs(P),F=Math.abs(K);f.current===null&&(f.current=l&&Y>F?"x":"y"),f.current==="y"?v(p,K):c(p,P)}}function i(p){e&&(g.current=p.detail===h.current)}return[M,i]}var Tt=14/15;function Ct(e,s,r){var l=t.useRef(!1),m=t.useRef(0),n=t.useRef(null),u=t.useRef(null),h,g=function(f){if(l.current){var d=Math.ceil(f.touches[0].pageY),M=m.current-d;m.current=d,r(M)&&f.preventDefault(),clearInterval(u.current),u.current=setInterval(function(){M*=Tt,(!r(M,!0)||Math.abs(M)<=.1)&&clearInterval(u.current)},16)}},S=function(){l.current=!1,h()},v=function(f){h(),f.touches.length===1&&!l.current&&(l.current=!0,m.current=Math.ceil(f.touches[0].pageY),n.current=f.target,n.current.addEventListener("touchmove",g),n.current.addEventListener("touchend",S))};h=function(){n.current&&(n.current.removeEventListener("touchmove",g),n.current.removeEventListener("touchend",S))},Me(function(){return e&&s.current.addEventListener("touchstart",v),function(){var c;(c=s.current)===null||c===void 0||c.removeEventListener("touchstart",v),h(),clearInterval(u.current)}},[e])}var Dt=20;function qe(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=e/s*100;return isNaN(r)&&(r=0),r=Math.max(r,Dt),r=Math.min(r,e/2),Math.floor(r)}function It(e,s,r,l){var m=t.useMemo(function(){return[new Map,[]]},[e,r.id,l]),n=_(m,2),u=n[0],h=n[1],g=function(v){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v,f=u.get(v),d=u.get(c);if(f===void 0||d===void 0)for(var M=e.length,i=h.length;i<M;i+=1){var p,y=e[i],b=s(y);u.set(b,i);var I=(p=r.get(b))!==null&&p!==void 0?p:l;if(h[i]=(h[i-1]||0)+I,b===v&&(f=i),b===c&&(d=i),f!==void 0&&d!==void 0)break}return{top:h[f-1]||0,bottom:h[d]}};return g}var Pt=["prefixCls","className","height","itemHeight","fullHeight","style","data","children","itemKey","virtual","direction","scrollWidth","component","onScroll","onVirtualScroll","onVisibleChange","innerProps","extraRender"],Ot=[],Nt={overflowY:"auto",overflowAnchor:"none"};function kt(e,s){var r=e.prefixCls,l=r===void 0?"rc-virtual-list":r,m=e.className,n=e.height,u=e.itemHeight,h=e.fullHeight,g=h===void 0?!0:h,S=e.style,v=e.data,c=e.children,f=e.itemKey,d=e.virtual,M=e.direction,i=e.scrollWidth,p=e.component,y=p===void 0?"div":p,b=e.onScroll,I=e.onVirtualScroll,P=e.onVisibleChange,K=e.innerProps,Y=e.extraRender,F=Mt(e,Pt),L=!!(d!==!1&&n&&u),$=L&&v&&(u*v.length>n||!!i),z=M==="rtl",Z=be(l,k({},"".concat(l,"-rtl"),z),m),x=v||Ot,T=t.useRef(),A=t.useRef(),q=t.useState(0),ae=_(q,2),O=ae[0],U=ae[1],ie=t.useState(0),ge=_(ie,2),W=ge[0],J=ge[1],oe=t.useState(!1),Q=_(oe,2),Se=Q[0],le=Q[1],B=function(){le(!0)},C=function(){le(!1)},H=t.useCallback(function(a){return typeof f=="function"?f(a):a==null?void 0:a[f]},[f]),D={getKey:H};function E(a){U(function(o){var R;typeof a=="function"?R=a(o):R=a;var w=lt(R);return T.current.scrollTop=w,w})}var V=t.useRef({start:0,end:x.length}),me=t.useRef(),ue=Ht(x,H),ce=_(ue,1),xe=ce[0];me.current=xe;var Ee=wt(H,null,null),ee=_(Ee,4),Re=ee[0],te=ee[1],re=ee[2],pe=ee[3],ne=t.useMemo(function(){if(!L)return{scrollHeight:void 0,start:0,end:x.length-1,offset:void 0};if(!$){var a;return{scrollHeight:((a=A.current)===null||a===void 0?void 0:a.offsetHeight)||0,start:0,end:x.length-1,offset:void 0}}for(var o=0,R,w,G,gt=x.length,de=0;de<gt;de+=1){var St=x[de],mt=H(St),Be=re.get(mt),Ce=o+(Be===void 0?u:Be);Ce>=O&&R===void 0&&(R=de,w=o),Ce>O+n&&G===void 0&&(G=de),o=Ce}return R===void 0&&(R=0,w=0,G=Math.ceil(n/u)),G===void 0&&(G=x.length-1),G=Math.min(G+1,x.length-1),{scrollHeight:o,start:R,end:G,offset:w}},[$,L,O,x,pe,n]),N=ne.scrollHeight,fe=ne.start,se=ne.end,Ie=ne.offset;V.current.start=fe,V.current.end=se;var rt=t.useState({width:0,height:n}),Pe=_(rt,2),j=Pe[0],nt=Pe[1],at=function(o){nt(o)},Oe=t.useRef(),Ne=t.useRef(),it=t.useMemo(function(){return qe(j.width,i)},[j.width,i]),ot=t.useMemo(function(){return qe(j.height,N)},[j.height,N]),ye=N-n,we=t.useRef(ye);we.current=ye;function lt(a){var o=a;return Number.isNaN(we.current)||(o=Math.min(o,we.current)),o=Math.max(o,0),o}var ke=O<=0,Ye=O>=ye,ut=tt(ke,Ye),ze=function(){return{x:z?-W:W,y:O}},Le=t.useRef(ze()),He=je(function(){if(I){var a=ze();(Le.current.x!==a.x||Le.current.y!==a.y)&&(I(a),Le.current=a)}});function Fe(a,o){var R=a;o?(Ae.flushSync(function(){J(R)}),He()):E(R)}function ct(a){var o=a.currentTarget.scrollTop;o!==O&&E(o),b==null||b(a),He()}var _e=function(o){var R=o,w=i-j.width;return R=Math.max(R,0),R=Math.min(R,w),R},ft=je(function(a,o){o?(Ae.flushSync(function(){J(function(R){var w=R+(z?-a:a);return _e(w)})}),He()):E(function(R){var w=R+a;return w})}),st=_t(L,ke,Ye,!!i,ft),$e=_(st,2),Te=$e[0],We=$e[1];Ct(L,T,function(a,o){return ut(a,o)?!1:(Te({preventDefault:function(){},deltaY:a}),!0)}),Me(function(){function a(R){L&&R.preventDefault()}var o=T.current;return o.addEventListener("wheel",Te),o.addEventListener("DOMMouseScroll",We),o.addEventListener("MozMousePixelScroll",a),function(){o.removeEventListener("wheel",Te),o.removeEventListener("DOMMouseScroll",We),o.removeEventListener("MozMousePixelScroll",a)}},[L]),Me(function(){i&&J(function(a){return _e(a)})},[j.width,i]);var Xe=function(){var o,R;(o=Oe.current)===null||o===void 0||o.delayHidden(),(R=Ne.current)===null||R===void 0||R.delayHidden()},Ve=zt(T,x,re,u,H,te,E,Xe);t.useImperativeHandle(s,function(){return{getScrollInfo:ze,scrollTo:function(o){function R(w){return w&&De(w)==="object"&&("left"in w||"top"in w)}R(o)?(o.left!==void 0&&J(_e(o.left)),Ve(o.top)):Ve(o)}}}),Me(function(){if(P){var a=x.slice(fe,se+1);P(a,x)}},[fe,se,x]);var vt=It(x,H,re,u),dt=Y==null?void 0:Y({start:fe,end:se,virtual:$,offsetX:W,offsetY:Ie,rtl:z,getSize:vt}),ht=Et(x,fe,se,i,Re,c,D),ve=null;n&&(ve=he(k({},g?"height":"maxHeight",n),Nt),L&&(ve.overflowY="hidden",i&&(ve.overflowX="hidden"),Se&&(ve.pointerEvents="none")));var Ke={};return z&&(Ke.dir="rtl"),t.createElement("div",Je({style:he(he({},S),{},{position:"relative"}),className:Z},Ke,F),t.createElement(Qe,{onResize:at},t.createElement(y,{className:"".concat(l,"-holder"),style:ve,ref:T,onScroll:ct,onMouseEnter:Xe},t.createElement(et,{prefixCls:l,height:N,offsetX:W,offsetY:Ie,scrollWidth:i,onInnerResize:te,ref:A,innerProps:K,rtl:z,extra:dt},ht))),$&&N>n&&t.createElement(Ue,{ref:Oe,prefixCls:l,scrollOffset:O,scrollRange:N,rtl:z,onScroll:Fe,onStartMove:B,onStopMove:C,spinSize:ot,containerSize:j.height}),$&&i&&t.createElement(Ue,{ref:Ne,prefixCls:l,scrollOffset:W,scrollRange:i,rtl:z,onScroll:Fe,onStartMove:B,onStopMove:C,spinSize:it,containerSize:j.width,horizontal:!0}))}var Yt=t.forwardRef(kt);Yt.displayName="List";export{Yt as L};
