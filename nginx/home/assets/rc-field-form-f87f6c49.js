import{a as rr,r as y}from"./react-2c40f691.js";import{d as J,l as tr,f as E,e as k,m as ne,n as G,b as f,h as nr,i as ir,a as Re,j as S,_ as Se,k as Me,g as ze,c as te}from"./@babel-8091a5a2.js";import{S as ar}from"./async-validator-dee29e8b.js";var Ke={exports:{}},N={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ne=Symbol.for("react.element"),Ae=Symbol.for("react.portal"),le=Symbol.for("react.fragment"),oe=Symbol.for("react.strict_mode"),ce=Symbol.for("react.profiler"),fe=Symbol.for("react.provider"),de=Symbol.for("react.context"),sr=Symbol.for("react.server_context"),ve=Symbol.for("react.forward_ref"),ge=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),me=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),ur=Symbol.for("react.offscreen"),qe;qe=Symbol.for("react.module.reference");function _(n){if(typeof n=="object"&&n!==null){var u=n.$$typeof;switch(u){case Ne:switch(n=n.type,n){case le:case ce:case oe:case ge:case he:return n;default:switch(n=n&&n.$$typeof,n){case sr:case de:case ve:case pe:case me:case fe:return n;default:return u}}case Ae:return u}}}N.ContextConsumer=de;N.ContextProvider=fe;N.Element=Ne;N.ForwardRef=ve;N.Fragment=le;N.Lazy=pe;N.Memo=me;N.Portal=Ae;N.Profiler=ce;N.StrictMode=oe;N.Suspense=ge;N.SuspenseList=he;N.isAsyncMode=function(){return!1};N.isConcurrentMode=function(){return!1};N.isContextConsumer=function(n){return _(n)===de};N.isContextProvider=function(n){return _(n)===fe};N.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===Ne};N.isForwardRef=function(n){return _(n)===ve};N.isFragment=function(n){return _(n)===le};N.isLazy=function(n){return _(n)===pe};N.isMemo=function(n){return _(n)===me};N.isPortal=function(n){return _(n)===Ae};N.isProfiler=function(n){return _(n)===ce};N.isStrictMode=function(n){return _(n)===oe};N.isSuspense=function(n){return _(n)===ge};N.isSuspenseList=function(n){return _(n)===he};N.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===le||n===ce||n===oe||n===ge||n===he||n===ur||typeof n=="object"&&n!==null&&(n.$$typeof===pe||n.$$typeof===me||n.$$typeof===fe||n.$$typeof===de||n.$$typeof===ve||n.$$typeof===qe||n.getModuleId!==void 0)};N.typeOf=_;Ke.exports=N;var lr=Ke.exports;function Ve(n){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[];return rr.Children.forEach(n,function(t){t==null&&!u.keepEmpty||(Array.isArray(t)?r=r.concat(Ve(t)):lr.isFragment(t)&&t.props?r=r.concat(Ve(t.props.children,u)):r.push(t))}),r}var Pe={},or=function(u){};function cr(n,u){}function fr(n,u){}function dr(){Pe={}}function Ge(n,u,r){!u&&!Pe[r]&&(n(!1,r),Pe[r]=!0)}function H(n,u){Ge(cr,n,u)}function vr(n,u){Ge(fr,n,u)}H.preMessage=or;H.resetWarned=dr;H.noteOnce=vr;function gr(n,u){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,t=new Set;function e(i,a){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,o=t.has(i);if(H(!o,"Warning: There may be circular references"),o)return!1;if(i===a)return!0;if(r&&c>1)return!1;t.add(i);var l=c+1;if(Array.isArray(i)){if(!Array.isArray(a)||i.length!==a.length)return!1;for(var s=0;s<i.length;s++)if(!e(i[s],a[s],l))return!1;return!0}if(i&&a&&J(i)==="object"&&J(a)==="object"){var d=Object.keys(i);return d.length!==Object.keys(a).length?!1:d.every(function(v){return e(i[v],a[v],l)})}return!1}return e(n,u)}var B="RC_FORM_INTERNAL_HOOKS",O=function(){H(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},Z=y.createContext({getFieldValue:O,getFieldsValue:O,getFieldError:O,getFieldWarning:O,getFieldsError:O,isFieldsTouched:O,isFieldTouched:O,isFieldValidating:O,isFieldsValidating:O,resetFields:O,setFields:O,setFieldValue:O,setFieldsValue:O,validateFields:O,submit:O,getInternalHooks:function(){return O(),{dispatch:O,initEntityValue:O,registerField:O,useSubscribe:O,setInitialValues:O,destroyForm:O,setCallbacks:O,registerWatch:O,getFields:O,setValidateMessages:O,setPreserve:O,getInitialValue:O}}}),ue=y.createContext(null);function be(n){return n==null?[]:Array.isArray(n)?n:[n]}function hr(n){return n&&!!n._init}var W="'${name}' is not a valid ${type}",Je={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:W,method:W,array:W,object:W,number:W,date:W,boolean:W,integer:W,float:W,regexp:W,email:W,url:W,hex:W},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}};function K(n,u){for(var r=n,t=0;t<u.length;t+=1){if(r==null)return;r=r[u[t]]}return r}function Ye(n,u,r,t){if(!u.length)return r;var e=tr(u),i=e[0],a=e.slice(1),c;return!n&&typeof i=="number"?c=[]:Array.isArray(n)?c=E(n):c=k({},n),t&&r===void 0&&a.length===1?delete c[i][a[0]]:c[i]=Ye(c[i],a,r,t),c}function z(n,u,r){var t=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return u.length&&t&&r===void 0&&!K(n,u.slice(0,-1))?n:Ye(n,u,r,t)}function mr(n){return J(n)==="object"&&n!==null&&Object.getPrototypeOf(n)===Object.prototype}function xe(n){return Array.isArray(n)?[]:{}}var pr=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function re(){for(var n=arguments.length,u=new Array(n),r=0;r<n;r++)u[r]=arguments[r];var t=xe(u[0]);return u.forEach(function(e){function i(a,c){var o=new Set(c),l=K(e,a),s=Array.isArray(l);if(s||mr(l)){if(!o.has(l)){o.add(l);var d=K(t,a);s?t=z(t,a,[]):(!d||J(d)!=="object")&&(t=z(t,a,xe(l))),pr(l).forEach(function(v){i([].concat(E(a),[v]),o)})}}else t=z(t,a,l)}i([])}),t}var Ue=ar;function Fr(n,u){return n.replace(/\$\{\w+\}/g,function(r){var t=r.slice(2,-1);return u[t]})}var We="CODE_LOGIC_ERROR";function we(n,u,r,t,e){return Ce.apply(this,arguments)}function Ce(){return Ce=ne(G().mark(function n(u,r,t,e,i){var a,c,o,l,s,d,v,w,V;return G().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return a=k({},t),delete a.ruleIndex,Ue.warning=function(){},a.validator&&(c=a.validator,a.validator=function(){try{return c.apply(void 0,arguments)}catch(p){return console.error(p),Promise.reject(We)}}),o=null,a&&a.type==="array"&&a.defaultField&&(o=a.defaultField,delete a.defaultField),l=new Ue(f({},u,[a])),s=re(Je,e.validateMessages),l.messages(s),d=[],g.prev=10,g.next=13,Promise.resolve(l.validate(f({},u,r),k({},e)));case 13:g.next=18;break;case 15:g.prev=15,g.t0=g.catch(10),g.t0.errors&&(d=g.t0.errors.map(function(p,h){var F=p.message,M=F===We?s.default:F;return y.isValidElement(M)?y.cloneElement(M,{key:"error_".concat(h)}):M}));case 18:if(!(!d.length&&o)){g.next=23;break}return g.next=21,Promise.all(r.map(function(p,h){return we("".concat(u,".").concat(h),p,o,e,i)}));case 21:return v=g.sent,g.abrupt("return",v.reduce(function(p,h){return[].concat(E(p),E(h))},[]));case 23:return w=k(k({},t),{},{name:u,enum:(t.enum||[]).join(", ")},i),V=d.map(function(p){return typeof p=="string"?Fr(p,w):p}),g.abrupt("return",V);case 26:case"end":return g.stop()}},n,null,[[10,15]])})),Ce.apply(this,arguments)}function yr(n,u,r,t,e,i){var a=n.join("."),c=r.map(function(s,d){var v=s.validator,w=k(k({},s),{},{ruleIndex:d});return v&&(w.validator=function(V,m,g){var p=!1,h=function(){for(var $=arguments.length,C=new Array($),R=0;R<$;R++)C[R]=arguments[R];Promise.resolve().then(function(){H(!p,"Your validator function has already return a promise. `callback` will be ignored."),p||g.apply(void 0,C)})},F=v(V,m,h);p=F&&typeof F.then=="function"&&typeof F.catch=="function",H(p,"`callback` is deprecated. Please return a promise instead."),p&&F.then(function(){g()}).catch(function(M){g(M||" ")})}),w}).sort(function(s,d){var v=s.warningOnly,w=s.ruleIndex,V=d.warningOnly,m=d.ruleIndex;return!!v==!!V?w-m:v?1:-1}),o;if(e===!0)o=new Promise(function(){var s=ne(G().mark(function d(v,w){var V,m,g;return G().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:V=0;case 1:if(!(V<c.length)){h.next=12;break}return m=c[V],h.next=5,we(a,u,m,t,i);case 5:if(g=h.sent,!g.length){h.next=9;break}return w([{errors:g,rule:m}]),h.abrupt("return");case 9:V+=1,h.next=1;break;case 12:v([]);case 13:case"end":return h.stop()}},d)}));return function(d,v){return s.apply(this,arguments)}}());else{var l=c.map(function(s){return we(a,u,s,t,i).then(function(d){return{errors:d,rule:s}})});o=(e?Pr(l):Vr(l)).then(function(s){return Promise.reject(s)})}return o.catch(function(s){return s}),o}function Vr(n){return Ee.apply(this,arguments)}function Ee(){return Ee=ne(G().mark(function n(u){return G().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all(u).then(function(e){var i,a=(i=[]).concat.apply(i,E(e));return a}));case 1:case"end":return t.stop()}},n)})),Ee.apply(this,arguments)}function Pr(n){return ke.apply(this,arguments)}function ke(){return ke=ne(G().mark(function n(u){var r;return G().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=0,e.abrupt("return",new Promise(function(i){u.forEach(function(a){a.then(function(c){c.errors.length&&i([c]),r+=1,r===u.length&&i([])})})}));case 2:case"end":return e.stop()}},n)})),ke.apply(this,arguments)}function I(n){return be(n)}function je(n,u){var r={};return u.forEach(function(t){var e=K(n,t);r=z(r,t,e)}),r}function X(n,u){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return n&&n.some(function(t){return Be(u,t,r)})}function Be(n,u){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!n||!u||!r&&n.length!==u.length?!1:u.every(function(t,e){return n[e]===t})}function br(n,u){if(n===u)return!0;if(!n&&u||n&&!u||!n||!u||J(n)!=="object"||J(u)!=="object")return!1;var r=Object.keys(n),t=Object.keys(u),e=new Set([].concat(r,t));return E(e).every(function(i){var a=n[i],c=u[i];return typeof a=="function"&&typeof c=="function"?!0:a===c})}function wr(n){var u=arguments.length<=1?void 0:arguments[1];return u&&u.target&&J(u.target)==="object"&&n in u.target?u.target[n]:u}function He(n,u,r){var t=n.length;if(u<0||u>=t||r<0||r>=t)return n;var e=n[u],i=u-r;return i>0?[].concat(E(n.slice(0,r)),[e],E(n.slice(r,u)),E(n.slice(u+1,t))):i<0?[].concat(E(n.slice(0,u)),E(n.slice(u+1,r+1)),[e],E(n.slice(r+1,t))):n}var Cr=["name"],j=[];function _e(n,u,r,t,e,i){return typeof n=="function"?n(u,r,"source"in i?{source:i.source}:{}):t!==e}var Oe=function(n){nr(r,n);var u=ir(r);function r(t){var e;if(Re(this,r),e=u.call(this,t),f(S(e),"state",{resetCount:0}),f(S(e),"cancelRegisterFunc",null),f(S(e),"mounted",!1),f(S(e),"touched",!1),f(S(e),"dirty",!1),f(S(e),"validatePromise",void 0),f(S(e),"prevValidating",void 0),f(S(e),"errors",j),f(S(e),"warnings",j),f(S(e),"cancelRegister",function(){var o=e.props,l=o.preserve,s=o.isListField,d=o.name;e.cancelRegisterFunc&&e.cancelRegisterFunc(s,l,I(d)),e.cancelRegisterFunc=null}),f(S(e),"getNamePath",function(){var o=e.props,l=o.name,s=o.fieldContext,d=s.prefixName,v=d===void 0?[]:d;return l!==void 0?[].concat(E(v),E(l)):[]}),f(S(e),"getRules",function(){var o=e.props,l=o.rules,s=l===void 0?[]:l,d=o.fieldContext;return s.map(function(v){return typeof v=="function"?v(d):v})}),f(S(e),"refresh",function(){e.mounted&&e.setState(function(o){var l=o.resetCount;return{resetCount:l+1}})}),f(S(e),"metaCache",null),f(S(e),"triggerMetaEvent",function(o){var l=e.props.onMetaChange;if(l){var s=k(k({},e.getMeta()),{},{destroy:o});gr(e.metaCache,s)||l(s),e.metaCache=s}else e.metaCache=null}),f(S(e),"onStoreChange",function(o,l,s){var d=e.props,v=d.shouldUpdate,w=d.dependencies,V=w===void 0?[]:w,m=d.onReset,g=s.store,p=e.getNamePath(),h=e.getValue(o),F=e.getValue(g),M=l&&X(l,p);switch(s.type==="valueUpdate"&&s.source==="external"&&h!==F&&(e.touched=!0,e.dirty=!0,e.validatePromise=null,e.errors=j,e.warnings=j,e.triggerMetaEvent()),s.type){case"reset":if(!l||M){e.touched=!1,e.dirty=!1,e.validatePromise=void 0,e.errors=j,e.warnings=j,e.triggerMetaEvent(),m==null||m(),e.refresh();return}break;case"remove":{if(v){e.reRender();return}break}case"setField":{var $=s.data;if(M){"touched"in $&&(e.touched=$.touched),"validating"in $&&!("originRCField"in $)&&(e.validatePromise=$.validating?Promise.resolve([]):null),"errors"in $&&(e.errors=$.errors||j),"warnings"in $&&(e.warnings=$.warnings||j),e.dirty=!0,e.triggerMetaEvent(),e.reRender();return}else if("value"in $&&X(l,p,!0)){e.reRender();return}if(v&&!p.length&&_e(v,o,g,h,F,s)){e.reRender();return}break}case"dependenciesUpdate":{var C=V.map(I);if(C.some(function(R){return X(s.relatedFields,R)})){e.reRender();return}break}default:if(M||(!V.length||p.length||v)&&_e(v,o,g,h,F,s)){e.reRender();return}break}v===!0&&e.reRender()}),f(S(e),"validateRules",function(o){var l=e.getNamePath(),s=e.getValue(),d=o||{},v=d.triggerName,w=d.validateOnly,V=w===void 0?!1:w,m=Promise.resolve().then(ne(G().mark(function g(){var p,h,F,M,$,C,R;return G().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(e.mounted){P.next=2;break}return P.abrupt("return",[]);case 2:if(p=e.props,h=p.validateFirst,F=h===void 0?!1:h,M=p.messageVariables,$=p.validateDebounce,C=e.getRules(),v&&(C=C.filter(function(b){return b}).filter(function(b){var A=b.validateTrigger;if(!A)return!0;var T=be(A);return T.includes(v)})),!($&&v)){P.next=10;break}return P.next=8,new Promise(function(b){setTimeout(b,$)});case 8:if(e.validatePromise===m){P.next=10;break}return P.abrupt("return",[]);case 10:return R=yr(l,s,C,o,F,M),R.catch(function(b){return b}).then(function(){var b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:j;if(e.validatePromise===m){var A;e.validatePromise=null;var T=[],L=[];(A=b.forEach)===null||A===void 0||A.call(b,function(U){var q=U.rule.warningOnly,ee=U.errors,ae=ee===void 0?j:ee;q?L.push.apply(L,E(ae)):T.push.apply(T,E(ae))}),e.errors=T,e.warnings=L,e.triggerMetaEvent(),e.reRender()}}),P.abrupt("return",R);case 13:case"end":return P.stop()}},g)})));return V||(e.validatePromise=m,e.dirty=!0,e.errors=j,e.warnings=j,e.triggerMetaEvent(),e.reRender()),m}),f(S(e),"isFieldValidating",function(){return!!e.validatePromise}),f(S(e),"isFieldTouched",function(){return e.touched}),f(S(e),"isFieldDirty",function(){if(e.dirty||e.props.initialValue!==void 0)return!0;var o=e.props.fieldContext,l=o.getInternalHooks(B),s=l.getInitialValue;return s(e.getNamePath())!==void 0}),f(S(e),"getErrors",function(){return e.errors}),f(S(e),"getWarnings",function(){return e.warnings}),f(S(e),"isListField",function(){return e.props.isListField}),f(S(e),"isList",function(){return e.props.isList}),f(S(e),"isPreserve",function(){return e.props.preserve}),f(S(e),"getMeta",function(){e.prevValidating=e.isFieldValidating();var o={touched:e.isFieldTouched(),validating:e.prevValidating,errors:e.errors,warnings:e.warnings,name:e.getNamePath(),validated:e.validatePromise===null};return o}),f(S(e),"getOnlyChild",function(o){if(typeof o=="function"){var l=e.getMeta();return k(k({},e.getOnlyChild(o(e.getControlled(),l,e.props.fieldContext))),{},{isFunction:!0})}var s=Ve(o);return s.length!==1||!y.isValidElement(s[0])?{child:s,isFunction:!1}:{child:s[0],isFunction:!1}}),f(S(e),"getValue",function(o){var l=e.props.fieldContext.getFieldsValue,s=e.getNamePath();return K(o||l(!0),s)}),f(S(e),"getControlled",function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=e.props,s=l.trigger,d=l.validateTrigger,v=l.getValueFromEvent,w=l.normalize,V=l.valuePropName,m=l.getValueProps,g=l.fieldContext,p=d!==void 0?d:g.validateTrigger,h=e.getNamePath(),F=g.getInternalHooks,M=g.getFieldsValue,$=F(B),C=$.dispatch,R=e.getValue(),x=m||function(T){return f({},V,T)},P=o[s],b=k(k({},o),x(R));b[s]=function(){e.touched=!0,e.dirty=!0,e.triggerMetaEvent();for(var T,L=arguments.length,U=new Array(L),q=0;q<L;q++)U[q]=arguments[q];v?T=v.apply(void 0,U):T=wr.apply(void 0,[V].concat(U)),w&&(T=w(T,R,M(!0))),C({type:"updateValue",namePath:h,value:T}),P&&P.apply(void 0,U)};var A=be(p||[]);return A.forEach(function(T){var L=b[T];b[T]=function(){L&&L.apply(void 0,arguments);var U=e.props.rules;U&&U.length&&C({type:"validateField",namePath:h,triggerName:T})}}),b}),t.fieldContext){var i=t.fieldContext.getInternalHooks,a=i(B),c=a.initEntityValue;c(S(e))}return e}return Se(r,[{key:"componentDidMount",value:function(){var e=this.props,i=e.shouldUpdate,a=e.fieldContext;if(this.mounted=!0,a){var c=a.getInternalHooks,o=c(B),l=o.registerField;this.cancelRegisterFunc=l(this)}i===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var e=this.state.resetCount,i=this.props.children,a=this.getOnlyChild(i),c=a.child,o=a.isFunction,l;return o?l=c:y.isValidElement(c)?l=y.cloneElement(c,this.getControlled(c.props)):(H(!c,"`children` of Field is not validate ReactElement."),l=c),y.createElement(y.Fragment,{key:e},l)}}]),r}(y.Component);f(Oe,"contextType",Z);f(Oe,"defaultProps",{trigger:"onChange",valuePropName:"value"});function Qe(n){var u=n.name,r=Me(n,Cr),t=y.useContext(Z),e=y.useContext(ue),i=u!==void 0?I(u):void 0,a="keep";return r.isListField||(a="_".concat((i||[]).join("_"))),y.createElement(Oe,ze({key:a,name:i,isListField:!!e},r,{fieldContext:t}))}function Er(n){var u=n.name,r=n.initialValue,t=n.children,e=n.rules,i=n.validateTrigger,a=n.isListField,c=y.useContext(Z),o=y.useContext(ue),l=y.useRef({keys:[],id:0}),s=l.current,d=y.useMemo(function(){var m=I(c.prefixName)||[];return[].concat(E(m),E(I(u)))},[c.prefixName,u]),v=y.useMemo(function(){return k(k({},c),{},{prefixName:d})},[c,d]),w=y.useMemo(function(){return{getKey:function(g){var p=d.length,h=g[p];return[s.keys[h],g.slice(p+1)]}}},[d]);if(typeof t!="function")return H(!1,"Form.List only accepts function as children."),null;var V=function(g,p,h){var F=h.source;return F==="internal"?!1:g!==p};return y.createElement(ue.Provider,{value:w},y.createElement(Z.Provider,{value:v},y.createElement(Qe,{name:[],shouldUpdate:V,rules:e,validateTrigger:i,initialValue:r,isList:!0,isListField:a??!!o},function(m,g){var p=m.value,h=p===void 0?[]:p,F=m.onChange,M=c.getFieldValue,$=function(){var P=M(d||[]);return P||[]},C={add:function(P,b){var A=$();b>=0&&b<=A.length?(s.keys=[].concat(E(s.keys.slice(0,b)),[s.id],E(s.keys.slice(b))),F([].concat(E(A.slice(0,b)),[P],E(A.slice(b))))):(s.keys=[].concat(E(s.keys),[s.id]),F([].concat(E(A),[P]))),s.id+=1},remove:function(P){var b=$(),A=new Set(Array.isArray(P)?P:[P]);A.size<=0||(s.keys=s.keys.filter(function(T,L){return!A.has(L)}),F(b.filter(function(T,L){return!A.has(L)})))},move:function(P,b){if(P!==b){var A=$();P<0||P>=A.length||b<0||b>=A.length||(s.keys=He(s.keys,P,b),F(He(A,P,b)))}}},R=h||[];return Array.isArray(R)||(R=[]),t(R.map(function(x,P){var b=s.keys[P];return b===void 0&&(s.keys[P]=s.id,b=s.keys[P],s.id+=1),{name:P,key:b,isListField:!0}}),C,g)})))}function kr(n){var u=!1,r=n.length,t=[];return n.length?new Promise(function(e,i){n.forEach(function(a,c){a.catch(function(o){return u=!0,o}).then(function(o){r-=1,t[c]=o,!(r>0)&&(u&&i(t),e(t))})})}):Promise.resolve([])}var Xe="__@field_split__";function ye(n){return n.map(function(u){return"".concat(J(u),":").concat(u)}).join(Xe)}var Q=function(){function n(){Re(this,n),f(this,"kvs",new Map)}return Se(n,[{key:"set",value:function(r,t){this.kvs.set(ye(r),t)}},{key:"get",value:function(r){return this.kvs.get(ye(r))}},{key:"update",value:function(r,t){var e=this.get(r),i=t(e);i?this.set(r,i):this.delete(r)}},{key:"delete",value:function(r){this.kvs.delete(ye(r))}},{key:"map",value:function(r){return E(this.kvs.entries()).map(function(t){var e=te(t,2),i=e[0],a=e[1],c=i.split(Xe);return r({key:c.map(function(o){var l=o.match(/^([^:]*):(.*)$/),s=te(l,3),d=s[1],v=s[2];return d==="number"?Number(v):v}),value:a})})}},{key:"toJSON",value:function(){var r={};return this.map(function(t){var e=t.key,i=t.value;return r[e.join(".")]=i,null}),r}}]),n}(),$r=["name"],Rr=Se(function n(u){var r=this;Re(this,n),f(this,"formHooked",!1),f(this,"forceRootUpdate",void 0),f(this,"subscribable",!0),f(this,"store",{}),f(this,"fieldEntities",[]),f(this,"initialValues",{}),f(this,"callbacks",{}),f(this,"validateMessages",null),f(this,"preserve",null),f(this,"lastValidatePromise",null),f(this,"getForm",function(){return{getFieldValue:r.getFieldValue,getFieldsValue:r.getFieldsValue,getFieldError:r.getFieldError,getFieldWarning:r.getFieldWarning,getFieldsError:r.getFieldsError,isFieldsTouched:r.isFieldsTouched,isFieldTouched:r.isFieldTouched,isFieldValidating:r.isFieldValidating,isFieldsValidating:r.isFieldsValidating,resetFields:r.resetFields,setFields:r.setFields,setFieldValue:r.setFieldValue,setFieldsValue:r.setFieldsValue,validateFields:r.validateFields,submit:r.submit,_init:!0,getInternalHooks:r.getInternalHooks}}),f(this,"getInternalHooks",function(t){return t===B?(r.formHooked=!0,{dispatch:r.dispatch,initEntityValue:r.initEntityValue,registerField:r.registerField,useSubscribe:r.useSubscribe,setInitialValues:r.setInitialValues,destroyForm:r.destroyForm,setCallbacks:r.setCallbacks,setValidateMessages:r.setValidateMessages,getFields:r.getFields,setPreserve:r.setPreserve,getInitialValue:r.getInitialValue,registerWatch:r.registerWatch}):(H(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),f(this,"useSubscribe",function(t){r.subscribable=t}),f(this,"prevWithoutPreserves",null),f(this,"setInitialValues",function(t,e){if(r.initialValues=t||{},e){var i,a=re(t,r.store);(i=r.prevWithoutPreserves)===null||i===void 0||i.map(function(c){var o=c.key;a=z(a,o,K(t,o))}),r.prevWithoutPreserves=null,r.updateStore(a)}}),f(this,"destroyForm",function(){var t=new Q;r.getFieldEntities(!0).forEach(function(e){r.isMergedPreserve(e.isPreserve())||t.set(e.getNamePath(),!0)}),r.prevWithoutPreserves=t}),f(this,"getInitialValue",function(t){var e=K(r.initialValues,t);return t.length?re(e):e}),f(this,"setCallbacks",function(t){r.callbacks=t}),f(this,"setValidateMessages",function(t){r.validateMessages=t}),f(this,"setPreserve",function(t){r.preserve=t}),f(this,"watchList",[]),f(this,"registerWatch",function(t){return r.watchList.push(t),function(){r.watchList=r.watchList.filter(function(e){return e!==t})}}),f(this,"notifyWatch",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(r.watchList.length){var e=r.getFieldsValue(),i=r.getFieldsValue(!0);r.watchList.forEach(function(a){a(e,i,t)})}}),f(this,"timeoutId",null),f(this,"warningUnhooked",function(){}),f(this,"updateStore",function(t){r.store=t}),f(this,"getFieldEntities",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return t?r.fieldEntities.filter(function(e){return e.getNamePath().length}):r.fieldEntities}),f(this,"getFieldsMap",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,e=new Q;return r.getFieldEntities(t).forEach(function(i){var a=i.getNamePath();e.set(a,i)}),e}),f(this,"getFieldEntitiesForNamePathList",function(t){if(!t)return r.getFieldEntities(!0);var e=r.getFieldsMap(!0);return t.map(function(i){var a=I(i);return e.get(a)||{INVALIDATE_NAME_PATH:I(i)}})}),f(this,"getFieldsValue",function(t,e){r.warningUnhooked();var i,a,c;if(t===!0||Array.isArray(t)?(i=t,a=e):t&&J(t)==="object"&&(c=t.strict,a=t.filter),i===!0&&!a)return r.store;var o=r.getFieldEntitiesForNamePathList(Array.isArray(i)?i:null),l=[];return o.forEach(function(s){var d,v,w="INVALIDATE_NAME_PATH"in s?s.INVALIDATE_NAME_PATH:s.getNamePath();if(c){var V,m;if((V=(m=s).isList)!==null&&V!==void 0&&V.call(m))return}else if(!i&&(d=(v=s).isListField)!==null&&d!==void 0&&d.call(v))return;if(!a)l.push(w);else{var g="getMeta"in s?s.getMeta():null;a(g)&&l.push(w)}}),je(r.store,l.map(I))}),f(this,"getFieldValue",function(t){r.warningUnhooked();var e=I(t);return K(r.store,e)}),f(this,"getFieldsError",function(t){r.warningUnhooked();var e=r.getFieldEntitiesForNamePathList(t);return e.map(function(i,a){return i&&!("INVALIDATE_NAME_PATH"in i)?{name:i.getNamePath(),errors:i.getErrors(),warnings:i.getWarnings()}:{name:I(t[a]),errors:[],warnings:[]}})}),f(this,"getFieldError",function(t){r.warningUnhooked();var e=I(t),i=r.getFieldsError([e])[0];return i.errors}),f(this,"getFieldWarning",function(t){r.warningUnhooked();var e=I(t),i=r.getFieldsError([e])[0];return i.warnings}),f(this,"isFieldsTouched",function(){r.warningUnhooked();for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];var a=e[0],c=e[1],o,l=!1;e.length===0?o=null:e.length===1?Array.isArray(a)?(o=a.map(I),l=!1):(o=null,l=a):(o=a.map(I),l=c);var s=r.getFieldEntities(!0),d=function(g){return g.isFieldTouched()};if(!o)return l?s.every(d):s.some(d);var v=new Q;o.forEach(function(m){v.set(m,[])}),s.forEach(function(m){var g=m.getNamePath();o.forEach(function(p){p.every(function(h,F){return g[F]===h})&&v.update(p,function(h){return[].concat(E(h),[m])})})});var w=function(g){return g.some(d)},V=v.map(function(m){var g=m.value;return g});return l?V.every(w):V.some(w)}),f(this,"isFieldTouched",function(t){return r.warningUnhooked(),r.isFieldsTouched([t])}),f(this,"isFieldsValidating",function(t){r.warningUnhooked();var e=r.getFieldEntities();if(!t)return e.some(function(a){return a.isFieldValidating()});var i=t.map(I);return e.some(function(a){var c=a.getNamePath();return X(i,c)&&a.isFieldValidating()})}),f(this,"isFieldValidating",function(t){return r.warningUnhooked(),r.isFieldsValidating([t])}),f(this,"resetWithFieldInitialValue",function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=new Q,i=r.getFieldEntities(!0);i.forEach(function(o){var l=o.props.initialValue,s=o.getNamePath();if(l!==void 0){var d=e.get(s)||new Set;d.add({entity:o,value:l}),e.set(s,d)}});var a=function(l){l.forEach(function(s){var d=s.props.initialValue;if(d!==void 0){var v=s.getNamePath(),w=r.getInitialValue(v);if(w!==void 0)H(!1,"Form already set 'initialValues' with path '".concat(v.join("."),"'. Field can not overwrite it."));else{var V=e.get(v);if(V&&V.size>1)H(!1,"Multiple Field with path '".concat(v.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(V){var m=r.getFieldValue(v),g=s.isListField();!g&&(!t.skipExist||m===void 0)&&r.updateStore(z(r.store,v,E(V)[0].value))}}}})},c;t.entities?c=t.entities:t.namePathList?(c=[],t.namePathList.forEach(function(o){var l=e.get(o);if(l){var s;(s=c).push.apply(s,E(E(l).map(function(d){return d.entity})))}})):c=i,a(c)}),f(this,"resetFields",function(t){r.warningUnhooked();var e=r.store;if(!t){r.updateStore(re(r.initialValues)),r.resetWithFieldInitialValue(),r.notifyObservers(e,null,{type:"reset"}),r.notifyWatch();return}var i=t.map(I);i.forEach(function(a){var c=r.getInitialValue(a);r.updateStore(z(r.store,a,c))}),r.resetWithFieldInitialValue({namePathList:i}),r.notifyObservers(e,i,{type:"reset"}),r.notifyWatch(i)}),f(this,"setFields",function(t){r.warningUnhooked();var e=r.store,i=[];t.forEach(function(a){var c=a.name,o=Me(a,$r),l=I(c);i.push(l),"value"in o&&r.updateStore(z(r.store,l,o.value)),r.notifyObservers(e,[l],{type:"setField",data:a})}),r.notifyWatch(i)}),f(this,"getFields",function(){var t=r.getFieldEntities(!0),e=t.map(function(i){var a=i.getNamePath(),c=i.getMeta(),o=k(k({},c),{},{name:a,value:r.getFieldValue(a)});return Object.defineProperty(o,"originRCField",{value:!0}),o});return e}),f(this,"initEntityValue",function(t){var e=t.props.initialValue;if(e!==void 0){var i=t.getNamePath(),a=K(r.store,i);a===void 0&&r.updateStore(z(r.store,i,e))}}),f(this,"isMergedPreserve",function(t){var e=t!==void 0?t:r.preserve;return e??!0}),f(this,"registerField",function(t){r.fieldEntities.push(t);var e=t.getNamePath();if(r.notifyWatch([e]),t.props.initialValue!==void 0){var i=r.store;r.resetWithFieldInitialValue({entities:[t],skipExist:!0}),r.notifyObservers(i,[t.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(a,c){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(r.fieldEntities=r.fieldEntities.filter(function(d){return d!==t}),!r.isMergedPreserve(c)&&(!a||o.length>1)){var l=a?void 0:r.getInitialValue(e);if(e.length&&r.getFieldValue(e)!==l&&r.fieldEntities.every(function(d){return!Be(d.getNamePath(),e)})){var s=r.store;r.updateStore(z(s,e,l,!0)),r.notifyObservers(s,[e],{type:"remove"}),r.triggerDependenciesUpdate(s,e)}}r.notifyWatch([e])}}),f(this,"dispatch",function(t){switch(t.type){case"updateValue":{var e=t.namePath,i=t.value;r.updateValue(e,i);break}case"validateField":{var a=t.namePath,c=t.triggerName;r.validateFields([a],{triggerName:c});break}}}),f(this,"notifyObservers",function(t,e,i){if(r.subscribable){var a=k(k({},i),{},{store:r.getFieldsValue(!0)});r.getFieldEntities().forEach(function(c){var o=c.onStoreChange;o(t,e,a)})}else r.forceRootUpdate()}),f(this,"triggerDependenciesUpdate",function(t,e){var i=r.getDependencyChildrenFields(e);return i.length&&r.validateFields(i),r.notifyObservers(t,i,{type:"dependenciesUpdate",relatedFields:[e].concat(E(i))}),i}),f(this,"updateValue",function(t,e){var i=I(t),a=r.store;r.updateStore(z(r.store,i,e)),r.notifyObservers(a,[i],{type:"valueUpdate",source:"internal"}),r.notifyWatch([i]);var c=r.triggerDependenciesUpdate(a,i),o=r.callbacks.onValuesChange;if(o){var l=je(r.store,[i]);o(l,r.getFieldsValue())}r.triggerOnFieldsChange([i].concat(E(c)))}),f(this,"setFieldsValue",function(t){r.warningUnhooked();var e=r.store;if(t){var i=re(r.store,t);r.updateStore(i)}r.notifyObservers(e,null,{type:"valueUpdate",source:"external"}),r.notifyWatch()}),f(this,"setFieldValue",function(t,e){r.setFields([{name:t,value:e}])}),f(this,"getDependencyChildrenFields",function(t){var e=new Set,i=[],a=new Q;r.getFieldEntities().forEach(function(o){var l=o.props.dependencies;(l||[]).forEach(function(s){var d=I(s);a.update(d,function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return v.add(o),v})})});var c=function o(l){var s=a.get(l)||new Set;s.forEach(function(d){if(!e.has(d)){e.add(d);var v=d.getNamePath();d.isFieldDirty()&&v.length&&(i.push(v),o(v))}})};return c(t),i}),f(this,"triggerOnFieldsChange",function(t,e){var i=r.callbacks.onFieldsChange;if(i){var a=r.getFields();if(e){var c=new Q;e.forEach(function(l){var s=l.name,d=l.errors;c.set(s,d)}),a.forEach(function(l){l.errors=c.get(l.name)||l.errors})}var o=a.filter(function(l){var s=l.name;return X(t,s)});o.length&&i(o,a)}}),f(this,"validateFields",function(t,e){r.warningUnhooked();var i,a;Array.isArray(t)||typeof t=="string"||typeof e=="string"?(i=t,a=e):a=t;var c=!!i,o=c?i.map(I):[],l=[],s=String(Date.now()),d=new Set,v=a||{},w=v.recursive,V=v.dirty;r.getFieldEntities(!0).forEach(function(h){if(c||o.push(h.getNamePath()),!(!h.props.rules||!h.props.rules.length)&&!(V&&!h.isFieldDirty())){var F=h.getNamePath();if(d.add(F.join(s)),!c||X(o,F,w)){var M=h.validateRules(k({validateMessages:k(k({},Je),r.validateMessages)},a));l.push(M.then(function(){return{name:F,errors:[],warnings:[]}}).catch(function($){var C,R=[],x=[];return(C=$.forEach)===null||C===void 0||C.call($,function(P){var b=P.rule.warningOnly,A=P.errors;b?x.push.apply(x,E(A)):R.push.apply(R,E(A))}),R.length?Promise.reject({name:F,errors:R,warnings:x}):{name:F,errors:R,warnings:x}}))}}});var m=kr(l);r.lastValidatePromise=m,m.catch(function(h){return h}).then(function(h){var F=h.map(function(M){var $=M.name;return $});r.notifyObservers(r.store,F,{type:"validateFinish"}),r.triggerOnFieldsChange(F,h)});var g=m.then(function(){return r.lastValidatePromise===m?Promise.resolve(r.getFieldsValue(o)):Promise.reject([])}).catch(function(h){var F=h.filter(function(M){return M&&M.errors.length});return Promise.reject({values:r.getFieldsValue(o),errorFields:F,outOfDate:r.lastValidatePromise!==m})});g.catch(function(h){return h});var p=o.filter(function(h){return d.has(h.join(s))});return r.triggerOnFieldsChange(p),g}),f(this,"submit",function(){r.warningUnhooked(),r.validateFields().then(function(t){var e=r.callbacks.onFinish;if(e)try{e(t)}catch(i){console.error(i)}}).catch(function(t){var e=r.callbacks.onFinishFailed;e&&e(t)})}),this.forceRootUpdate=u});function Ze(n){var u=y.useRef(),r=y.useState({}),t=te(r,2),e=t[1];if(!u.current)if(n)u.current=n;else{var i=function(){e({})},a=new Rr(i);u.current=a.getForm()}return[u.current]}var $e=y.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),Sr=function(u){var r=u.validateMessages,t=u.onFormChange,e=u.onFormFinish,i=u.children,a=y.useContext($e),c=y.useRef({});return y.createElement($e.Provider,{value:k(k({},a),{},{validateMessages:k(k({},a.validateMessages),r),triggerFormChange:function(l,s){t&&t(l,{changedFields:s,forms:c.current}),a.triggerFormChange(l,s)},triggerFormFinish:function(l,s){e&&e(l,{values:s,forms:c.current}),a.triggerFormFinish(l,s)},registerForm:function(l,s){l&&(c.current=k(k({},c.current),{},f({},l,s))),a.registerForm(l,s)},unregisterForm:function(l){var s=k({},c.current);delete s[l],c.current=s,a.unregisterForm(l)}})},i)},Mr=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed"],Nr=function(u,r){var t=u.name,e=u.initialValues,i=u.fields,a=u.form,c=u.preserve,o=u.children,l=u.component,s=l===void 0?"form":l,d=u.validateMessages,v=u.validateTrigger,w=v===void 0?"onChange":v,V=u.onValuesChange,m=u.onFieldsChange,g=u.onFinish,p=u.onFinishFailed,h=Me(u,Mr),F=y.useContext($e),M=Ze(a),$=te(M,1),C=$[0],R=C.getInternalHooks(B),x=R.useSubscribe,P=R.setInitialValues,b=R.setCallbacks,A=R.setValidateMessages,T=R.setPreserve,L=R.destroyForm;y.useImperativeHandle(r,function(){return C}),y.useEffect(function(){return F.registerForm(t,C),function(){F.unregisterForm(t)}},[F,C,t]),A(k(k({},F.validateMessages),d)),b({onValuesChange:V,onFieldsChange:function(D){if(F.triggerFormChange(t,D),m){for(var Y=arguments.length,Le=new Array(Y>1?Y-1:0),se=1;se<Y;se++)Le[se-1]=arguments[se];m.apply(void 0,[D].concat(Le))}},onFinish:function(D){F.triggerFormFinish(t,D),g&&g(D)},onFinishFailed:p}),T(c);var U=y.useRef(null);P(e,!U.current),U.current||(U.current=!0),y.useEffect(function(){return L},[]);var q,ee=typeof o=="function";if(ee){var ae=C.getFieldsValue(!0);q=o(ae,C)}else q=o;x(!ee);var Te=y.useRef();y.useEffect(function(){br(Te.current||[],i||[])||C.setFields(i||[]),Te.current=i},[i,C]);var er=y.useMemo(function(){return k(k({},C),{},{validateTrigger:w})},[C,w]),Ie=y.createElement(ue.Provider,{value:null},y.createElement(Z.Provider,{value:er},q));return s===!1?Ie:y.createElement(s,ze({},h,{onSubmit:function(D){D.preventDefault(),D.stopPropagation(),C.submit()},onReset:function(D){var Y;D.preventDefault(),C.resetFields(),(Y=h.onReset)===null||Y===void 0||Y.call(h,D)}}),Ie)};function De(n){try{return JSON.stringify(n)}catch{return Math.random()}}function Ar(){for(var n=arguments.length,u=new Array(n),r=0;r<n;r++)u[r]=arguments[r];var t=u[0],e=t===void 0?[]:t,i=u[1],a=i===void 0?{}:i,c=hr(a)?{form:a}:a,o=c.form,l=y.useState(),s=te(l,2),d=s[0],v=s[1],w=y.useMemo(function(){return De(d)},[d]),V=y.useRef(w);V.current=w;var m=y.useContext(Z),g=o||m,p=g&&g._init,h=I(e),F=y.useRef(h);return F.current=h,y.useEffect(function(){if(p){var M=g.getFieldsValue,$=g.getInternalHooks,C=$(B),R=C.registerWatch,x=R(function(b,A){var T=K(c.preserve?A:b,F.current),L=De(T);V.current!==L&&(V.current=L,v(T))}),P=K(c.preserve?M(!0):M(),F.current);return d!==P&&v(P),x}},[p]),d}var Or=y.forwardRef(Nr),ie=Or;ie.FormProvider=Sr;ie.Field=Qe;ie.List=Er;ie.useForm=Ze;ie.useWatch=Ar;export{Z as C,Sr as F,ue as L,ie as R,Qe as W,Er as a,Ar as b,Ze as u};
